(function() {

var __exportName = 'splunkjs';

var require=function(a,b){var c=require.resolve(a,b||"/"),d=require.modules[c];if(!d)throw new Error("Failed to resolve module "+a+", tried "+c);var e=d._cached?d._cached:d();return e};require.paths=[],require.modules={},require.extensions=[".js",".coffee"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(a,b){function g(a){if(require.modules[a])return a;for(var b=0;b<require.extensions.length;b++){var c=require.extensions[b];if(require.modules[a+c])return a+c}}function h(a){a=a.replace(/\/+$/,"");var b=a+"/package.json";if(require.modules[b]){var d=require.modules[b](),e=d.browserify;if(typeof e=="object"&&e.main){var f=g(c.resolve(a,e.main));if(f)return f}else if(typeof e=="string"){var f=g(c.resolve(a,e));if(f)return f}else if(d.main){var f=g(c.resolve(a,d.main));if(f)return f}}return g(a+"/index")}function i(a,b){var c=j(b);for(var d=0;d<c.length;d++){var e=c[d],f=g(e+"/"+a);if(f)return f;var i=h(e+"/"+a);if(i)return i}var f=g(a);if(f)return f}function j(a){var b;a==="/"?b=[""]:b=c.normalize(a).split("/");var d=[];for(var e=b.length-1;e>=0;e--){if(b[e]==="node_modules")continue;var f=b.slice(0,e+1).join("/")+"/node_modules";d.push(f)}return d}b||(b="/");if(require._core[a])return a;var c=require.modules.path();b=c.resolve("/",b);var d=b||"/";if(a.match(/^(?:\.\.?\/|\/)/)){var e=g(c.resolve(d,a))||h(c.resolve(d,a));if(e)return e}var f=i(a,d);if(f)return f;throw new Error("Cannot find module '"+a+"'")}}(),require.alias=function(a,b){var c=require.modules.path(),d=null;try{d=require.resolve(a+"/package.json","/")}catch(e){d=require.resolve(a,"/")}var f=c.dirname(d),g=(Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b})(require.modules);for(var h=0;h<g.length;h++){var i=g[h];if(i.slice(0,f.length+1)===f+"/"){var j=i.slice(f.length);require.modules[b+j]=require.modules[f+j]}else i===f&&(require.modules[b]=require.modules[f])}},require.define=function(a,b){var c=require._core[a]?"":require.modules.path().dirname(a),d=function(a){return require(a,c)};d.resolve=function(a){return require.resolve(a,c)},d.modules=require.modules,d.define=require.define;var e={exports:{}};require.modules[a]=function(){return require.modules[a]._cached=e.exports,b.call(e.exports,d,e,e.exports,c,a),require.modules[a]._cached=e.exports,e.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var a=[],b=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return b&&window.addEventListener("message",function(b){if(b.source===window&&b.data==="browserify-tick"){b.stopPropagation();if(a.length>0){var c=a.shift();c()}}},!0),function(c){b?(a.push(c),window.postMessage("browserify-tick","*")):setTimeout(c,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(a){if(a==="evals")return require("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),require.define("path",function(a,b,c,d,e){function f(a,b){var c=[];for(var d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}function g(a,b){var c=0;for(var d=a.length;d>=0;d--){var e=a[d];e=="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}var h=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;c.resolve=function(){var a="",b=!1;for(var c=arguments.length;c>=-1&&!b;c--){var d=c>=0?arguments[c]:process.cwd();if(typeof d!="string"||!d)continue;a=d+"/"+a,b=d.charAt(0)==="/"}return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),(b?"/":"")+a||"."},c.normalize=function(a){var b=a.charAt(0)==="/",c=a.slice(-1)==="/";return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),!a&&!b&&(a="."),a&&c&&(a+="/"),(b?"/":"")+a},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(f(a,function(a,b){return a&&typeof a=="string"}).join("/"))},c.dirname=function(a){var b=h.exec(a)[1]||"",c=!1;return b?b.length===1||c&&b.length<=3&&b.charAt(1)===":"?b:b.substring(0,b.length-1):"."},c.basename=function(a,b){var c=h.exec(a)[2]||"";return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return h.exec(a)[3]||""}}),require.define("/tests/test_utils.js",function(a,b,c,d,e){c.setup=function(){var b=a("../index");return b.Logger.setLevel("ALL"),{"Callback#callback to object success":function(a){var b=function(a){a(null,"one","two")};b(function(b,c,d){a.strictEqual(c,"one"),a.strictEqual(d,"two"),a.done()})},"Callback#callback to object error - single argument":function(a){var b=function(a){a("one")};b(function(b,c,d){a.strictEqual(b,"one"),a.ok(!c),a.ok(!d),a.done()})},"Callback#callback to object error - multi argument":function(a){var b=function(a){a(["one","two"])};b(function(b,c,d){a.strictEqual(b[0],"one"),a.strictEqual(b[1],"two"),a.ok(!c),a.ok(!d),a.done()})},"keyOf works":function(a){a.ok(b.Utils.keyOf(3,{a:3,b:5})),a.ok(!b.Utils.keyOf(3,{a:12,b:6})),a.done()},bind:function(a){var c;(function(){c=function(a){this.a=a}})();var d={},e=b.Utils.bind(d,c);e(12),a.strictEqual(d.a,12),a.done()},trim:function(a){a.strictEqual(b.Utils.trim("  test of something  \n\r  \t"),"test of something");var c=String.prototype.trim;String.prototype.trim=null,a.strictEqual(b.Utils.trim("  test of something  \n\r  \t"),"test of something"),String.prototype.trim=c,a.done()},indexOf:function(a){a.strictEqual(b.Utils.indexOf([1,2,3,4,5],3),2),a.strictEqual(b.Utils.indexOf([1,2,3,4,3],3),2),a.strictEqual(b.Utils.indexOf([1,2,3,4,5],12),-1),a.done()},contains:function(a){a.ok(b.Utils.contains([1,2,3,4,5],3)),a.ok(b.Utils.contains([1,2,3,4,3],3)),a.ok(!b.Utils.contains([1,2,3,4,5],12)),a.done()},startsWith:function(a){a.ok(b.Utils.startsWith("abcdefg","abc")),a.ok(!b.Utils.startsWith("bcdefg","abc")),a.done()},endsWith:function(a){a.ok(b.Utils.endsWith("abcdef","def")),a.ok(!b.Utils.endsWith("abcdef","bcd")),a.done()},toArray:function(a){(function(){var c=b.Utils.toArray(arguments),d=[1,2,3,4,5];for(var e=0;e<c.length;e++)a.strictEqual(c[e],d[e])})(1,2,3,4,5),a.done()},isArray:function(a){var c=[1,2,3,4,5];a.ok(b.Utils.isArray(c)),a.done()},isFunction:function(a){a.ok(b.Utils.isFunction(function(){})),a.ok(!b.Utils.isFunction(3)),a.ok(!b.Utils.isFunction("abc")),a.ok(!b.Utils.isFunction({})),a.done()},isNumber:function(a){a.ok(b.Utils.isNumber(3)),a.ok(b.Utils.isNumber(-255113e7)),a.ok(!b.Utils.isNumber("3")),a.ok(!b.Utils.isNumber({3:5})),a.done()},isObject:function(a){a.ok(b.Utils.isObject({})),a.ok(!b.Utils.isObject(3)),a.ok(!b.Utils.isObject("3")),a.done()},isEmpty:function(a){a.ok(b.Utils.isEmpty({})),a.ok(b.Utils.isEmpty([])),a.ok(b.Utils.isEmpty("")),a.ok(!b.Utils.isEmpty({a:3})),a.ok(!b.Utils.isEmpty([1,2])),a.ok(!b.Utils.isEmpty("abc")),a.done()},forEach:function(a){var c=[1,2,3,4,5];b.Utils.forEach(c,function(b,d,e){a.strictEqual(c[d],b)});var d={1:2,2:4,3:6};b.Utils.forEach(d,function(b,c,e){a.strictEqual(d[c],b)}),b.Utils.forEach(null,function(a,b,c){});var e={length:5,1:12,2:15,3:8};b.Utils.forEach(e,function(b,c,d){a.strictEqual(e[c],b)}),a.done()},extend:function(a){var c=b.Utils.extend({},{a:1,b:2},{c:3,b:4}),d={a:1,b:4,c:3};for(var e in c)c.hasOwnProperty(e)&&a.strictEqual(c[e],d[e]);a.done()},clone:function(a){var c={a:1,b:2,c:{p:5,q:6}},d=b.Utils.clone(c);b.Utils.forEach(c,function(b,c,e){a.strictEqual(b,d[c])}),c.a=5,a.strictEqual(d.a,1),c.c.p=4,a.strictEqual(d.c.p,4),a.done(),a.strictEqual(b.Utils.clone(3),3),a.strictEqual(b.Utils.clone("asdf"),"asdf");var e=[1,2,[3,4],3],f=b.Utils.clone(e);b.Utils.forEach(e,function(b,c,d){a.strictEqual(e[c],f[c])}),e[0]=3,a.strictEqual(f[0],1),e[2][0]=7,a.strictEqual(f[2][0],7)},namespaceFromProperties:function(a){var c=b.Utils.namespaceFromProperties({acl:{owner:"boris",app:"factory",sharing:"system",other:3},more:12});b.Utils.forEach(c,function(b,c,d){a.ok(c==="owner"&&b==="boris"||c==="app"&&b==="factory"||c==="sharing"&&b==="system")}),a.done()},"namespaceFromProperties - bad data":function(a){var c,d=b.Utils.namespaceFromProperties(c);a.strictEqual(d.owner,""),a.strictEqual(d.app,""),a.strictEqual(d.sharing,"");var e={},f=b.Utils.namespaceFromProperties(c);a.strictEqual(f.owner,""),a.strictEqual(f.app,""),a.strictEqual(f.sharing,""),a.done()}}};if(b===a.main){var f=a("../contrib/nodeunit/test_reporter"),g=c.setup();f.run([{Tests:g}])}}),require.define("/package.json",function(a,b,c,d,e){b.exports={main:"index.js"}}),require.define("/index.js",function(a,b,c,d,e){(function(){var d=c||this;process.env=process.env||{},b.exports=d={Logger:a("./lib/log").Logger,Context:a("./lib/context"),Service:a("./lib/service"),Http:a("./lib/http"),Utils:a("./lib/utils"),Async:a("./lib/async"),Paths:a("./lib/paths").Paths,Class:a("./lib/jquery.class").Class,ModularInputs:a("./lib/modularinputs")},typeof window=="undefined"&&(d.NodeHttp=a("./lib/platform/node/node_http").NodeHttp)})()}),require.define("/lib/log.js",function(a,b,c,d,e){(function(){"use strict";var b=a("./utils"),d=c||this,e={ALL:4,INFO:3,WARN:2,ERROR:1,NONE:0},f=function(a){b.isString(a)&&e.hasOwnProperty(a)?process.env.LOG_LEVEL=e[a]:!isNaN(parseInt(a,10))&&b.keyOf(parseInt(a,10),e)?process.env.LOG_LEVEL=a:process.env.LOG_LEVEL=e.ERROR};process.env.LOG_LEVEL?f(process.env.LOG_LEVEL):process.env.LOG_LEVEL=e.ERROR;var g,h,i,j;g=h=i=j=function(){};if(typeof console!="undefined"){var k=function(a){return function(b){try{console[a].apply(console,arguments)}catch(c){console[a](b)}}};console.log&&(g=k("log")),console.error&&(i=k("error")),console.warn&&(h=k("warn")),console.info&&(j=k("info"))}c.Logger={log:function(){process.env.LOG_LEVEL>=e.ALL&&g.apply(null,arguments)},error:function(){process.env.LOG_LEVEL>=e.ERROR&&i.apply(null,arguments)},warn:function(){process.env.LOG_LEVEL>=e.WARN&&h.apply(null,arguments)},info:function(){process.env.LOG_LEVEL>=e.INFO&&j.apply(null,arguments)},printMessages:function(a){a=a||[];for(var b=0;b<a.length;b++){var c=a[b],d=c.type,e=c.text,f="[SPLUNKD] "+e;switch(d){case"HTTP":case"FATAL":case"ERROR":this.error(f);break;case"WARN":this.warn(f);break;case"INFO":this.info(f);break;case"HTTP":this.error(f);break;default:this.info(f)}}},setLevel:function(a){f.apply(this,arguments)},levels:e}})()}),require.define("/lib/utils.js",function(a,b,c,d,e){(function(){"use strict";var b=a("fs"),d=a("path"),e=c||this;e.bind=function(a,b){return function(){return b.apply(a,arguments)}},e.trim=function(a){return a=a||"",String.prototype.trim?String.prototype.trim.call(a):a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},e.indexOf=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},e.contains=function(a,b){return a=a||[],e.indexOf(a,b)>=0},e.startsWith=function(a,b){var c=a.match("^"+b);return c&&c.length>0&&c[0]===b},e.endsWith=function(a,b){var c=a.match(b+"$");return c&&c.length>0&&c[0]===b};var f=Object.prototype.toString;e.toArray=function(a){return Array.prototype.slice.call(a)},e.isArray=Array.isArray||function(a){return f.call(a)==="[object Array]"},e.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},e.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)},e.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)},e.isObject=function(a){return a===Object(a)},e.isEmpty=function(a){if(e.isArray(a)||e.isString(a))return a.length===0;for(var b in a)if(this.hasOwnProperty.call(a,b))return!1;return!0},e.forEach=function(a,b,c){if(a===null)return;if(Array.prototype.forEach&&a.forEach===Array.prototype.forEach)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;d<e;d++)if(d in a&&b.call(c,a[d],d,a)==={})return}else for(var f in a)if(a.hasOwnProperty(f)&&b.call(c,a[f],f,a)==={})return},e.extend=function(a){return e.forEach(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},e.clone=function(a){return e.isObject(a)?e.isArray(a)?a.slice():e.extend({},a):a},e.namespaceFromProperties=function(a){return e.isUndefined(a)||e.isUndefined(a.acl)?{owner:"",app:"",sharing:""}:{owner:a.acl.owner,app:a.acl.app,sharing:a.acl.sharing}},e.keyOf=function(a,b){for(var c in b)if(b.hasOwnProperty(c)&&b[c]===a)return c;return undefined},e.getWithVersion=function(a,b){b=b||{};var c=a+""||"";while(c!==""){if(b.hasOwnProperty(c))return b[c];c=c.slice(0,c.lastIndexOf("."))}return b["default"]},e.isUndefined=function(a){return typeof a=="undefined"},e.readFile=function(a,c){return b.readFileSync(d.resolve(a,c)).toString()}})()}),require.define("fs",function(a,b,c,d,e){}),require.define("/lib/context.js",function(a,b,c,d,e){(function(){"use strict";var d=a("./paths").Paths,e=a("./jquery.class").Class,f=a("./http"),g=a("./utils"),h=c||this,i={5:"",4.3:"/services/json/v2","default":""};b.exports=h=e.extend({init:function(b,c){!(b instanceof f)&&!c&&(c=b,b=null),c=c||{},this.scheme=c.scheme||"https",this.host=c.host||"localhost",this.port=c.port||8089,this.username=c.username||null,this.password=c.password||null,this.owner=c.owner,this.app=c.app,this.sessionKey=c.sessionKey||"",this.authorization=c.authorization||"Splunk",this.paths=c.paths||d,this.version=c.version||"default",this.timeout=c.timeout||0,this.autologin=!0,c.hasOwnProperty("autologin")&&(this.autologin=c.autologin);if(!b){if(typeof window!="undefined")throw new Error("Http instance required when creating a Context within a browser.");var e=a("./platform/node/node_http").NodeHttp;b=new e}this.http=b,this.http._setSplunkVersion(this.version);var h=g.getWithVersion(this.version,i);this.prefix=this.scheme+"://"+this.host+":"+this.port+h,this._headers=g.bind(this,this._headers),this.fullpath=g.bind(this,this.fullpath),this.urlify=g.bind(this,this.urlify),this.get=g.bind(this,this.get),this.del=g.bind(this,this.del),this.post=g.bind(this,this.post),this.login=g.bind(this,this.login),this._shouldAutoLogin=g.bind(this,this._shouldAutoLogin),this._requestWrapper=g.bind(this,this._requestWrapper)},_headers:function(a){return a=a||{},this.sessionKey&&(a.Authorization=this.authorization+" "+this.sessionKey),a},_shouldAutoLogin:function(){return this.username&&this.password&&this.autologin},_requestWrapper:function(a,b){b=b||function(){};var c=this,d=null,e=function(e){if(d.wasAborted)return;e&&e.status===401&&c._shouldAutoLogin()?(c.sessionKey=null,c.login(function(c,e){if(d.wasAborted)return;c?b(c):a(b)})):b.apply(null,arguments)};return!this._shouldAutoLogin()||this.sessionKey?(d=a(e),d):(d=this.login(function(c,e){if(d.wasAborted)return;c?b(c):a(b)}),d)},fullpath:function(a,b){b=b||{};if(g.startsWith(a,"/"))return a;if(!b.app&&!this.app&&b.sharing!==h.Sharing.SYSTEM)return"/services/"+a;var c=b.owner||this.owner||"-",d=b.app||this.app||"-";return b.sharing=(b.sharing||"").toLowerCase(),b.sharing===h.Sharing.APP||b.sharing===h.Sharing.GLOBAL?c="nobody":b.sharing===h.Sharing.SYSTEM&&(c="nobody",d="system"),g.trim("/servicesNS/"+encodeURIComponent(c)+"/"+encodeURIComponent(d)+"/"+a)},urlify:function(a){return this.prefix+this.fullpath(a)},login:function(a){var b=this,c=this.paths.login,d={username:this.username,password:this.password,cookie:"1"};a=a||function(){};var e=function(c,d){var e=!!(!c&&d.data&&d.data.sessionKey);c||!e?a(c||"No session key available",!1):(b.sessionKey=d.data.sessionKey,a(null,!0))};return this.http.post(this.urlify(c),this._headers(),d,this.timeout,e)},logout:function(a){a=a||function(){},this.sessionKey=null,this.http._cookieStore={},a()},get:function(a,b,c){var d=this,e=function(c){return d.http.get(d.urlify(a),d._headers(),b,d.timeout,c)};return this._requestWrapper(e,c)},del:function(a,b,c){var d=this,e=function(c){return d.http.del(d.urlify(a),d._headers(),b,d.timeout,c)};return this._requestWrapper(e,c)},post:function(a,b,c){var d=this,e=function(c){return d.http.post(d.urlify(a),d._headers(),b,d.timeout,c)};return this._requestWrapper(e,c)},request:function(a,b,c,d,e,f,g){var h=this,i=function(g){return h.http.request(h.urlify(a),{method:b,headers:h._headers(f),query:c,post:d,body:e,timeout:h.timeout},g)};return this._requestWrapper(i,g)},versionCompare:function(a){var b=this.version;b==="default"&&(b="5.0");var c=b.split("."),d=a.split("."),e=Math.max(c.length,d.length);for(var f=0;f<e;f++){var g=f<c.length?parseInt(c[f],10):0,h=f<d.length?parseInt(d[f],10):0;if(g<h)return-1;if(g>h)return 1}return 0}}),h.Sharing={USER:"user",APP:"app",GLOBAL:"global",SYSTEM:"system"}})()}),require.define("/lib/paths.js",function(a,b,c,d,e){(function(){"use strict";var a=c||this;a.Paths={apps:"/services/apps/local",capabilities:"authorization/capabilities",configurations:"configs",dataModels:"datamodel/model",deploymentClient:"deployment/client",deploymentServers:"deployment/server",deploymentServerClasses:"deployment/serverclass",deploymentTenants:"deployment/tenants",eventTypes:"saved/eventtypes",firedAlerts:"alerts/fired_alerts",indexes:"data/indexes",info:"/services/server/info",inputs:null,jobs:"search/jobs",licenseGroups:"licenser/groups",licenseMessages:"licenser/messages",licensePools:"licenser/pools",licenseSlaves:"licenser/slaves",licenseStacks:"licenser/stacks",licenses:"licenser/licenses",loggers:"server/logger",login:"/services/auth/login",messages:"messages",passwords:"admin/passwords",parser:"search/parser",pivot:"datamodel/pivot",properties:"properties",roles:"authorization/roles",savedSearches:"saved/searches",settings:"server/settings",storagePasswords:"storage/passwords",users:"/services/authentication/users",typeahead:"search/typeahead",views:"data/ui/views",currentUser:"/services/authentication/current-context",submitEvent:"/services/receivers/simple"}})()}),require.define("/lib/jquery.class.js",function(a,b,c,d,e){(function(){var a=c||this,b=!1,d=/xyz/.test(function(){return xyz})?/\b_super\b/:/.*/;a.Class=function(){},a.Class.extend=function(a){function g(){!b&&this.init&&this.init.apply(this,arguments)}var c=this.prototype;b=!0;var e=new this;b=!1;for(var f in a)e[f]=typeof a[f]=="function"&&typeof c[f]=="function"&&d.test(a[f])?function(a,b){return function(){var d=this._super;this._super=c[a];var e=b.apply(this,arguments);return this._super=d,e}}(f,a[f]):a[f];return g.prototype=e,g.constructor=g,g.extend=arguments.callee,g}})()}),require.define("/lib/http.js",function(a,b,c,d,e){(function(){"use strict";var d=a("./jquery.class").Class,e=a("./log").Logger,f=a("./utils"),g=a("cookie"),h=c||this,i=null,j={5:function(a){var b=a.query||{},c=a.post||{},d=b.output_mode||c.output_mode||"json";return f.startsWith(d,"json")||(d="json"),b.output_mode=d,b},4:function(a){return a.query||{}},"default":function(a){return j[5](a)},none:function(a){return a.query||{}}};b.exports=h=i=d.extend({init:function(){this.get=f.bind(this,this.get),this.del=f.bind(this,this.del),this.post=f.bind(this,this.post),this.request=f.bind(this,this.request),this._buildResponse=f.bind(this,this._buildResponse),this._setSplunkVersion("none"),this._cookieStore={}},_setSplunkVersion:function(a){this.version=a},_getCookieString:function(){var a="";return f.forEach(this._cookieStore,function(b,c){a+=c,a+="=",a+=b,a+="; "}),a},_parseCookieHeader:function(a){var b=g.parse(a),c={};return f.forEach(b,function(a,b){if(c.key)return;c.key=b,c.value=a}),c},get:function(a,b,c,d,e){var f={method:"GET",headers:b,timeout:d,query:c};return this.request(a,f,e)},post:function(a,b,c,d,e){b["Content-Type"]="application/x-www-form-urlencoded";var f={method:"POST",headers:b,timeout:d,post:c};return this.request(a,f,e)},del:function(a,b,c,d,e){var f={method:"DELETE",headers:b,timeout:d,query:c};return this.request(a,f,e)},request:function(a,b,c){var d=this,e=function(a){c=c||function(){};var b=a.response.headers["set-cookie"];b&&f.forEach(b,function(a){var b=d._parseCookieHeader(a);d._cookieStore[b.key]=b.value}),a.status<400&&a.status!=="abort"?c(null,a):c(a)},g=f.getWithVersion(this.version,j)(b),h=b.post||{},k=a+"?"+i.encode(g),l=b.body?b.body:i.encode(h),m=d._getCookieString();m.length!==0&&(b.headers.Cookie=m,delete b.headers.Authorization);var n={method:b.method,headers:b.headers,timeout:b.timeout,body:l};return this.makeRequest(k,n,e)},makeRequest:function(a,b,c){throw new Error("UNDEFINED FUNCTION - OVERRIDE REQUIRED")},parseJson:function(a){throw new Error("UNDEFINED FUNCTION - OVERRIDE REQUIRED")},_buildResponse:function(a,b,c){var d,g={},h=null;b&&b.headers&&(h=f.trim(b.headers["content-type"]||b.headers["Content-Type"]||b.headers["Content-type"]||b.headers.contentType));if(f.startsWith(h,"application/json")&&c)try{g=this.parseJson(c)||{}}catch(i){e.error("Error in parsing JSON:",c,i),g=c}else g=c;return g&&e.printMessages(g.messages),d={response:b,status:b?b.statusCode:0,data:g,error:a},d}}),i.encode=function(a){var b="";for(var c in a)if(a.hasOwnProperty(c)){b&&b[b.length-1]!=="&"&&(b+="&");var d=a[c];if(d instanceof Array)for(var e=0;e<d.length;e++)b=b+c+"="+encodeURIComponent(d[e])+"&";else if(typeof d=="object"){for(var f in d)if(d.hasOwnProperty(f)){var g=d[f];b=b+c+"="+encodeURIComponent(d[f])+"&"}}else b=b+c+"="+encodeURIComponent(d)}return b[b.length-1]==="&"&&(b=b.substr(0,b.length-1)),b}})()}),require.define("/node_modules/cookie/package.json",function(a,b,c,d,e){b.exports={}}),require.define("/node_modules/cookie/index.js",function(a,b,c,d,e){function i(a,b){if(typeof a!="string")throw new TypeError("argument str must be a string");var c={},d=b||{},e=a.split(h),g=d.decode||f;return e.forEach(function(a){var b=a.indexOf("=");if(b<0)return;var d=a.substr(0,b).trim(),e=a.substr(++b,a.length).trim();'"'==e[0]&&(e=e.slice(1,-1)),undefined==c[d]&&(c[d]=k(e,g))}),c}function j(a,b,c){var d=c||{},e=d.encode||g,f=[a+"="+e(b)];if(null!=d.maxAge){var h=d.maxAge-0;if(isNaN(h))throw new Error("maxAge should be a Number");f.push("Max-Age="+h)}return d.domain&&f.push("Domain="+d.domain),d.path&&f.push("Path="+d.path),d.expires&&f.push("Expires="+d.expires.toUTCString()),d.httpOnly&&f.push("HttpOnly"),d.secure&&f.push("Secure"),d.firstPartyOnly&&f.push("First-Party-Only"),f.join("; ")}function k(a,b){try{return b(a)}catch(c){return a}}c.parse=i,c.serialize=j;var f=decodeURIComponent,g=encodeURIComponent,h=/; */}),require.define("/lib/service.js",function(a,b,c,d,e){(function(){"use strict";var d=a("./context"),e=a("./http"),f=a("./async"),g=a("./paths").Paths,h=a("./jquery.class").Class,i=a("./utils"),j=c||this,k=null,l=d.extend({init:function(){this._super.apply(this,arguments)}});b.exports=j=k=l.extend({init:function(){this._super.apply(this,arguments),this.specialize=i.bind(this,this.specialize),this.apps=i.bind(this,this.apps),this.configurations=i.bind(this,this.configurations),this.indexes=i.bind(this,this.indexes),this.savedSearches=i.bind(this,this.savedSearches),this.jobs=i.bind(this,this.jobs),this.users=i.bind(this,this.users),this.currentUser=i.bind(this,this.currentUser),this.views=i.bind(this,this.views),this.firedAlertGroups=i.bind(this,this.firedAlertGroups),this.dataModels=i.bind(this,this.dataModels)},specialize:function(a,b){return new k(this.http,{scheme:this.scheme,host:this.host,port:this.port,username:this.username,password:this.password,owner:a,app:b,sessionKey:this.sessionKey,version:this.version})},apps:function(){return new j.Applications(this)},configurations:function(a){return new j.Configurations(this,a)},indexes:function(a){return new j.Indexes(this,a)},savedSearches:function(a){return new j.SavedSearches(this,a)},storagePasswords:function(a){return new j.StoragePasswords(this,a)},firedAlertGroups:function(a){return new j.FiredAlertGroupCollection(this,a)},jobs:function(a){return new j.Jobs(this,a)},dataModels:function(a){return new j.DataModels(this,a)},users:function(){return new j.Users(this)},views:function(a){return new j.Views(this,a)},search:function(a,b,c,d){!d&&i.isFunction(c)&&(d=c,c=null);var e=new j.Jobs(this,c);return e.search(a,b,d)},getJob:function(a,b,c){!c&&i.isFunction(b)&&(c=b,b=null);var d=new j.Job(this,a,b);return d.fetch({},c)},oneshotSearch:function(a,b,c,d){!d&&i.isFunction(c)&&(d=c,c=null);var e=new j.Jobs(this,c);return e.oneshotSearch(a,b,d)},currentUser:function(a){a=a||function(){};var b=this,c=this.get(g.currentUser,{},function(d,e){if(d)a(d);else{var f=e.data.entry[0].content.username,g=new j.User(b,f);g.fetch(function(){if(c.wasAborted)return;a.apply(null,arguments)})}});return c},serverInfo:function(a){a=a||function(){};var b=new j.ServerInfo(this);return b.fetch(a)},parse:function(a,b,c){return!c&&i.isFunction(b)&&(c=b,b={}),c=c||function(){},b=b||{},b.q=a,this.get(g.parser,b,function(a,b){a?c(a):c(null,b.data)})},typeahead:function(a,b,c){!c&&i.isFunction(b)&&(c=b,b=10),c=c||function(){};var d={count:b||10,prefix:a};return this.get(g.typeahead,d,function(a,b){if(a)c(a);else{var d=(b.data||{}).results;c(null,d||[])}})},log:function(a,b,c){!c&&i.isFunction(b)&&(c=b,b={}),c=c||function(){},b=b||{},i.isObject(a)&&(a=JSON.stringify(a));var d=this.paths.submitEvent,e="POST",f={"Content-Type":"text/plain"},g=a,h=b,j={},k=this.request(d,e,h,j,g,f,function(a,b){a?c(a):c(null,b.data)});return k}}),j.Endpoint=h.extend({init:function(a,b){if(!a)throw new Error("Passed in a null Service.");if(!b)throw new Error("Passed in an empty path.");this.service=a,this.qualifiedPath=b,this.get=i.bind(this,this.get),this.post=i.bind(this,this.post),this.del=i.bind(this,this.del)},get:function(a,b,c){var d=this.qualifiedPath;return a&&(d=d+"/"+a),this.service.get(d,b,c)},post:function(a,b,c){var d=this.qualifiedPath;return a&&(d=d+"/"+a),this.service.post(d,b,c)},del:function(a,b,c){var d=this.qualifiedPath;return a&&(d=d+"/"+a),this.service.del(d,b,c)}}),j.Resource=j.Endpoint.extend({init:function(a,b,c){var d=a.fullpath(b,c);this._super(a,d),this.namespace=c,this._properties={},this._state={},this._load=i.bind(this,this._load),this.fetch=i.bind(this,this.fetch),this.properties=i.bind(this,this.properties),this.state=i.bind(this,this.state),this.path=i.bind(this,this.path)},path:function(){throw new Error("MUST BE OVERRIDDEN")},_load:function(a){this._properties=a||{},this._state=a||{}},fetch:function(a){throw new Error("MUST BE OVERRIDDEN")},properties:function(){return this._properties},state:function(){return this._state}}),j.Entity=j.Resource.extend({fetchOnUpdate:!1,init:function(a,b,c){this._super(a,b,c),this._load=i.bind(this,this._load),this.fetch=i.bind(this,this.fetch),this.remove=i.bind(this,this.remove),this.update=i.bind(this,this.update),this.fields=i.bind(this,this.fields),this.links=i.bind(this,this.links),this.acl=i.bind(this,this.acl),this.author=i.bind(this,this.author),this.updated=i.bind(this,this.updated),this.published=i.bind(this,this.published),this.enable=i.bind(this,this.enable),this.disable=i.bind(this,this.disable),this.reload=i.bind(this,this.reload),this._properties={},this._fields={},this._acl={},this._links={}},_load:function(a){a=i.isArray(a)?a[0]:a,a=a||{content:{},fields:{},acl:{},links:{}},this._super(a),this._properties=a.content||{},this._fields=a.fields||this._fields||{},this._acl=a.acl||{},this._links=a.links||{},this._author=a.author||null,this._updated=a.updated||null,this._published=a.published||null},fields:function(){return this._fields},acl:function(){return this._acl},links:function(){return this._links},author:function(){return this._author},updated:function(){return this._updated},published:function(){return this._published},fetch:function(a,b){!b&&i.isFunction(a)&&(b=a,a={}),b=b||function(){},a=a||{};var c=this;return this.get("",a,function(a,d){a?b(a):(c._load(d.data?d.data.entry:null),b(null,c))})},remove:function(a){a=a||function(){};var b=this;return this.del("",{},function(b){a(b)})},update:function(a,b){b=b||function(){};if(a.hasOwnProperty("name"))throw new Error("Cannot set 'name' field in 'update'");var c=this,d=this.post("",a,function(a,e){!a&&!c.fetchOnUpdate?(c._load(e.data.entry),b(a,c)):!a&&c.fetchOnUpdate?c.fetch(function(){if(d.wasAborted)return;b.apply(null,arguments)}):b(a,c)});return d},disable:function(a){a=a||function(){};var b=this;this.post("disable",{},function(c,d){c?a(c):a(null,b)})},enable:function(a){a=a||function(){};var b=this;this.post("enable",{},function(c,d){c?a(c):a(null,b)})},reload:function(a){a=a||function(){};var b=this;this.post("_reload",{},function(c,d){c?a(c):a(null,b)})}}),j.Collection=j.Resource.extend({fetchOnEntityCreation:!1,init:function(a,b,c){this._super(a,b,c),this._load=i.bind(this,this._load),this.fetch=i.bind(this,this.fetch),this.create=i.bind(this,this.create),this.list=i.bind(this,this.list),this.item=i.bind(this,this.item),this.instantiateEntity=i.bind(this,this.instantiateEntity),this._entities=[],this._entitiesByName={},this._properties={},this._paging={},this._links={}},instantiateEntity:function(a){throw new Error("MUST BE OVERRIDDEN")},_load:function(a){this._super(a);var b=[],c={},d=a.entry||[];for(var e=0;e<d.length;e++){var f=d[e],g=this.instantiateEntity(f);g._load(f),b.push(g),c.hasOwnProperty(g.name)?c[g.name].push(g):c[g.name]=[g]}this._entities=b,this._entitiesByName=c,this._paging=a.paging||{},this._links=a.links||{},this._updated=a.updated||null},links:function(){return this._links},paging:function(){return this._paging},updated:function(){return this._updated},fetch:function(a,b){!b&&i.isFunction(a)&&(b=a,a={}),b=b||function(){},a=a||{},a.count||(a.count=0);var c=this,d=c.get("",a,function(a,d){a?b(a):(c._load(d.data),b(null,c))});return d},item:function(a,b){i.isEmpty(b)&&(b=null);if(!a)throw new Error("Must suply a non-empty name.");if(!(!b||b.app!=="-"&&b.owner!=="-"))throw new Error("When searching for an entity, wildcards are not allowed in the namespace. Please refine your search.");var c=null;if(!this._entitiesByName.hasOwnProperty(a))return null;var d=this._entitiesByName[a];if(d.length===1&&!b)return d[0];if(d.length===1&&b)return c=this.service.fullpath(d[0].path(),b),d[0].qualifiedPath===c?d[0]:null;if(d.length>1&&!b)throw new Error("Ambiguous match for name '"+a+"'");for(var e=0;e<d.length;e++){var f=d[e];c=this.service.fullpath(d[e].path(),b);if(f.qualifiedPath===c)return f}},create:function(a,b){b=b||function(){};var c=this,d=this.post("",a,function(a,e){if(a)b(a);else{var f=e.data.entry;i.isArray(f)&&(f=f[0]);var g=c.instantiateEntity(f);g._load(f),c.fetchOnEntityCreation?g.fetch(function(){if(d.wasAborted)return;b.apply(null,arguments)}):b(null,g)}});return d},list:function(a){return a=a||function(){},i.clone(this._entities)}}),j.SavedSearch=j.Entity.extend({path:function(){return g.savedSearches+"/"+encodeURIComponent(this.name)},init:function(a,b,c){this.name=b,this._super(a,this.path(),c),this.acknowledge=i.bind(this,this.acknowledge),this.dispatch=i.bind(this,this.dispatch),this.history=i.bind(this,this.history),this.suppressInfo=i.bind(this,this.suppressInfo)},alertCount:function(){return parseInt(this.properties().triggered_alert_count,10)||0},acknowledge:function(a){a=a||function(){};var b=this,c=this.post("acknowledge",{},function(c){a(c,b)});return c},dispatch:function(a,b){!b&&i.isFunction(a)&&(b=a,a={}),b=b||function(){},a=a||{};var c=this,d=this.post("dispatch",a,function(a,d){if(a){b(a);return}var e=d.data.sid,f=new j.Job(c.service,e,c.namespace);b(null,f,c)});return d},firedAlertGroup:function(){return new j.FiredAlertGroup(this.service,this.name)},history:function(a){a=a||function(){};var b=this;return this.get("history",{},function(c,d){if(c){a(c);return}var e=[],f=d.data.entry||[];for(var g=0;g<f.length;g++){var h=d.data.entry[g],k=i.namespaceFromProperties(h),l=new j.Job(b.service,h.name,k);l._load(h),e.push(l)}a(null,e,b)})},suppressInfo:function(a){a=a||function(){};var b=this;return this.get("suppress",{},function(c,d){a(c,d.data.entry.content,b)})},update:function(a,b){a=a||{};if(!a.search){var c=this._super,d=this.fetch(function(e,f){e?b(e):(a.search=f.properties().search,c.call(f,a,function(){if(d.wasAborted)return;b.apply(null,arguments)}))});return d}return this._super(a,b)}}),j.SavedSearches=j.Collection.extend({path:function(){return g.savedSearches},instantiateEntity:function(a){var b=i.namespaceFromProperties(a);return new j.SavedSearch(this.service,a.name,b)},init:function(a,b){this._super(a,this.path(),b)}}),j.StoragePassword=j.Entity.extend({path:function(){return g.storagePasswords+"/"+encodeURIComponent(this.name)},init:function(a,b,c){this.name=b,this._super(a,this.path(),c)}}),j.StoragePasswords=j.Collection.extend({path:function(){return g.storagePasswords},instantiateEntity:function(a){var b=i.namespaceFromProperties(a);return new j.StoragePassword(this.service,a.name,b)},init:function(a,b){this._super(a,this.path(),b)}}),j.FiredAlert=j.Entity.extend({path:function(){return g.firedAlerts+"/"+encodeURIComponent(this.name)},actions:function(){return this.properties().actions||[]},alertType:function(){return this.properties().alert_type||null},isDigestMode:function(){return!!this.properties().digest_mode},expirationTime:function(){return this.properties().expiration_time_rendered||null},savedSearchName:function(){return this.properties().savedsearch_name||null},severity:function(){return parseInt(this.properties().severity,10)||-1},sid:function(){return this.properties().sid||null},triggerTime:function(){return this.properties().trigger_time||null},triggerTimeRendered:function(){return this.properties().trigger_time_rendered||null},triggeredAlertCount:function(){return parseInt(this.properties().triggered_alerts,10)||-1},init:function(a,b,c){this.name=b,this._super(a,this.path(),c)}}),j.FiredAlertGroup=j.Entity.extend({path:function(){return g.firedAlerts+"/"+encodeURIComponent(this.name)},count:function(){return parseInt(this.properties().triggered_alert_count,10)||0},list:function(a,b){!b&&i.isFunction(a)&&(b=a,a={}),b=b||function(){},a=a||{};var c=this;return this.get("",a,function(a,d){if(a){b(a);return}var e=[],f=d.data.entry||[];for(var g=0;g<f.length;g++){var h=d.data.entry[g],k=i.namespaceFromProperties(h),l=new j.FiredAlert(c.service,h.name,k);l._load(h),e.push(l)}b(null,e,c)})},init:function(a,b,c){this.name=b,this._super(a,this.path(),c),this.list=i.bind(this,this.list)}}),j.FiredAlertGroupCollection=j.Collection.extend({path:function(){return g.firedAlerts},instantiateEntity:function(a){var b=i.namespaceFromProperties(a);return new j.FiredAlertGroup(this.service,a.name,b)},remove:function(){throw new Error("To remove an alert, remove the saved search with the same name.")},init:function(a,b){this._super(a,this.path(),b),this.instantiateEntity=i.bind(this,this.instantiateEntity),this.remove=i.bind(this,this.remove)}}),j.Application=j.Entity.extend({fetchOnUpdate:!0,path:function(){return g.apps+"/"+encodeURIComponent(this.name)},init:function(a,b){this.name=b,this._super(a,this.path(),{}),this.setupInfo=i.bind(this,this.setupInfo),this.updateInfo=i.bind(this,this.updateInfo)},setupInfo:function(a){a=a||function(){};var b=this;return this.get("setup",{},function(c,d){c?a(c):a(null,d.data.entry.content,b)})},updateInfo:function(a){a=a||function(){};var b=this;return this.get("update",{},function(c,d){c?a(c):a(null,d.data.entry.content,b)})}}),j.Applications=j.Collection.extend({fetchOnEntityCreation:!0,path:function(){return g.apps},instantiateEntity:function(a){return new j.Application(this.service,a.name,{})},init:function(a){this._super(a,this.path(),{})}}),j.ServerInfo=j.Entity.extend({path:function(){return g.info},init:function(a){this.name="server-info",this._super(a,this.path(),{})}}),j.User=j.Entity.extend({path:function(){return g.users+"/"+encodeURIComponent(this.name)},init:function(a,b){this.name=b,this._super(a,this.path(),{})}}),j.Users=j.Collection.extend({fetchOnEntityCreation:!0,path:function(){return g.users},instantiateEntity:function(a){return new j.User(this.service,a.name,{})},init:function(a){this._super(a,this.path(),{})},create:function(a,b){b=b||function(){};var c=this,d=this.post("",a,function(e,f){if(e)b(e);else{var g={name:a.name},h=c.instantiateEntity(g);h.fetch(function(){if(d.wasAborted)return;b.apply(null,arguments)})}});return d}}),j.View=j.Entity.extend({path:function(){return g.views+"/"+encodeURIComponent(this.name)},init:function(a,b,c){this.name=b,this._super(a,this.path(),c)}}),j.Views=j.Collection.extend({path:function(){return g.views},instantiateEntity:function(a){var b=i.namespaceFromProperties(a);return new j.View(this.service,a.name,b)},init:function(a,b){this._super(a,this.path(),b)}}),j.Index=j.Entity.extend({path:function(){return g.indexes+"/"+encodeURIComponent(this.name)},init:function(a,b,c){this.name=b,this._super(a,this.path(),c),this.submitEvent=i.bind(this,this.submitEvent)},submitEvent:function(a,b,c){!c&&i.isFunction(b)&&(c=b,b={}),c=c||function(){},b=b||{},b.index=this.name;var d=this;return this.service.log(a,b,function(a,b){c(a,b,d)})},remove:function(a){if(this.service.versionCompare("5.0")<0)throw new Error("Indexes cannot be removed in Splunk 4.x");return this._super(a)}}),j.Indexes=j.Collection.extend({path:function(){return g.indexes},instantiateEntity:function(a){var b=i.namespaceFromProperties(a);return new j.Index(this.service,a.name,b)},init:function(a,b){this._super(a,this.path(),b)},create:function(a,b,c){return i.isObject(a)&&i.isFunction(b)&&!c&&(c=b,b=a,a=b.name),b=b||{},b.name=a,this._super(b,c)}}),j.ConfigurationStanza=j.Entity.extend({path:function(){var a=this.name==="default"?"_new":this.name;return g.configurations+"/conf-"+encodeURIComponent(this.file)+"/"+encodeURIComponent(a)},init:function(a,b,c,d){this.name=c,this.file=b,this._super(a,this.path(),d)}}),j.ConfigurationFile=j.Collection.extend({path:function(){return g.configurations+"/conf-"+encodeURIComponent(this.name)},getDefaultStanza:function(){return new j.ConfigurationStanza(this.service,this.name,"default",this.namespace)},instantiateEntity:function(a){var b=i.namespaceFromProperties(a);return new j.ConfigurationStanza(this.service,this.name,a.name,b)},init:function(a,b,c){this.name=b,this._super(a,this.path(),c)},create:function(a,b,c){return i.isObject(a)&&i.isFunction(b)&&!c&&(c=b,b=a,a=b.name),i.isFunction(b)&&!c&&(c=b,b={}),b=b||{},b.name=a,this._super(b,c)}}),j.Configurations=j.Collection.extend({fetchOnEntityCreation:!0,path:function(){return g.properties},instantiateEntity:function(a){return new j.ConfigurationFile(this.service,a.name,this.namespace)},init:function(a,b){if(!b||b.owner==="-"||b.app==="-")throw new Error("Configurations requires a non-wildcard owner/app");this._super(a,this.path(),b)},create:function(a,b){i.isObject(a)&&(a=a.__conf),b=b||function(){};var c=this,d=this.post("",{__conf:a},function(e,f){if(e)b(e);else{var g=new j.ConfigurationFile(c.service,a);g.fetch(function(){if(d.wasAborted)return;b.apply(null,arguments)})}});return d}}),j.Job=j.Entity.extend({path:function(){return g.jobs+"/"+encodeURIComponent(this.name)},init:function(a,b,c){this.name=b,this._super(a,this.path(),c),this.sid=b,this.cancel=i.bind(this,this.cancel),this.disablePreview=i.bind(this,this.disablePreview),this.enablePreview=i.bind(this,this.enablePreview),this.events=i.bind(this,this.events),this.finalize=i.bind(this,this.finalize),this.pause=i.bind(this,this.pause),this.preview=i.bind(this,this.preview),this.results=i.bind(this,this.results),this.searchlog=i.bind(this,this.searchlog),this.setPriority=i.bind(this,this.setPriority),this.setTTL=i.bind(this,this.setTTL),this.summary=i.bind(this,this.summary),this.timeline=i.bind(this,this.timeline),this.touch=i.bind(this,this.touch),this.unpause=i.bind(this,this.unpause)},cancel:function(a){var b=this.post("control",{action:"cancel"},a);return b},disablePreview:function(a){a=a||function(){};var b=this,c=this.post("control",{action:"disablepreview"},function(c){a(c,b)});return c},enablePreview:function(a){a=a||function(){};var b=this,c=this.post("control",{action:"enablepreview"},function(c){a(c,b)});return c},events:function(a,b){b=b||function(){},a=a||{},a.output_mode=a.output_mode||"json_rows";var c=this;return this.get("events",a,function(a,d){a?b(a):b(null,d.data,c)})},finalize:function(a){a=a||function(){};var b=this,c=this.post("control",{action:"finalize"},function(c){a(c,b)});return c},iterator:function(a,b){return new j.PaginatedEndpointIterator(this[a],b)},pause:function(a){a=a||function(){};var b=this,c=this.post("control",{action:"pause"},function(c){a(c,b)});return c},preview:function(a,b){b=b||function(){},a=a||{},a.output_mode=a.output_mode||"json_rows";var c=this;return this.get("results_preview",a,function(a,d){a?b(a):b(null,d.data,c)})},results:function(a,b){b=b||function(){},a=a||{},a.output_mode=a.output_mode||"json_rows";var c=this;return this.get("results",a,function(a,d){a?b(a):b(null,d.data,c)})},searchlog:function(a){a=a||function(){};var b=this;return this.get("search.log",{},function(c,d){c?a(c):a(null,d.data,b)})},setPriority:function(a,b){b=b||function(){};var c=this,d=this.post("control",{action:"setpriority",priority:a},function(a){b(a,c)});return d},setTTL:function(a,b){b=b||function(){};var c=this,d=this.post("control",{action:"setttl",ttl:a},function(a){b(a,c)});return d},summary:function(a,b){b=b||function(){};var c=this;return this.get("summary",a,function(a,d){a?b(a):b(null,d.data,c)})},timeline:function(a,b){b=b||function(){};var c=this;return this.get("timeline",a,function(a,d){a?b(a):b(null,d.data,c)})},touch:function(a){a=a||function(){};var b=this,c=this.post("control",{action:"touch"},function(c){a(c,b)});return c},track:function(a,b){var c=a.period||500;i.isFunction(b)&&(b={done:b});var d=!b.progress&&!b.done&&!b.failed&&!b.error;b.ready=b.ready||function(){},b.progress=b.progress||function(){},b.done=b.done||function(){},b.failed=b.failed||function(){},b.error=b.error||function(){},b._preready=b._preready||function(){},b._stoppedAfterReady=b._stoppedAfterReady||function(){};var e=this,g=!1,h=!1;f.whilst(function(){return!h},function(a){e.fetch(function(e,i){if(e){a(e);return}var j=i.properties().dispatchState,k=j==="QUEUED"||j==="PARSING";if(k)b._preready(i);else{if(!g){b.ready(i),g=!0;if(d){b._stoppedAfterReady(i),h=!0,a();return}}b.progress(i);var l=i.properties();if(j==="DONE"&&l.isDone){b.done(i),h=!0,a();return}if(j==="FAILED"&&l.isFailed){b.failed(i),h=!0,a();return}}f.sleep(c,a)})},function(a){a&&b.error(a)})},unpause:function(a){a=a||function(){};var b=this,c=this.post("control",{action:"unpause"},function(c){a(c,b)});return c}}),j.Jobs=j.Collection.extend({path:function(){return g.jobs},instantiateEntity:function(a){var b=a.content.sid,c=i.namespaceFromProperties(a);return new j.Job(this.service,b,c)},init:function(a,b){this._super(a,this.path(),b),this.create=i.bind(this,this.create)},create:function(a,b,c){i.isObject(a)&&i.isFunction(b)&&!c&&(c=b,b=a,a=b.search),c=c||function(){},b=b||{},b.search=a;if((b.exec_mode||"").toLowerCase()==="oneshot")throw new Error("Please use splunkjs.Service.Jobs.oneshotSearch for exec_mode=oneshot");if(!b.search){c("Must provide a query to create a search job");return}var d=this;return this.post("",b,function(a,b){if(a)c(a);else{var e=new j.Job(d.service,b.data.sid,d.namespace);c(null,e)}})},search:function(a,b,c){return this.create(a,b,c)},oneshotSearch:function(a,b,c){i.isObject(a)&&i.isFunction(b)&&!c&&(c=b,b=a,a=b.search),c=c||function(){},b=b||{},b.search=a,b.exec_mode="oneshot",b.search||c("Must provide a query to create a search job");var d=b.output_mode||"json_rows",e=this.qualifiedPath,f="POST",g={},h=b,j={output_mode:d},k=null,l=this.service.request(e,f,j,h,k,g,function(a,b){a?c(a):c(null,b.data)});return l}}),j.DataModelField=h.extend({_types:["string","number","timestamp","objectCount","childCount","ipv4","boolean"],init:function(a){a=a||{},a.owner=a.owner||"",this.name=a.fieldName,this.displayName=a.displayName,this.type=a.type,this.multivalued=a.multivalue,this.required=a.required,this.hidden=a.hidden,this.editable=a.editable,this.comment=a.comment||null,this.fieldSearch=a.fieldSearch,this.lineage=a.owner.split("."),this.owner=this.lineage[this.lineage.length-1]},isString:function(){return"string"===this.type},isNumber:function(){return"number"===this.type},isTimestamp:function(){return"timestamp"===this.type},isObjectcount:function(){return"objectCount"===this.type},isChildcount:function(){return"childCount"===this.type},isIPv4:function(){return"ipv4"===this.type},isBoolean:function(){return"boolean"===this.type}}),j.DataModelConstraint=h.extend({init:function(a){a=a||{},a.owner=a.owner||"",this.query=a.search,this.lineage=a.owner.split("."),this.owner=this.lineage[this.lineage.length-1]}}),j.DataModelCalculation=h.extend({_types:["Lookup","Eval","GeoIP","Rex"],init:function(a){a=a||{},a.owner=a.owner||"",this.id=a.calculationID,this.type=a.calculationType,this.comment=a.comment||null,this.editable=a.editable,this.lineage=a.owner.split("."),this.owner=this.lineage[this.lineage.length-1],this.outputFields=[];for(var b=0;b<a.outputFields.length;b++)this.outputFields[a.outputFields[b].fieldName]=new j.DataModelField(a.outputFields[b]);if("Eval"===this.type||"Rex"===this.type)this.expression=a.expression;if("GeoIP"===this.type||"Rex"===this.type)this.inputField=a.inputField;"Lookup"===this.type&&(this.lookupName=a.lookupName,this.inputFieldMappings=a.lookupInputs[0])},outputFieldNames:function(){return Object.keys(this.outputFields)},isEditable:function(){return!!this.editable},isLookup:function(){return"Lookup"===this.type},isEval:function(){return"Eval"===this.type},isRex:function(){return"Rex"===this.type},isGeoIP:function(){return"GeoIP"===this.type}}),j.Pivot=h.extend({init:function(a,b){this.service=a,this.search=b.search,this.drilldownSearch=b.drilldown_search,this.prettyQuery=this.openInSearch=b.open_in_search,this.pivotSearch=b.pivot_search,this.tstatsSearch=b.tstats_search||null,this.run=i.bind(this,this.run)},run:function(a,b){i.isUndefined(b)&&(b=a,a={});if(!a||Object.keys(a).length===0)a={};this.service.search(this.tstatsSearch||this.pivotSearch,a,b)}}),j.PivotSpecification=h.extend({_comparisons:{"boolean":["=","is","isNull","isNotNull"],string:["=","is","isNull","isNotNull","contains","doesNotContain","startsWith","endsWith","regex"],number:["=","!=","<",">","<=",">=","is","isNull","isNotNull"],ipv4:["is","isNull","isNotNull","contains","doesNotContain","startsWith"]},_binning:["auto","year","month","day","hour","minute","second"],_sortDirection:["ASCENDING","DESCENDING","DEFAULT"],_statsFunctions:["list","values","first","last","count","dc","sum","average","max","min","stdev","duration","earliest","latest"],init:function(a){this.dataModelObject=a,this.columns=[],this.rows=[],this.filters=[],this.cells=[],this.accelerationNamespace=a.dataModel.isAccelerated()?a.dataModel.name:null,this.run=i.bind(this,this.run),this.pivot=i.bind(this,this.pivot)},setAccelerationJob:function(a){a&&a instanceof k.Job&&(a=a.sid);if(!a)throw new Error("Sid to use for acceleration must not be null.");return this.accelerationNamespace="sid="+a,this},addFilter:function(a,b,c,d){if(!this.dataModelObject.hasField(a))throw new Error("Cannot add filter on a nonexistent field.");if(b!==this.dataModelObject.fieldByName(a).type)throw new Error("Cannot add "+b+" filter on "+a+" because it is of type "+this.dataModelObject.fieldByName(a).type);if(!i.contains(this._comparisons[b],c))throw new Error("Cannot add "+b+" filter because "+c+" is not a valid comparison operator");var e={fieldName:a,owner:this.dataModelObject.fieldByName(a).lineage.join("."),type:b};return i.contains(["boolean","string","ipv4","number"],e.type)&&(e.comparator=c,e.compareTo=d),this.filters.push(e),this},addLimitFilter:function(a,b,c,d,e){if(!this.dataModelObject.hasField(a))throw new Error("Cannot add limit filter on a nonexistent field.");var f=this.dataModelObject.fieldByName(a);if(!i.contains(["string","number","objectCount"],f.type))throw new Error("Cannot add limit filter on "+a+" because it is of type "+f.type);if("string"===f.type&&!i.contains(["count","dc"],e))throw new Error("Stats function for fields of type string must be COUNT or DISTINCT_COUNT; found "+e);if("number"===f.type&&!i.contains(["count","dc","average","sum"],e))throw new Error("Stats function for fields of type number must be one of COUNT, DISTINCT_COUNT, SUM, or AVERAGE; found "+e);if("objectCount"===f.type&&!i.contains(["count"],e))throw new Error("Stats function for fields of type object count must be COUNT; found "+e);var g={fieldName:a,owner:f.lineage.join("."),type:f.type,attributeName:b,attributeOwner:this.dataModelObject.fieldByName(b).lineage.join("."),sortDirection:c,limitAmount:d,statsFn:e};return g.limitType="ASCENDING"===c?"lowest":"highest",this.filters.push(g),this},addRowSplit:function(a,b){if(!this.dataModelObject.hasField(a))throw new Error("Did not find field "+a);var c=this.dataModelObject.fieldByName(a);if(!i.contains(["number","string"],c.type))throw new Error("Field was of type "+c.type+", expected number or string.");var d={fieldName:a,owner:c.owner,type:c.type,label:b};return"number"===c.type&&(d.display="all"),this.rows.push(d),this},addRangeRowSplit:function(a,b,c){if(!this.dataModelObject.hasField(a))throw new Error("Did not find field "+a);var d=this.dataModelObject.fieldByName(a);if("number"!==d.type)throw new Error("Field was of type "+d.type+", expected number.");var e={};return!i.isUndefined(c.start)&&c.start!==null&&(e.start=c.start),!i.isUndefined(c.end)&&c.end!==null&&(e.end=c.end),!i.isUndefined(c.step)&&c.step!==null&&(e.size=c.step),!i.isUndefined(c.limit)&&c.limit!==null&&(e.maxNumberOf=c.limit),this.rows.push({fieldName:a,owner:d.owner,type:d.type,label:b,display:"ranges",ranges:e}),this},addBooleanRowSplit:function(a,b,c,d){if(!this.dataModelObject.fieldByName(a))throw new Error("Did not find field "+a);var e=this.dataModelObject.fieldByName(a);if("boolean"!==e.type)throw new Error("Field was of type "+e.type+", expected boolean.");return this.rows.push({fieldName:a,owner:e.owner,type:e.type,label:b,trueLabel:c,falseLabel:d}),this},addTimestampRowSplit:function(a,b,c){if(!this.dataModelObject.hasField(a))throw new Error("Did not find field "+a);var d=this.dataModelObject.fieldByName(a);if("timestamp"!==d.type)throw new Error("Field was of type "+d.type+", expected timestamp.");if(!i.contains(this._binning,c))throw new Error("Invalid binning "+c+" found. Valid values are: "+this._binning.join(", "));return this.rows.push({fieldName:a,owner:d.owner,type:d.type,label:b,period:c}),this},addColumnSplit:function(a){if(!this.dataModelObject.hasField(a))throw new Error("Did not find field "+a);var b=this.dataModelObject.fieldByName(a);if(!i.contains(["number","string"],b.type))throw new Error("Field was of type "+b.type+", expected number or string.");var c={fieldName:a,owner:b.owner,type:b.type};return"number"===b.type&&(c.display="all"),this.columns.push(c),this},addRangeColumnSplit:function(a,b){if(!this.dataModelObject.hasField(a))throw new Error("Did not find field "+a);var c=this.dataModelObject.fieldByName(a);if("number"!==c.type)throw new Error("Field was of type "+c.type+", expected number.");var d={};return!i.isUndefined(b.start)&&b.start!==null&&(d.start=b.start),!i.isUndefined(b.end)&&b.end!==null&&(d.end=b.end),!i.isUndefined(b.step)&&b.step!==null&&(d.size=b.step),!i.isUndefined(b.limit)&&b.limit!==null&&(d.maxNumberOf=b.limit),this.columns.push({fieldName:a,owner:c.owner,type:c.type,display:"ranges",ranges:d}),this},addBooleanColumnSplit:function(a,b,c){if(!this.dataModelObject.fieldByName(a))throw new Error("Did not find field "+a);var d=this.dataModelObject.fieldByName(a);if("boolean"!==d.type)throw new Error("Field was of type "+d.type+", expected boolean.");return this.columns.push({fieldName:a,owner:d.owner,type:d.type,trueLabel:b,falseLabel:c}),this},addTimestampColumnSplit:function(a,b){if(!this.dataModelObject.hasField(a))throw new Error("Did not find field "+a);var c=this.dataModelObject.fieldByName(a);if("timestamp"!==c.type)throw new Error("Field was of type "+c.type+", expected timestamp.");if(!i.contains(this._binning,b))throw new Error("Invalid binning "+b+" found. Valid values are: "+this._binning.join(", "));return this.columns.push({fieldName:a,owner:c.owner,type:c.type,period:b}),this},addCellValue:function(a,b,c){if(!this.dataModelObject.hasField(a))throw new Error("Did not find field "+a);var d=this.dataModelObject.fieldByName(a);if(i.contains(["string","ipv4"],d.type)&&!i.contains(["list","values","first","last","count","dc"],c))throw new Error("Stats function on string and IPv4 fields must be one of: list, distinct_values, first, last, count, or distinct_count; found "+c);if("number"===d.type&&!i.contains(["sum","count","average","min","max","stdev","list","values"],c))throw new Error("Stats function on number field must be must be one of: sum, count, average, max, min, stdev, list, or distinct_values; found "+c);if("timestamp"===d.type&&!i.contains(["duration","earliest","latest","list","values"],c))throw new Error("Stats function on timestamp field must be one of: duration, earliest, latest, list, or distinct values; found "+c);if(i.contains(["objectCount","childCount"],d.type)&&"count"!==c)throw new Error("Stats function on childcount and objectcount fields must be count; found "+c);if("boolean"===d.type)throw new Error("Cannot use boolean valued fields as cell values.");return this.cells.push({fieldName:a,owner:d.lineage.join("."),type:d.type,label:b,sparkline:!1,value:c}),this},toJsonObject:function(){return{dataModel:this.dataModelObject.dataModel.name,baseClass:this.dataModelObject.name,rows:this.rows,columns:this.columns,cells:this.cells,filters:this.filters}},pivot:function(a){var b=this.dataModelObject.dataModel.service,c={pivot_json:JSON.stringify(this.toJsonObject())};return i.isUndefined(this.accelerationNamespace)||(c.namespace=this.accelerationNamespace),b.get(g.pivot+"/"+encodeURIComponent(this.dataModelObject.dataModel.name),c,function(c,d){if(c){a(new Error(c.data.messages[0].text),d);return}d.data.entry&&d.data.entry[0]?a(null,new j.Pivot(b,d.data.entry[0].content)):a(new Error("Didn't get a Pivot report back from Splunk"),d)})},run:function(a,b){b||(b=a,a={}),a=a||{},this.pivot(function(c,d){c?b(c,null,null):d.run(a,f.augment(b,d))})}}),j.DataModelObject=h.extend({init:function(a,b){a=a||{},a.owner=a.owner||"",this.dataModel=b,this.name=a.objectName,this.displayName=a.displayName,this.parentName=a.parentName,this.lineage=a.lineage.split("."),a.hasOwnProperty("groupByFields")&&(this.groupByFields=a.groupByFields),a.hasOwnProperty("objectsToGroup")&&(this.objectsToGroup=a.objectsToGroup),a.hasOwnProperty("transactionMaxTimeSpan")&&(this.maxSpan=a.transactionMaxTimeSpan),a.hasOwnProperty("transactionMaxPause")&&(this.maxPause=a.transactionMaxPause),a.hasOwnProperty("baseSearch")&&(this.baseSearch=a.baseSearch),this.fields={};for(var c=0;c<a.fields.length;c++)this.fields[a.fields[c].fieldName]=new j.DataModelField(a.fields[c]);this.constraints=[];for(var d=0;d<a.constraints.length;d++)this.constraints.push(new j.DataModelConstraint(a.constraints[d]));this.calculations=[];for(var e=0;e<a.calculations.length;e++)this.calculations[a.calculations[e].calculationID]=new j.DataModelCalculation(a.calculations[e])},isBaseSearch:function(){return!i.isUndefined(this.baseSearch)},isBaseTransaction:function(){return!i.isUndefined(this.maxSpan)},fieldNames:function(){return Object.keys(this.fields)},fieldByName:function(a){return this.calculatedFields()[a]||this.fields[a]||null},allFields:function(){var a=[];for(var b in this.fields)this.fields.hasOwnProperty(b)&&(a[b]=this.fields[b]);var c=this.calculatedFields();for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d]);return a},allFieldNames:function(){return Object.keys(this.allFields())},calculatedFields:function(){var a={},b=this.calculationIDs(),c=this.calculations;for(var d=0;d<b.length;d++){var e=c[b[d]];for(var f=0;f<e.outputFieldNames().length;f++)a[e.outputFieldNames()[f]]=e.outputFields[e.outputFieldNames()[f]]}return a},calculatedFieldNames:function(){return Object.keys(this.calculatedFields())},hasField:function(a){return i.contains(this.allFieldNames(),a)},calculationIDs:function(){return Object.keys(this.calculations)},createLocalAccelerationJob:function(a,b){!b&&i.isFunction(a)&&(b=a,a=undefined);var c='| datamodel "'+this.dataModel.name+'" '+this.name+" search | tscollect",d=a?{earliest_time:a}:{};this.dataModel.service.search(c,d,b)},startSearch:function(a,b,c){var d="| datamodel "+this.dataModel.name+" "+this.name+" search";b=b?" "+b:"",this.dataModel.service.search(d+b,a,c)},parent:function(){return this.dataModel.objectByName(this.parentName)},createPivotSpecification:function(){return new j.PivotSpecification(this)}}),j.DataModel=k.Entity.extend({path:function(){return g.dataModels+"/"+encodeURIComponent(this.name)},init:function(a,b,c,d){d||(d=c,c={}),this.name=b,this._super(a,this.path(),c),this.acceleration=JSON.parse(d.content.acceleration)||{},this.acceleration.hasOwnProperty("enabled")&&(this.acceleration.enabled=!!this.acceleration.enabled);if(!d.hasOwnProperty("concise")||i.isUndefined(d.concise))this.concise="0";var e=JSON.parse(d.content.description);this.objectNames=e.objectNameList,this.displayName=e.displayName,this.description=e.description;var f=e.objects;this.objects=[];for(var g=0;g<f.length;g++)this.objects.push(new j.DataModelObject(f[g],this));this.remove=i.bind(this,this.remove),this.update=i.bind(this,this.update)},isAccelerated:function(){return!!this.acceleration.enabled},objectByName:function(a){for(var b=0;b<this.objects.length;b++)if(this.objects[b].name===a)return this.objects[b];return null},hasObject:function(a){return i.contains(this.objectNames,a)},update:function(a,b){i.isUndefined(b)&&(b=a,a={}),b=b||function(){};if(!a){b(new Error("Must specify a props argument to update a data model."));return}if(a.hasOwnProperty("name")){b(new Error("Cannot set 'name' field in 'update'"),this);return}var c={acceleration:JSON.stringify({enabled:a.accceleration&&a.acceleration.enabled||this.acceleration.enabled,earliest_time:a.accceleration&&a.acceleration.earliestTime||this.acceleration.earliestTime,cron_schedule:a.accceleration&&a.acceleration.cronSchedule||this.acceleration.cronSchedule})},d=this;return this.post("",c,function(a,c){if(a)b(a,d);else{var e=i.namespaceFromProperties(c.data.entry[0]);b(null,new j.DataModel(d.service,c.data.entry[0].name,e,c.data.entry[0]))}})}}),j.DataModels=k.Collection.extend({path:function(){return g.dataModels},init:function(a,b){b=b||{},this._super(a,this.path(),b),this.create=i.bind(this,this.create)},create:function(a,b,c){i.isFunction(b)&&!c&&(c=b,b={}),b=b||{},c=c||function(){},a=a.replace(/ /g,"_");var d=this;return this.post("",{name:a,description:JSON.stringify(b)},function(a,b){if(a)c(a);else{var e=new j.DataModel(d.service,b.data.entry[0].name,d.namespace,b.data.entry[0]);c(null,e)}})},instantiateEntity:function(a){var b=i.namespaceFromProperties(a);return new j.DataModel(this.service,a.name,b,a)}}),j.PaginatedEndpointIterator=h.extend({init:function(a,b){b=b||{},this._endpoint=a,this._pagesize=b.pagesize||0,this._offset=0},next:function(a){a=a||function(){};var b=this,c={count:this._pagesize,offset:this._offset};return this._endpoint(c,function(c,d){if(c)a(c);else{var e=d.rows?d.rows.length:0;b._offset+=e,a(null,d,e>0)}})}})})()}),require.define("/lib/async.js",function(a,b,c,d,e){(function(){"use strict";var b=a("./utils"),d=c||this;d.whilst=function(a,b,c){a=a||function(){return!1},b=b||function(a){a()},c=c||function(){};var e=function(e){e?c(e):d.whilst(a,b,c)};a()?b(e):c(null)},d.parallel=function(a,c){if(arguments.length>1&&b.isFunction(arguments[0])){var d=b.toArray(arguments);a=d.slice(0,d.length-1),c=d[d.length-1]}a=a||[],c=c||function(){},a.length===0&&c();var e=a.length,f=[],g=function(a){return function(d){if(d)c&&c(d),c=null;else{var g=b.toArray(arguments);g.shift(),g.length===1&&(g=g[0]),f[a]=g,--e===0&&(f.unshift(null),c&&c.apply(null,f))}}};for(var h=0;h<a.length;h++){var i=a[h];i(g(h))}},d.series=function(a,c){if(arguments.length>1&&b.isFunction(arguments[0])){var d=b.toArray(arguments);a=d.slice(0,d.length-1),c=d[d.length-1]}a=a||[],c=c||function(){};var e=function(a,c,d,f){if(!a){d.unshift(null),f.apply(null,d);return}a(function(a){if(a)f&&f(a),f=null;else{var g=b.toArray(arguments);g.shift(),g.length===1&&(g=g[0]),d.push(g),e(c[0],c.slice(1),d,f)}})};e(a[0],a.slice(1),[],c)},d.parallelMap=function(a,c,e){a=a||[],e=e||function(){};var f=[],g=function(a,b){return function(d){c(a,b,d)}};for(var h=0;h<a.length;h++)f.push(g(a[h],h));d.parallel(f,function(a){if(a)e&&e(a),e=null;else{var c=b.toArray(arguments);c.shift(),e(null,c)}})},d.seriesMap=function(a,c,e){a=a||[],e=e||function(){};var f=[],g=function(a,b){return function(d){c(a,b,d)}};for(var h=0;h<a.length;h++)f.push(g(a[h],h));d.series(f,function(a){if(a)e&&e(a);else{var c=b.toArray(arguments);c.shift(),e(null,c)}})},d.parallelEach=function(a,b,c){a=a||[],c=c||function(){},d.parallelMap(a,b,function(a,b){c(a)})},d.seriesEach=function(a,b,c){a=a||[],c=c||function(){},d.seriesMap(a,b,function(a,b){c(a)})},d.chain=function(a,c){if(arguments.length>1&&b.isFunction(arguments[0])){var d=b.toArray(arguments);a=d.slice(0,d.length-1),c=d[d.length-1]}a=a||[],c=c||function(){};if(!a.length)c();else{var e=function(a,d,f){var g=function(a){if(a)c(a),c=function(){};else{var f=b.toArray(arguments);f.shift(),e(d[0],d.slice(1),f)}},h=f;d.length?h.push(g):h.push(c),a.apply(null,h)};e(a[0],a.slice(1),[])}},d.sleep=function(a,b){setTimeout(function(){b()},a)},d.augment=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){var c=Array.prototype.slice.call(arguments);for(var d=0;d<b.length;d++)c.push(b[d]);a.apply(null,c)}}})()}),require.define("/lib/modularinputs/index.js",function(a,b,c,d,e){var f=a("../async"),g={utils:a("./utils"),ValidationDefinition:a("./validationdefinition"),InputDefinition:a("./inputdefinition"),Event:a("./event"),EventWriter:a("./eventwriter"),Argument:a("./argument"),Scheme:a("./scheme"),ModularInput:a("./modularinput"),Logger:a("./logger")};g.execute=function(b,c){if(a.main===c){var d=process.argv.slice(1);b.setup=b.setup||g.ModularInput.prototype.setup,b.start=b.start||g.ModularInput.prototype.start,b.end=b.end||g.ModularInput.prototype.end,b.teardown=b.teardown||g.ModularInput.prototype.teardown,b._inputDefinition=b._inputDefinition||null,b._service=b._service||null;var e=new this.EventWriter;[process.stdout,process.stderr].forEach(function(a){a&&a.isTTY&&a._handle&&a._handle.setBlocking&&a._handle.setBlocking(!0)});var h;f.chain([function(a){b.setup(a)},function(a){g.ModularInput.runScript(b,d,e,process.stdin,a)},function(a,c){h=a,b.teardown(c)}],function(a){a&&g.Logger.error("",a,e._err),process.exit(h||a?1:0)})}},b.exports=g}),require.define("/lib/modularinputs/utils.js",function(a,b,c,d,e){var f=a("../utils");f.parseParameters=function(a){switch(a.tag){case"param":return a.text;case"param_list":var b=[],c=a.getchildren();for(var d=0;d<c.length;d++){var e=c[d];b.push(e.text)}return b;default:throw new Error("Invalid configuration scheme, <"+a.tag+"> tag unexpected.")}},f.parseXMLData=function(a,b){var c={},d=a.getchildren();for(var e=0;e<d.length;e++){var g=d[e];if(g.tag===b){if(b==="stanza"){c[g.get("name")]={};var h=g.getchildren();for(var i=0;i<h.length;i++){var j=h[i];c[g.get("name")][j.get("name")]=f.parseParameters(j)}}}else"item"===a.tag&&(c[g.get("name")]=f.parseParameters(g))}return c},b.exports=f}),require.define("/lib/modularinputs/validationdefinition.js",function(a,b,c,d,e){(function(){function e(){this.metadata={},this.parameters={}}var c=a("elementtree"),d=a("./utils");e.parse=function(a){var b=new e,f=c.parse(a).getroot().getchildren();for(var g=0;g<f.length;g++){var h=f[g];h.tag==="item"?(b.metadata.name=h.get("name"),b.parameters=d.parseXMLData(h,"")):b.metadata[h.tag]=h.text}return b},b.exports=e})()}),require.define("/node_modules/elementtree/package.json",function(a,b,c,d,e){b.exports={main:"lib/elementtree.js"}}),require.define("/node_modules/elementtree/lib/elementtree.js",function(a,b,c,d,e){function m(a,b){this._id=l++,this.tag=a,this.attrib={},this.text=null,this.tail=null,this._children=[],b&&(this.attrib=g.merge(this.attrib,b))}function n(a,b,c){var d=a.makeelement(b,c);return a.append(d),d}function o(a){var b=new m(o);return a&&(b.text=a),b}function p(a){var b=new m(p);return a&&(b.text=a),b}function q(a,b){var c=new m(q);return c.text=a,b&&(c.text=c.text+" "+b),c}function r(a,b){b&&(a=f("{%s}%s",a,b)),this.text=a}function s(a){this._root=a}function u(a,b){if(/ns\d+$/.test(a))throw new Error("Prefix format reserved for internal use");t.hasOwnProperty(b)&&t[b]===a&&delete t[b],t[b]=a}function v(a,b,c,d){return a&&(a=a.toString(),a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),d||(a=a.replace(/\n/g,"&#xA;"),a=a.replace(/\r/g,"&#xD;")),c&&(a=a.replace(/"/g,"&quot;"))),a}function w(a,b){return v(a,b,!0)}function x(a,b){return v(a,b,!1)}function y(a,b){return v(a,b,!1,!0)}function z(a,b,c){function g(a){return a}function h(a){if(a[0]==="{"){var b=a.substring(1).split("}",2),g=b[0],h=b[1],i=e[g];i===undefined&&(i=t[g],i===undefined&&(i="ns"+Object.keys(e).length),i!=="xml"&&(e[g]=i)),i?d[a]=f("%s:%s",i,h):d[a]=h}else{if(c)throw new Error("cannot use non-qualified names with default_namespace option");d[a]=a}}var d={},e={};return c&&(e[c]=""),a.iter(null,function(a){var b,c=a.tag,e=a.text,f=a.items();if(c instanceof r&&d[c.text]===undefined)h(c.text);else if(typeof c=="string")h(c);else if(c!==null&&c!==o&&c!==p&&c!==q)throw new Error("Invalid tag type for serialization: "+c);e instanceof r&&d[e.text]===undefined&&h(e.text),f.forEach(function(a){var b=a[0],c=a[1];b instanceof r&&(b=b.text),d[b]===undefined&&h(b),c instanceof r&&d[c.text]===undefined&&h(c.text)})}),[d,e]}function A(a,b,c,d,e,h,i){var j=b.tag,k=b.text,l,m,n=h||h===0;a(Array(h+1).join(i));if(j===o)a(f("<!--%s-->",x(k,c)));else if(j===q)a(f("<?%s?>",x(k,c)));else if(j===p)k=k||"",a(f("<![CDATA[%s]]>",k));else{j=d[j];if(j===undefined)k&&a(y(k,c)),b.iter(function(b){A(a,b,c,d,null,n?h+1:!1,i)});else{a("<"+j),l=b.items();if(l||e)l.sort(),l.forEach(function(b){var e=b[0],g=b[1];e instanceof r&&(e=e.text),g instanceof r?g=d[g.text]:g=w(g,c),a(f(' %s="%s"',d[e],g))}),e&&(l=g.items(e),l.sort(function(a,b){return a[1]<b[1]}),l.forEach(function(b){var d=b[1],e=b[0];d&&(d=":"+d),a(f(' xmlns%s="%s"',d,w(e,c)))}));k||b.len()?(k&&k.toString().match(/^\s*$/)&&(k=null),a(">"),!k&&n&&a("\n"),k&&a(y(k,c)),b._children.forEach(function(b){A(a,b,c,d,null,n?h+1:!1,i)}),!k&&h&&a(Array(h+1).join(i)),a("</"+j+">")):a(" />")}}n&&a("\n")}function B(a,b){var c=new s;return c.parse(a,b),c}function C(a,b){return(new s(a)).write(b)}var f=a("./sprintf").sprintf,g=a("./utils"),h=a("./elementpath"),i=a("./treebuilder").TreeBuilder,j=a("./parser").get_parser,k=a("./constants"),l=0;m.prototype.toString=function(){return f("<Element %s at %s>",this.tag,this._id)},m.prototype.makeelement=function(a,b){return new m(a,b)},m.prototype.len=function(){return this._children.length},m.prototype.getItem=function(a){return this._children[a]},m.prototype.setItem=function(a,b){this._children[a]=b},m.prototype.delItem=function(a){this._children.splice(a,1)},m.prototype.getSlice=function(a,b){return this._children.slice(a,b)},m.prototype.setSlice=function(a,b,c){var d,e=0;for(d=a;d<b;d++,e++)this._children[d]=c[e]},m.prototype.delSlice=function(a,b){this._children.splice(a,b-a)},m.prototype.append=function(a){this._children.push(a)},m.prototype.extend=function(a){this._children.concat(a)},m.prototype.insert=function(a,b){this._children[a]=b},m.prototype.remove=function(a){this._children=this._children.filter(function(b){return b._id===a._id?!1:!0})},m.prototype.getchildren=function(){return this._children},m.prototype.find=function(a){return h.find(this,a)},m.prototype.findtext=function(a,b){return h.findtext(this,a,b)},m.prototype.findall=function(a,b){return h.findall(this,a,b)},m.prototype.clear=function(){this.attrib={},this._children=[],this.text=null,this.tail=null},m.prototype.get=function(a,b){return this.attrib[a]!==undefined?this.attrib[a]:b},m.prototype.set=function(a,b){this.attrib[a]=b},m.prototype.keys=function(){return Object.keys(this.attrib)},m.prototype.items=function(){return g.items(this.attrib)},m.prototype.iter=function(a,b){var c=this,d,e;a==="*"&&(a=null),(a===null||this.tag===a)&&b(c);for(d=0;d<this._children.length;d++)e=this._children[d],e.iter(a,function(a){b(a)})},m.prototype.itertext=function(a){this.iter(null,function(b){b.text&&a(b.text),b.tail&&a(b.tail)})},r.prototype.toString=function(){return this.text},s.prototype.getroot=function(){return this._root},s.prototype._setroot=function(a){this._root=a},s.prototype.parse=function(a,b){return b||(b=j(k.DEFAULT_PARSER),b=new b.XMLParser(new i)),b.feed(a),this._root=b.close(),this._root},s.prototype.iter=function(a,b){this._root.iter(a,b)},s.prototype.find=function(a){return this._root.find(a)},s.prototype.findtext=function(a,b){return this._root.findtext(a,b)},s.prototype.findall=function(a){return this._root.findall(a)},s.prototype.write=function(a){var b=[];a=g.merge({encoding:"utf-8",xml_declaration:null,default_namespace:null,method:"xml"},a),a.xml_declaration!==!1&&b.push("<?xml version='1.0' encoding='"+a.encoding+"'?>\n");if(a.method==="text")_serialize_text(b,self._root,encoding);else{var c,d,e,f,h=z(this._root,a.encoding,a.default_namespace);c=h[0],d=h[1],a.hasOwnProperty("indent")?(e=0,f=(new Array(a.indent+1)).join(" ")):e=!1;if(a.method==="xml")A(function(a){b.push(a)},this._root,a.encoding,c,d,e,f);else throw new Error("unknown serialization method "+a.method)}return b.join("")};var t={"http://www.w3.org/XML/1998/namespace":"xml","http://www.w3.org/1999/xhtml":"html","http://www.w3.org/1999/02/22-rdf-syntax-ns#":"rdf","http://schemas.xmlsoap.org/wsdl/":"wsdl","http://www.w3.org/2001/XMLSchema":"xs","http://www.w3.org/2001/XMLSchema-instance":"xsi","http://purl.org/dc/elements/1.1/":"dc"};c.PI=q,c.Comment=o,c.CData=p,c.ProcessingInstruction=q,c.SubElement=n,c.QName=r,c.ElementTree=s,c.ElementPath=h,c.Element=function(a,b){return new m(a,b)},c.XML=function(a){var b=new s;return b.parse(a)},c.parse=B,c.register_namespace=u,c.tostring=C}),require.define("/node_modules/elementtree/lib/sprintf.js",function(a,b,c,d,e){function h(a){var b,c,d=a,e=0,h=1,i="return '";for(b=0;b<a.length;b++)if(a[b]==="%"){c=a[b+1];switch(c){case"s":i+=a.slice(e,b)+"' + arguments["+h+"] + '",e=b+2,h++;break;case"j":i+=a.slice(e,b)+"' + JSON.stringify(arguments["+h+"]) + '",e=b+2,h++;break;case"%":i+=a.slice(e,b+1),e=b+2,b++}}else g[a[b]]&&(i+=a.slice(e,b)+g[a[b]],e=b+1);i+=a.slice(e)+"';",f[d]=new Function(i)}var f={},g={"'":"\\'","\n":"\\n"};c.sprintf=function(a,b){return f[a]||h(a),f[a].apply(null,arguments)}}),require.define("/node_modules/elementtree/lib/utils.js",function(a,b,c,d,e){function f(a,b){function e(a){return!b||b.length===0?!1:b.indexOf(a)}b=b||null;var c,d=[];for(c in a)a.hasOwnProperty(c)&&!e(b)&&d.push([c,a[c]]);return d}function g(a,b){var c,d=[];while(c=a.exec(b))d.push(c);return d}function h(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c}c.items=f,c.findall=g,c.merge=h}),require.define("/node_modules/elementtree/lib/elementpath.js",function(a,b,c,d,e){function l(a,b){function d(a,b){var d,e,f,g=[];for(d=0,e=b.length;d<e;d++)f=b[d],f._children.forEach(function(a){a.tag===c&&g.push(a)});return g}var c=b[0];return d}function m(a,b){function c(a,b){var c,d,e,f=[];for(c=0,d=b.length;c<d;c++)e=b[c],e._children.forEach(function(a){f.push(a)});return f}return c}function n(a,b){function c(a,b){var c,d,e,f=[];for(c=0,d=b.length;c<d;c++)e=b[c],f.push(e);return f}return c}function o(a,b){function d(a,b){var d,e,f,g=[];for(d=0,e=b.length;d<e;d++)f=b[d],f.iter(c,function(a){a!==f&&g.push(a)});return g}var c;b=a();if(b[1]==="*")c="*";else if(!b[1])c=b[0]||"";else throw new h(b);return d}function p(a,b){function c(a,b){var c,d,e,f=[],g=a.parent_map;g||(a.parent_map=g={},a.root.iter(null,function(a){a._children.forEach(function(b){g[b]=a})}));for(c=0,d=b.length;c<d;c++)e=b[c],g.hasOwnProperty(e)&&f.push(g[e]);return f}return c}function q(a,b){var c,d,e,f;b=a();if(b[1]==="@"){b=a();if(b[1])throw new h(b,"Invalid attribute predicate");d=b[0],b=a();if(b[1]==="]")f=function(a,b){var c,e,f,g=[];for(c=0,e=b.length;c<e;c++)f=b[c],f.get(d)&&g.push(f);return g};else if(b[1]==="="){e=a()[1];if(e[0]==='"'||e[e.length-1]==="'")e=e.slice(1,e.length-1);else throw new h(b,"Ivalid comparison target");b=a(),f=function(a,b){var c,f,g,h=[];for(c=0,f=b.length;c<f;c++)g=b[c],g.get(d)===e&&h.push(g);return h}}if(b[1]!=="]")throw new h(b,"Invalid attribute predicate")}else{if(!!b[1])throw new h(null,"Invalid predicate");c=b[0]||"",b=a();if(b[1]!=="]")throw new h(b,"Invalid node predicate");f=function(a,b){var d,e,f,g=[];for(d=0,e=b.length;d<e;d++)f=b[d],f.find(c)&&g.push(f);return g}}return f}function s(a){this.parent_map=null,this.root=a}function t(a,b){var c,d,e,g,j,l,m,n;if(i.hasOwnProperty(b))c=i[b];else{Object.keys(i).length>100&&(i={});if(b.charAt(0)==="/")throw new h(null,"Cannot use absolute path on element");d=k(b),c=[];function o(){return d.shift()}j=o();for(;;){var p=j[1]||"";l=r[p](o,j);if(!l)throw new h(null,f("Invalid path: %s",b));c.push(l),j=o();if(!j)break;j[1]==="/"&&(j=o());if(!j)break}i[b]=c}d=[a],n=new s(a);for(e=0,g=c.length;e<g;e++)m=c[e],d=m(n,d);return d||[]}function u(a,b){var c=t(a,b);return c&&c.length>0?c[0]:null}function v(a,b,c){var d=t(a,b);return d&&d.length>0?d[0].text:c}var f=a("./sprintf").sprintf,g=a("./utils"),h=a("./errors").SyntaxError,i={},j=new RegExp("('[^']*'|\"[^\"]*\"|::|//?|\\.\\.|\\(\\)|[/.*:\\[\\]\\(\\)@=])|((?:\\{[^}]+\\})?[^/\\[\\]\\(\\)@=\\s]+)|\\s+","g"),k=g.findall.bind(null,j),r={"":l,"*":m,".":n,"..":p,"//":o,"[":q};c.find=u,c.findall=t,c.findtext=v}),require.define("/node_modules/elementtree/lib/errors.js",function(a,b,c,d,e){function h(a,b){b=b||g("Syntax Error at token %s",a.toString()),this.token=a,this.message=b,Error.call(this,b)}var f=a("util"),g=a("./sprintf").sprintf;f.inherits(h,Error),c.SyntaxError=h}),require.define("util",function(a,b,c,d,e){function g(a){return a instanceof Array||Array.isArray(a)||a&&a!==Object.prototype&&g(a.__proto__)}function h(a){return a instanceof RegExp||typeof a=="object"&&Object.prototype.toString.call(a)==="[object RegExp]"}function i(a){if(a instanceof Date)return!0;if(typeof a!="object")return!1;var b=Date.prototype&&n(Date.prototype),c=a.__proto__&&n(a.__proto__);return JSON.stringify(c)===JSON.stringify(b)}function j(a){return a<10?"0"+a.toString(10):a.toString(10)}function l(){var a=new Date,b=[j(a.getHours()),j(a.getMinutes()),j(a.getSeconds())].join(":");return[a.getDate(),k[a.getMonth()],b].join(" ")}var f=a("events");c.print=function(){},c.puts=function(){},c.debug=function(){},c.inspect=function(a,b,d,e){function k(a,d){if(a&&typeof a.inspect=="function"&&a!==c&&(!a.constructor||a.constructor.prototype!==a))return a.inspect(d);switch(typeof a){case"undefined":return j("undefined","undefined");case"string":var e="'"+JSON.stringify(a).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return j(e,"string");case"number":return j(""+a,"number");case"boolean":return j(""+a,"boolean")}if(a===null)return j("null","null");var l=m(a),o=b?n(a):l;if(typeof a=="function"&&o.length===0){if(h(a))return j(""+a,"regexp");var p=a.name?": "+a.name:"";return j("[Function"+p+"]","special")}if(i(a)&&o.length===0)return j(a.toUTCString(),"date");var q,r,s;g(a)?(r="Array",s=["[","]"]):(r="Object",s=["{","}"]);if(typeof a=="function"){var t=a.name?": "+a.name:"";q=h(a)?" "+a:" [Function"+t+"]"}else q="";i(a)&&(q=" "+a.toUTCString());if(o.length===0)return s[0]+q+s[1];if(d<0)return h(a)?j(""+a,"regexp"):j("[Object]","special");f.push(a);var u=o.map(function(b){var c,e;a.__lookupGetter__&&(a.__lookupGetter__(b)?a.__lookupSetter__(b)?e=j("[Getter/Setter]","special"):e=j("[Getter]","special"):a.__lookupSetter__(b)&&(e=j("[Setter]","special"))),l.indexOf(b)<0&&(c="["+b+"]"),e||(f.indexOf(a[b])<0?(d===null?e=k(a[b]):e=k(a[b],d-1),e.indexOf("\n")>-1&&(g(a)?e=e.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):e="\n"+e.split("\n").map(function(a){return"   "+a}).join("\n"))):e=j("[Circular]","special"));if(typeof c=="undefined"){if(r==="Array"&&b.match(/^\d+$/))return e;c=JSON.stringify(""+b),c.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(c=c.substr(1,c.length-2),c=j(c,"name")):(c=c.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),c=j(c,"string"))}return c+": "+e});f.pop();var v=0,w=u.reduce(function(a,b){return v++,b.indexOf("\n")>=0&&v++,a+b.length+1},0);return w>50?u=s[0]+(q===""?"":q+"\n ")+" "+u.join(",\n  ")+" "+s[1]:u=s[0]+q+" "+u.join(", ")+" "+s[1],u}var f=[],j=function(a,b){var c={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},d={special:"cyan",number:"blue","boolean":"yellow","undefined":"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[b];return d?"["+c[d][0]+"m"+a+"["+c[d][1]+"m":a};return e||(j=function(a,b){return a}),k(a,typeof d=="undefined"?2:d)};var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(a){},c.pump=null;var m=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},n=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.hasOwnProperty.call(a,c)&&b.push(c);return b},o=Object.create||function(a,b){var c;if(a===null)c={__proto__:null};else{if(typeof a!="object")throw new TypeError("typeof prototype["+typeof a+"] != 'object'");var d=function(){};d.prototype=a,c=new d,c.__proto__=a}return typeof b!="undefined"&&Object.defineProperties&&Object.defineProperties(c,b),c};c.inherits=function(a,b){a.super_=b,a.prototype=o(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}}),require.define("events",function(a,b,c,d,e){process.EventEmitter||(process.EventEmitter=function(){});var f=c.EventEmitter=process.EventEmitter,g=typeof Array.isArray=="function"?Array.isArray:function(a){return Object.toString.call(a)==="[object Array]"},h=10;f.prototype.setMaxListeners=function(a){this._events||(this._events={}),this._events.maxListeners=a},f.prototype.emit=function(a){if(a==="error")if(!this._events||!this._events.error||g(this._events.error)&&!this._events.error.length)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var b=this._events[a];if(!b)return!1;if(typeof b=="function"){switch(arguments.length){case 1:b.call(this);break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:var c=Array.prototype.slice.call(arguments,1);b.apply(this,c)}return!0}if(g(b)){var c=Array.prototype.slice.call(arguments,1),d=b.slice();for(var e=0,f=d.length;e<f;e++)d[e].apply(this,c);return!0}return!1},f.prototype.addListener=function(a,b){if("function"!=typeof b)throw new Error("addListener only takes instances of Function");this._events||(this._events={}),this.emit("newListener",a,b);if(!this._events[a])this._events[a]=b;else if(g(this._events[a])){if(!this._events[a].warned){var c;this._events.maxListeners!==undefined?c=this._events.maxListeners:c=h,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}this._events[a].push(b)}else this._events[a]=[this._events[a],b];return this},f.prototype.on=f.prototype.addListener,f.prototype.once=function(a,b){var c=this;return c.on(a,function d(){c.removeListener(a,d),b.apply(this,arguments)}),this},f.prototype.removeListener=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var c=this._events[a];if(g(c)){var d=c.indexOf(b);if(d<0)return this;c.splice(d,1),c.length==0&&delete this._events[a]}else this._events[a]===b&&delete this._events[a];return this},f.prototype.removeAllListeners=function(a){return a&&this._events&&this._events[a]&&(this._events[a]=null),this},f.prototype.listeners=function(a){return this._events||(this._events={}),this._events[a]||(this._events[a]=[]),g(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]}}),require.define("/node_modules/elementtree/lib/treebuilder.js",function(a,b,c,d,e){function f(b){this._data=[],this._elem=[],this._last=null,this._tail=null,b||(b=a("./elementtree").Element),this._factory=b}f.prototype.close=function(){return this._last},f.prototype._flush=function(){if(this._data){if(this._last!==null){var a=this._data.join("");this._tail?this._last.tail=a:this._last.text=a}this._data=[]}},f.prototype.data=function(a){this._data.push(a)},f.prototype.start=function(a,b){this._flush();var c=this._factory(a,b);this._last=c,this._elem.length&&this._elem[this._elem.length-1].append(c),this._elem.push(c),this._tail=null},f.prototype.end=function(a){this._flush(),this._last=this._elem.pop();if(this._last.tag!==a)throw new Error("end tag mismatch");return this._tail=1,this._last},c.TreeBuilder=f}),require.define("/node_modules/elementtree/lib/parser.js",function(a,b,c,d,e){function h(a){if(a==="sax")return g.sax;throw new Error("Invalid parser: "+a)}var f=a("util"),g=a("./parsers/index");c.get_parser=h}),require.define("/node_modules/elementtree/lib/parsers/index.js",function(a,b,c,d,e){c.sax=a("./sax")}),require.define("/node_modules/elementtree/lib/parsers/sax.js",function(a,b,c,d,e){function i(a){this.parser=g.parser(!0),this.target=a?a:new h,this.parser.onopentag=this._handleOpenTag.bind(this),this.parser.ontext=this._handleText.bind(this),this.parser.oncdata=this._handleCdata.bind(this),this.parser.ondoctype=this._handleDoctype.bind(this),this.parser.oncomment=this._handleComment.bind(this),this.parser.onclosetag=this._handleCloseTag.bind(this),this.parser.onerror=this._handleError.bind(this)}var f=a("util"),g=a("sax"),h=a("./../treebuilder").TreeBuilder;i.prototype._handleOpenTag=function(a){this.target.start(a.name,a.attributes)},i.prototype._handleText=function(a){this.target.data(a)},i.prototype._handleCdata=function(a){this.target.data(a)},i.prototype._handleDoctype=function(a){},i.prototype._handleComment=function(a){},i.prototype._handleCloseTag=function(a){this.target.end(a)},i.prototype._handleError=function(a){throw a},i.prototype.feed=function(a){this.parser.write(a)},i.prototype.close=function(){return this.parser.close(),this.target.close()},c.XMLParser=i}),require.define("/node_modules/elementtree/node_modules/sax/package.json",function(a,b,c,d,e){b.exports={main:"lib/sax.js"}}),require.define("/node_modules/elementtree/node_modules/sax/lib/sax.js",function(a,b,c,d,e){(function(b){function d(a,c){if(!(this instanceof d))return new d(a,c);var e=this;f(e),e.q=e.c="",e.bufferCheckPosition=b.MAX_BUFFER_LENGTH,e.opt=c||{},e.tagCase=e.opt.lowercasetags?"toLowerCase":"toUpperCase",e.tags=[],e.closed=e.closedRoot=e.sawRoot=!1,e.tag=e.error=null,e.strict=!!a,e.noscript=!!a||!!e.opt.noscript,e.state=B.BEGIN,e.ENTITIES=Object.create(b.ENTITIES),e.attribList=[],e.opt.xmlns&&(e.ns=Object.create(x)),e.position=e.line=e.column=0,C(e,"onready")}function e(a){var d=Math.max(b.MAX_BUFFER_LENGTH,10),e=0;for(var f=0,g=c.length;f<g;f++){var h=a[c[f]].length;if(h>d)switch(c[f]){case"textNode":E(a);break;case"cdata":D(a,"oncdata",a.cdata),a.cdata="";break;case"script":D(a,"onscript",a.script),a.script="";break;default:G(a,"Max buffer length exceeded: "+c[f])}e=Math.max(e,h)}a.bufferCheckPosition=b.MAX_BUFFER_LENGTH-e+a.position}function f(a){for(var b=0,d=c.length;b<d;b++)a[c[b]]=""}function j(a,b){return new k(a,b)}function k(a,b){if(!(this instanceof k))return new k(a,b);g.apply(c),this._parser=new d(a,b),this.writable=!0,this.readable=!0;var c=this;this._parser.onend=function(){c.emit("end")},this._parser.onerror=function(a){c.emit("error",a),c._parser.error=null},i.forEach(function(a){Object.defineProperty(c,"on"+a,{get:function(){return c._parser["on"+a]},set:function(b){if(!b)return c.removeAllListeners(a),c._parser["on"+a]=b;c.on(a,b)},enumerable:!0,configurable:!1})})}function y(a){return a.split("").reduce(function(a,b){return a[b]=!0,a},{})}function z(a,b){return a[b]}function A(a,b){return!a[b]}function C(a,b,c){a[b]&&a[b](c)}function D(a,b,c){a.textNode&&E(a),C(a,b,c)}function E(a){a.textNode=F(a.opt,a.textNode),a.textNode&&C(a,"ontext",a.textNode),a.textNode=""}function F(a,b){return a.trim&&(b=b.trim()),a.normalize&&(b=b.replace(/\s+/g," ")),b}function G(a,b){return E(a),b+="\nLine: "+a.line+"\nColumn: "+a.column+"\nChar: "+a.c,b=new Error(b),a.error=b,C(a,"onerror",b),a}function H(a){return a.state!==B.TEXT&&G(a,"Unexpected end"),E(a),a.c="",a.closed=!0,C(a,"onend"),d.call(a,a.strict,a.opt),a}function I(a,b){a.strict&&G(a,b)}function J(a){a.strict||(a.tagName=a.tagName[a.tagCase]());var b=a.tags[a.tags.length-1]||a,c=a.tag={name:a.tagName,attributes:{}};a.opt.xmlns&&(c.ns=b.ns),a.attribList.length=0}function K(a){var b=a.indexOf(":"),c=b<0?["",a]:a.split(":"),d=c[0],e=c[1];return a==="xmlns"&&(d="xmlns",e=""),{prefix:d,local:e}}function L(a){if(a.opt.xmlns){var b=K(a.attribName),c=b.prefix,d=b.local;if(c==="xmlns")if(d==="xml"&&a.attribValue!==v)I(a,"xml: prefix must be bound to "+v+"\n"+"Actual: "+a.attribValue);else if(d==="xmlns"&&a.attribValue!==w)I(a,"xmlns: prefix must be bound to "+w+"\n"+"Actual: "+a.attribValue);else{var e=a.tag,f=a.tags[a.tags.length-1]||a;e.ns===f.ns&&(e.ns=Object.create(f.ns)),e.ns[d]=a.attribValue}a.attribList.push([a.attribName,a.attribValue])}else a.tag.attributes[a.attribName]=a.attribValue,D(a,"onattribute",{name:a.attribName,value:a.attribValue});a.attribName=a.attribValue=""}function M(a,b){if(a.opt.xmlns){var c=a.tag,d=K(a.tagName);c.prefix=d.prefix,c.local=d.local,c.uri=c.ns[d.prefix]||d.prefix,c.prefix&&!c.uri&&I(a,"Unbound namespace prefix: "+JSON.stringify(a.tagName));var e=a.tags[a.tags.length-1]||a;c.ns&&e.ns!==c.ns&&Object.keys(c.ns).forEach(function(b){D(a,"onopennamespace",{prefix:b,uri:c.ns[b]})});for(var f=0,g=a.attribList.length;f<g;f++){var h=a.attribList[f],i=h[0],j=h[1],k=K(i),l=k.prefix,m=k.local,n=c.ns[l]||"",o={name:i,value:j,prefix:l,local:m,uri:n};l&&l!="xmlns"&&!n&&(I(a,"Unbound namespace prefix: "+JSON.stringify(l)),o.uri=l),a.tag.attributes[i]=o,D(a,"onattribute",o)}a.attribList.length=0}a.sawRoot=!0,a.tags.push(a.tag),D(a,"onopentag",a.tag),b||(!a.noscript&&a.tagName.toLowerCase()==="script"?a.state=B.SCRIPT:a.state=B.TEXT,a.tag=null,a.tagName=""),a.attribName=a.attribValue="",a.attribList.length=0}function N(a){if(!a.tagName){I(a,"Weird empty close tag."),a.textNode+="</>",a.state=B.TEXT;return}var b=a.tags.length,c=a.tagName;a.strict||(c=c[a.tagCase]());var d=c;while(b--){var e=a.tags[b];if(e.name!==d)I(a,"Unexpected close tag");else break}if(b<0){I(a,"Unmatched closing tag: "+a.tagName),a.textNode+="</"+a.tagName+">",a.state=B.TEXT;return}a.tagName=c;var f=a.tags.length;while(f-->b){var g=a.tag=a.tags.pop();a.tagName=a.tag.name,D(a,"onclosetag",a.tagName);var h={};for(var i in g.ns)h[i]=g.ns[i];var j=a.tags[a.tags.length-1]||a;a.opt.xmlns&&g.ns!==j.ns&&Object.keys(g.ns).forEach(function(b){var c=g.ns[b];D(a,"onclosenamespace",{prefix:b,uri:c})})}b===0&&(a.closedRoot=!0),a.tagName=a.attribValue=a.attribName="",a.attribList.length=0,a.state=B.TEXT}function O(a){var b=a.entity.toLowerCase(),c,d="";return a.ENTITIES[b]?a.ENTITIES[b]:(b.charAt(0)==="#"&&(b.charAt(1)==="x"?(b=b.slice(2),c=parseInt(b,16),d=c.toString(16)):(b=b.slice(1),c=parseInt(b,10),d=c.toString(10))),b=b.replace(/^0+/,""),d.toLowerCase()!==b?(I(a,"Invalid character entity"),"&"+a.entity+";"):String.fromCharCode(c))}function P(a){var b=this;if(this.error)throw this.error;if(b.closed)return G(b,"Cannot write after close. Assign an onready handler.");if(a===null)return H(b);var c=0,d="";while(b.c=d=a.charAt(c++)){b.position++,d==="\n"?(b.line++,b.column=0):b.column++;switch(b.state){case B.BEGIN:d==="<"?b.state=B.OPEN_WAKA:A(l,d)&&(I(b,"Non-whitespace before first tag."),b.textNode=d,b.state=B.TEXT);continue;case B.TEXT:if(b.sawRoot&&!b.closedRoot){var f=c-1;while(d&&d!=="<"&&d!=="&")d=a.charAt(c++),d&&(b.position++,d==="\n"?(b.line++,b.column=0):b.column++);b.textNode+=a.substring(f,c-1)}d==="<"?b.state=B.OPEN_WAKA:(A(l,d)&&(!b.sawRoot||b.closedRoot)&&I("Text data outside of root node."),d==="&"?b.state=B.TEXT_ENTITY:b.textNode+=d);continue;case B.SCRIPT:d==="<"?b.state=B.SCRIPT_ENDING:b.script+=d;continue;case B.SCRIPT_ENDING:d==="/"?(D(b,"onscript",b.script),b.state=B.CLOSE_TAG,b.script="",b.tagName=""):(b.script+="<"+d,b.state=B.SCRIPT);continue;case B.OPEN_WAKA:d==="!"?(b.state=B.SGML_DECL,b.sgmlDecl=""):z(l,d)||(z(o,d)?(b.startTagPosition=b.position-1,b.state=B.OPEN_TAG,b.tagName=d):d==="/"?(b.startTagPosition=b.position-1,b.state=B.CLOSE_TAG,b.tagName=""):d==="?"?(b.state=B.PROC_INST,b.procInstName=b.procInstBody=""):(I(b,"Unencoded <"),b.textNode+="<"+d,b.state=B.TEXT));continue;case B.SGML_DECL:(b.sgmlDecl+d).toUpperCase()===t?(D(b,"onopencdata"),b.state=B.CDATA,b.sgmlDecl="",b.cdata=""):b.sgmlDecl+d==="--"?(b.state=B.COMMENT,b.comment="",b.sgmlDecl=""):(b.sgmlDecl+d).toUpperCase()===u?(b.state=B.DOCTYPE,(b.doctype||b.sawRoot)&&I(b,"Inappropriately located doctype declaration"),b.doctype="",b.sgmlDecl=""):d===">"?(D(b,"onsgmldeclaration",b.sgmlDecl),b.sgmlDecl="",b.state=B.TEXT):z(q,d)?(b.state=B.SGML_DECL_QUOTED,b.sgmlDecl+=d):b.sgmlDecl+=d;continue;case B.SGML_DECL_QUOTED:d===b.q&&(b.state=B.SGML_DECL,b.q=""),b.sgmlDecl+=d;continue;case B.DOCTYPE:d===">"?(b.state=B.TEXT,D(b,"ondoctype",b.doctype),b.doctype=!0):(b.doctype+=d,d==="["?b.state=B.DOCTYPE_DTD:z(q,d)&&(b.state=B.DOCTYPE_QUOTED,b.q=d));continue;case B.DOCTYPE_QUOTED:b.doctype+=d,d===b.q&&(b.q="",b.state=B.DOCTYPE);continue;case B.DOCTYPE_DTD:b.doctype+=d,d==="]"?b.state=B.DOCTYPE:z(q,d)&&(b.state=B.DOCTYPE_DTD_QUOTED,b.q=d);continue;case B.DOCTYPE_DTD_QUOTED:b.doctype+=d,d===b.q&&(b.state=B.DOCTYPE_DTD,b.q="");continue;case B.COMMENT:d==="-"?b.state=B.COMMENT_ENDING:b.comment+=d;continue;case B.COMMENT_ENDING:d==="-"?(b.state=B.COMMENT_ENDED,b.comment=F(b.opt,b.comment),b.comment&&D(b,"oncomment",b.comment),b.comment=""):(b.comment+="-"+d,b.state=B.COMMENT);continue;case B.COMMENT_ENDED:d!==">"?(I(b,"Malformed comment"),b.comment+="--"+d,b.state=B.COMMENT):b.state=B.TEXT;continue;case B.CDATA:d==="]"?b.state=B.CDATA_ENDING:b.cdata+=d;continue;case B.CDATA_ENDING:d==="]"?b.state=B.CDATA_ENDING_2:(b.cdata+="]"+d,b.state=B.CDATA);continue;case B.CDATA_ENDING_2:d===">"?(b.cdata&&D(b,"oncdata",b.cdata),D(b,"onclosecdata"),b.cdata="",b.state=B.TEXT):d==="]"?b.cdata+="]":(b.cdata+="]]"+d,b.state=B.CDATA);continue;case B.PROC_INST:d==="?"?b.state=B.PROC_INST_ENDING:z(l,d)?b.state=B.PROC_INST_BODY:b.procInstName+=d;continue;case B.PROC_INST_BODY:if(!b.procInstBody&&z(l,d))continue;d==="?"?b.state=B.PROC_INST_ENDING:z(q,d)?(b.state=B.PROC_INST_QUOTED,b.q=d,b.procInstBody+=d):b.procInstBody+=d;continue;case B.PROC_INST_ENDING:d===">"?(D(b,"onprocessinginstruction",{name:b.procInstName,body:b.procInstBody}),b.procInstName=b.procInstBody="",b.state=B.TEXT):(b.procInstBody+="?"+d,b.state=B.PROC_INST_BODY);continue;case B.PROC_INST_QUOTED:b.procInstBody+=d,d===b.q&&(b.state=B.PROC_INST_BODY,b.q="");continue;case B.OPEN_TAG:z(p,d)?b.tagName+=d:(J(b),d===">"?M(b):d==="/"?b.state=B.OPEN_TAG_SLASH:(A(l,d)&&I(b,"Invalid character in tag name"),b.state=B.ATTRIB));continue;case B.OPEN_TAG_SLASH:d===">"?(M(b,!0),N(b)):(I(b,"Forward-slash in opening tag not followed by >"),b.state=B.ATTRIB);continue;case B.ATTRIB:if(z(l,d))continue;d===">"?M(b):d==="/"?b.state=B.OPEN_TAG_SLASH:z(o,d)?(b.attribName=d,b.attribValue="",b.state=B.ATTRIB_NAME):I(b,"Invalid attribute name");continue;case B.ATTRIB_NAME:d==="="?b.state=B.ATTRIB_VALUE:z(l,d)?b.state=B.ATTRIB_NAME_SAW_WHITE:z(p,d)?b.attribName+=d:I(b,"Invalid attribute name");continue;case B.ATTRIB_NAME_SAW_WHITE:if(d==="=")b.state=B.ATTRIB_VALUE;else{if(z(l,d))continue;I(b,"Attribute without value"),b.tag.attributes[b.attribName]="",b.attribValue="",D(b,"onattribute",{name:b.attribName,value:""}),b.attribName="",d===">"?M(b):z(o,d)?(b.attribName=d,b.state=B.ATTRIB_NAME):(I(b,"Invalid attribute name"),b.state=B.ATTRIB)}continue;case B.ATTRIB_VALUE:if(z(l,d))continue;z(q,d)?(b.q=d,b.state=B.ATTRIB_VALUE_QUOTED):(I(b,"Unquoted attribute value"),b.state=B.ATTRIB_VALUE_UNQUOTED,b.attribValue=d);continue;case B.ATTRIB_VALUE_QUOTED:if(d!==b.q){d==="&"?b.state=B.ATTRIB_VALUE_ENTITY_Q:b.attribValue+=d;continue}L(b),b.q="",b.state=B.ATTRIB;continue;case B.ATTRIB_VALUE_UNQUOTED:if(A(s,d)){d==="&"?b.state=B.ATTRIB_VALUE_ENTITY_U:b.attribValue+=d;continue}L(b),d===">"?M(b):b.state=B.ATTRIB;continue;case B.CLOSE_TAG:if(!b.tagName){if(z(l,d))continue;A(o,d)?I(b,"Invalid tagname in closing tag."):b.tagName=d}else d===">"?N(b):z(p,d)?b.tagName+=d:(A(l,d)&&I(b,"Invalid tagname in closing tag"),b.state=B.CLOSE_TAG_SAW_WHITE);continue;case B.CLOSE_TAG_SAW_WHITE:if(z(l,d))continue;d===">"?N(b):I("Invalid characters in closing tag");continue;case B.TEXT_ENTITY:case B.ATTRIB_VALUE_ENTITY_Q:case B.ATTRIB_VALUE_ENTITY_U:switch(b.state){case B.TEXT_ENTITY:var g=B.TEXT,h="textNode";break;case B.ATTRIB_VALUE_ENTITY_Q:var g=B.ATTRIB_VALUE_QUOTED,h="attribValue";break;case B.ATTRIB_VALUE_ENTITY_U:var g=B.ATTRIB_VALUE_UNQUOTED,h="attribValue"}d===";"?(b[h]+=O(b),b.entity="",b.state=g):z(r,d)?b.entity+=d:(I("Invalid character entity"),b[h]+="&"+b.entity+d,b.entity="",b.state=g);continue;default:throw new Error(b,"Unknown state: "+b.state)}}return b.position>=b.bufferCheckPosition&&e(b),b}b.parser=function(a,b){return new d(a,b)},b.SAXParser=d,b.SAXStream=k,b.createStream=j,b.MAX_BUFFER_LENGTH=65536;var c=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];b.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(a){function b(){this.__proto__=a}return b.prototype=a,new b}),Object.getPrototypeOf||(Object.getPrototypeOf=function(a){return a.__proto__}),Object.keys||(Object.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}),d.prototype={end:function(){H(this)},write:P,resume:function(){return this.error=null,this},close:function(){return this.write(null)},end:function(){return this.write(null)}};try{var g=a("stream").Stream}catch(h){var g=function(){}}var i=b.EVENTS.filter(function(a){return a!=="error"&&a!=="end"});k.prototype=Object.create(g.prototype,{constructor:{value:k}}),k.prototype.write=function(a){return this._parser.write(a.toString()),this.emit("data",a),!0},k.prototype.end=function(a){return a&&a.length&&this._parser.write(a.toString()),this._parser.end(),!0},k.prototype.on=function(a,b){var c=this;return!c._parser["on"+a]&&i.indexOf(a)!==-1&&(c._parser["on"+a]=function(){var b=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);b.splice(0,0,a),c.emit.apply(c,b)}),g.prototype.on.call(c,a,b)};var l="\r\n\t ",m="0124356789",n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",o=n+"_:",p=o+m+"-.",q="'\"",r=m+n+"#",s=l+">",t="[CDATA[",u="DOCTYPE",v="http://www.w3.org/XML/1998/namespace",w="http://www.w3.org/2000/xmlns/",x={xml:v,xmlns:w};l=y(l),m=y(m),n=y(n),o=y(o),p=y(p),q=y(q),r=y(r),s=y(s);var B=0;b.STATE={BEGIN:B++,TEXT:B++,TEXT_ENTITY:B++,OPEN_WAKA:B++,SGML_DECL:B++,SGML_DECL_QUOTED:B++,DOCTYPE:B++,DOCTYPE_QUOTED:B++,DOCTYPE_DTD:B++,DOCTYPE_DTD_QUOTED:B++,COMMENT_STARTING:B++,COMMENT:B++,COMMENT_ENDING:B++,COMMENT_ENDED:B++,CDATA:B++,CDATA_ENDING:B++,CDATA_ENDING_2:B++,PROC_INST:B++,PROC_INST_BODY:B++,PROC_INST_QUOTED:B++,PROC_INST_ENDING:B++,OPEN_TAG:B++,OPEN_TAG_SLASH:B++,ATTRIB:B++,ATTRIB_NAME:B++,ATTRIB_NAME_SAW_WHITE:B++,ATTRIB_VALUE:B++,ATTRIB_VALUE_QUOTED:B++,ATTRIB_VALUE_UNQUOTED:B++,ATTRIB_VALUE_ENTITY_Q:B++,ATTRIB_VALUE_ENTITY_U:B++,CLOSE_TAG:B++,CLOSE_TAG_SAW_WHITE:B++,SCRIPT:B++,SCRIPT_ENDING:B++},b.ENTITIES={apos:"'",quot:'"',amp:"&",gt:">",lt:"<"};for(var B in b.STATE)b.STATE[b.STATE[B]]=B;B=b.STATE})(typeof c=="undefined"?sax={}:c)}),require.define("stream",function(a,b,c,d,e){function h(){f.EventEmitter.call(this)}var f=a("events"),g=a("util");g.inherits(h,f.EventEmitter),b.exports=h,h.Stream=h,h.prototype.pipe=function(a,b){function d(b){a.writable&&!1===a.write(b)&&c.pause&&c.pause()}function e(){c.readable&&c.resume&&c.resume()}function g(){if(f)return;f=!0,a._pipeCount--,j();if(a._pipeCount>0)return;a.end()}function h(){if(f)return;f=!0,a._pipeCount--,j();if(a._pipeCount>0)return;a.destroy()}function i(a){j();if(this.listeners("error").length===0)throw a}function j(){c.removeListener("data",d),a.removeListener("drain",e),c.removeListener("end",g),c.removeListener("close",h),c.removeListener("error",i),a.removeListener("error",i),c.removeListener("end",j),c.removeListener("close",j),a.removeListener("end",j),a.removeListener("close",j)}var c=this;c.on("data",d),a.on("drain",e),!a._isStdio&&(!b||b.end!==!1)&&(a._pipeCount=a._pipeCount||0,a._pipeCount++,c.on("end",g),c.on("close",h));var f=!1;return c.on("error",i),a.on("error",i),c.on("end",j),c.on("close",j),a.on("end",j),a.on("close",j),a.emit("pipe",c),a}}),require.define("/node_modules/elementtree/lib/constants.js",function(a,b,c,d,e){var f="sax";c.DEFAULT_PARSER=f}),require.define("/lib/modularinputs/inputdefinition.js",function(a,b,c,d,e){(function(){function e(){this.metadata={},this.inputs={}}var c=a("elementtree"),d=a("./utils");e.parse=function(a){var b=new e,f=c.parse(a).getroot().getchildren();for(var g=0;g<f.length;g++){var h=f[g];h.tag==="configuration"?b.inputs=d.parseXMLData(h,"stanza"):b.metadata[h.tag]=h.text}return b},b.exports=e})()}),require.define("/lib/modularinputs/event.js",function(a,b,c,d,e){(function(){function e(a){a=d.isUndefined(a)?{}:a,this.data=d.isUndefined(a.data)?null:a.data,this.done=d.isUndefined(a.done)?!0:a.done,this.host=d.isUndefined(a.host)?null:a.host,this.index=d.isUndefined(a.index)?null:a.index,this.source=d.isUndefined(a.source)?null:a.source,this.sourcetype=d.isUndefined(a.sourcetype)?null:a.sourcetype,this.stanza=d.isUndefined(a.stanza)?null:a.stanza,this.unbroken=d.isUndefined(a.unbroken)?!0:a.unbroken,this.time=d.isUndefined(a.time)?null:a.time}var c=a("elementtree"),d=a("./utils");e.formatTime=function(a){var b;return a instanceof Date&&(a=a.valueOf()),!a||a===null?null:(a.toString().indexOf(".")!==-1?(a=parseFloat(a).toFixed(3),a.toString().indexOf(".")>=10?b=parseFloat(a.toString().substring(0,14)).toFixed(3):a.toString().length<=13||a.toString().indexOf(".")<10?b=parseFloat(a).toFixed(3):b=(parseFloat(a.toString().substring(0,14))/1e3).toFixed(3)):a.toString().length===13?b=(parseFloat(a)/1e3).toFixed(3):a.toString().length<=12?b=parseFloat(a).toFixed(3):b=parseFloat(a.toString().substring(0,13)/1e3).toFixed(3),b)},e.prototype._writeTo=function(a){if(!this.data)throw new Error("Events must have at least the data field set to be written to XML.");var b=c.Element("event");this.stanza&&b.set("stanza",this.stanza),b.set("unbroken",(+this.unbroken).toString()),!d.isUndefined(this.time)&&this.time!==null&&(c.SubElement(b,"time").text=e.formatTime(this.time).toString()),typeof this.data=="object"&&(this.data=JSON.stringify(this.data));var f=[{tag:"source",text:this.source},{tag:"sourcetype",text:this.sourcetype},{tag:"index",text:this.index},{tag:"host",text:this.host},{tag:"data",text:this.data}];for(var g=0;g<f.length;g++){var h=f[g];h.text&&(c.SubElement(b,h.tag).text=h.text)}(this.done||!d.isUndefined(this.done))&&c.SubElement(b,"done");var i=c.tostring(b,{xml_declaration:!1});a.write(i)},b.exports=e})()}),require.define("/lib/modularinputs/eventwriter.js",function(a,b,c,d,e){(function(){function h(a,b){this._out=d.isUndefined(a)?process.stdout:a,this._err=d.isUndefined(b)?process.stderr:b,this._headerWritten=!1}var c=a("elementtree"),d=a("./utils"),e=a("./logger"),f=a("stream"),g=a("../async");h.prototype.writeEvent=function(a){this._headerWritten||(this._out.write("<stream>"),this._headerWritten=!0);try{a._writeTo(this._out)}catch(b){throw b.message==="Events must have at least the data field set to be written to XML."?(e.warn("",b.message,this._err),b):(e.error("",b.message,this._err),b)}},h.prototype.writeXMLDocument=function(a){var b=c.tostring(a,{xml_declaration:!1});this._out.write(b)},h.prototype.close=function(){this._out.write("</stream>")},b.exports=h})()}),require.define("/lib/modularinputs/logger.js",function(a,b,c,d,e){(function(){"use strict";var d=a("./utils"),e=c||this;e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e.FATAL="FATAL",e._log=function(a,b,c,d){d=d||process.stderr,b&&b.length>0&&(b+=" ");var e=a+" Modular input "+b+c+"\n";d.write(e)},e.debug=function(a,b,c){try{e._log(e.DEBUG,a,b,c)}catch(d){throw d}},e.info=function(a,b,c){try{e._log(e.INFO,a,b,c)}catch(d){throw d}},e.warn=function(a,b,c){try{e._log(e.WARN,a,b,c)}catch(d){throw d}},e.error=function(a,b,c){try{e._log(e.ERROR,a,b,c)}catch(d){throw d}},e.fatal=function(a,b,c){try{e._log(e.FATAL,a,b,c)}catch(d){throw d}},b.exports=e})()}),require.define("/lib/modularinputs/argument.js",function(a,b,c,d,e){(function(){function e(a){a||(a={}),this.name=d.isUndefined(a.name)?"":a.name,this.description=d.isUndefined(a.description)?null:a.description,this.validation=d.isUndefined(a.validation)?null:a.validation,this.dataType=d.isUndefined(a.dataType)?e.dataTypeString:a.dataType,this.requiredOnEdit=d.isUndefined(a.requiredOnEdit)?!1:a.requiredOnEdit,this.requiredOnCreate=d.isUndefined(a.requiredOnCreate)?!1:a.requiredOnCreate}var c=a("elementtree"),d=a("./utils");e.dataTypeBoolean="BOOLEAN",e.dataTypeNumber="NUMBER",e.dataTypeString="STRING",e.prototype.addToDocument=function(a){var b=c.SubElement(a,"arg");b.set("name",this.name),this.description&&(c.SubElement(b,"description").text=this.description),this.validation&&(c.SubElement(b,"validation").text=this.validation);var d=[{tag:"data_type",value:this.dataType},{tag:"required_on_edit",value:this.requiredOnEdit},{tag:"required_on_create",value:this.requiredOnCreate}];for(var e=0;e<d.length;e++)c.SubElement(b,d[e].tag).text=d[e].value.toString().toLowerCase();return b},b.exports=e})()}),require.define("/lib/modularinputs/scheme.js",function(a,b,c,d,e){(function(){function f(a){this.title=d.isUndefined(a)?"":a,this.description=null,this.useExternalValidation=!0,this.useSingleInstance=!1,this.streamingMode=f.streamingModeXML,this.args=[]}var c=a("elementtree"),d=a("./utils"),e=a("./argument");f.streamingModeSimple="SIMPLE",f.streamingModeXML="XML",f.prototype.addArgument=function(a){a&&this.args.push(a)},f.prototype.toXML=function(){var a=c.Element("scheme");c.SubElement(a,"title").text=this.title,this.description&&(c.SubElement(a,"description").text=this.description);var b=[{tag:"use_external_validation",value:this.useExternalValidation},{tag:"use_single_instance",value:this.useSingleInstance},{tag:"streaming_mode",value:this.streamingMode}];for(var d=0;d<b.length;d++)c.SubElement(a,b[d].tag).text=b[d].value.toString().toLowerCase();var e=c.SubElement(c.SubElement(a,"endpoint"),"args");for(var f=0;f<this.args.length;f++)this.args[f].addToDocument(e);return a},b.exports=f})()}),require.define("/lib/modularinputs/modularinput.js",function(a,b,c,d,e){(function(){function m(){this._inputDefinition=null,this._service=null}var c=a("elementtree"),d=a("url"),e=a("./utils"),f=a("../async"),g=a("./validationdefinition"),h=a("./inputdefinition"),i=a("./eventwriter"),j=a("./scheme"),k=a("../service"),l=a("./logger");m.runScript=function(a,b,d,i,j){a.setup=a.setup||m.prototype.setup,a.start=a.start||m.prototype.start,a.end=a.end||m.prototype.end,a.teardown=a.teardown||m.prototype.teardown;var k=this;i.resume&&!i.isTTY&&i.resume();var n=new Buffer(0);if(b.length===1){var o=setTimeout(function(){j(new Error("Receiving input definitions prior to streaming timed out."),1)},30500);i.on("data",function(b){n=Buffer.concat([n,b]);var c=n.toString("utf8",0,n.length).trim();if(e.endsWith(c,"</input>")){clearTimeout(o);var g=h.parse(c);a._inputDefinition=g,k._inputDefinition=g,f.chain([function(b){f.parallelEach(Object.keys(a._inputDefinition.inputs),function(b,c,e){var g=a._inputDefinition.inputs[b];f.chain([function(c){a.start(b,g,c)},function(c){a.streamEvents(b,g,d,c)},function(c){a.end(b,g,c)}],function(a){e(a,a?1:0)})},function(a){b(a,a?1:0)})}],function(a){d._headerWritten&&d.close(),j(a,a?1:0)})}})}else if(b.length>=2&&b[1].toString().toLowerCase()==="--scheme"){var p=a.getScheme();if(!p)l.fatal("","script returned a null scheme.",d._err),j(null,1);else try{d.writeXMLDocument(p.toXML()),j(null,0)}catch(q){l.fatal("","script could not return the scheme, error: "+q,d._err),j(q,1)}}else if(b.length>=2&&b[1].toString().toLowerCase()==="--validate-arguments"){var r=setTimeout(function(){j(new Error("Receiving validation definition prior to validating timed out."),1)},30500);i.on("data",function(b){n=Buffer.concat([n,b]);var h=n.toString("utf8",0,n.length).trim();e.endsWith(h,"</items>")&&(clearTimeout(r),f.chain([function(b){try{if(e.isUndefined(a.validateInput))b();else{var c=g.parse(n.toString("utf8",0,n.length));a.validateInput(c,b)}}catch(d){b(d)}}],function(a){if(a){l.error("",a.message),l.error("","Stack trace for a modular input error: "+a.stack);try{var b=c.Element("error");c.SubElement(b,"message").text=a.message,d.writeXMLDocument(b),j(a,1)}catch(e){j(e,1)}}else j(null,0)}))})}else{var s="Invalid arguments to modular input script: "+b.join()+"\n";l.error("",s,d._err),j(s,1)}},m.service=function(){if(this._service)return this._service;if(!this._inputDefinition)return null;var a=this._inputDefinition.metadata.server_uri,b=this._inputDefinition.metadata.session_key,c=d.parse(a),e=c.protocol.replace(":",""),f=c.hostname,g=c.port;return this._service=new k({scheme:e,host:f,port:g,token:b}),this._service},m.prototype.setup=function(a){a()},m.prototype.start=function(a,b,c){c()},m.prototype.end=function(a,b,c){c()},m.prototype.teardown=function(a){a()},b.exports=m})()}),require.define("url",function(a,b,c,d,e){function v(a,b,c){if(a&&typeof a=="object"&&a.href)return a;if(typeof a!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d={},e=a;for(var h=0,j=e.length;h<j;h++)if(i.indexOf(e.charAt(h))===-1)break;h!==0&&(e=e.substr(h));var s=g.exec(e);if(s){s=s[0];var v=s.toLowerCase();d.protocol=v,e=e.substr(s.length)}if(c||s||e.match(/^\/\/[^@\/]+@[^@\/]+/)){var x=e.substr(0,2)==="//";x&&(!s||!r[s])&&(e=e.substr(2),d.slashes=!0)}if(!r[s]&&(x||s&&!t[s])){var y=e.indexOf("@");if(y!==-1){var A=!0;for(var h=0,j=m.length;h<j;h++){var B=e.indexOf(m[h]);if(B!==-1&&B<y){A=!1;break}}A&&(d.auth=e.substr(0,y),e=e.substr(y+1))}var C=-1;for(var h=0,j=l.length;h<j;h++){var B=e.indexOf(l[h]);B!==-1&&(C<0||B<C)&&(C=B)}C!==-1?(d.host=e.substr(0,C),e=e.substr(C)):(d.host=e,e="");var D=z(d.host),E=Object.keys(D);for(var h=0,j=E.length;h<j;h++){var F=E[h];d[F]=D[F]}d.hostname=d.hostname||"";if(d.hostname.length>n)d.hostname="";else{var G=d.hostname.split(/\./);for(var h=0,j=G.length;h<j;h++){var H=G[h];if(!H)continue;if(!H.match(o)){var I="";for(var J=0,K=H.length;J<K;J++)H.charCodeAt(J)>127?I+="x":I+=H[J];if(!I.match(o)){var L=G.slice(0,h),M=G.slice(h+1),N=H.match(p);N&&(L.push(N[1]),M.unshift(N[2])),M.length&&(e="/"+M.join(".")+e),d.hostname=L.join(".");break}}}}d.hostname=d.hostname.toLowerCase();var O=d.hostname.split("."),P=[];for(var h=0;h<O.length;++h){var Q=O[h];P.push(Q.match(/[^A-Za-z0-9_-]/)?"xn--"+f.encode(Q):Q)}d.hostname=P.join("."),d.host=(d.hostname||"")+(d.port?":"+d.port:""),d.href+=d.host}if(!q[v]){for(var h=0,j=k.length;h<j;h++){var R=k[h],S=encodeURIComponent(R);S===R&&(S=escape(R)),e=e.split(R).join(S)}var T=e.length;for(var h=0,j=i.length;h<j;h++){var U=e.indexOf(i[h]);U!==-1&&(T=Math.min(U,T))}e=e.substr(0,T)}var V=e.indexOf("#");V!==-1&&(d.hash=e.substr(V),e=e.slice(0,V));var W=e.indexOf("?");W!==-1?(d.search=e.substr(W),d.query=e.substr(W+1),b&&(d.query=u.parse(d.query)),e=e.slice(0,W)):b&&(d.search="",d.query={}),e&&(d.pathname=e),t[s]&&d.hostname&&!d.pathname&&(d.pathname="/");if(d.pathname||d.search)d.path=(d.pathname?d.pathname:"")+(d.search?d.search:"");return d.href=w(d),d}function w(a){typeof a=="string"&&(a=v(a));var b=a.auth||"";if(b){b=b.split("@").join("%40");for(var c=0,d=m.length;c<d;c++){var e=m[c];b=b.split(e).join(encodeURIComponent(e))}b+="@"}var f=a.protocol||"",g=a.host!==undefined?b+a.host:a.hostname!==undefined?b+a.hostname+(a.port?":"+a.port:""):!1,h=a.pathname||"",i=a.query&&(typeof a.query=="object"&&Object.keys(a.query).length?u.stringify(a.query):"")||"",j=a.search||i&&"?"+i||"",k=a.hash||"";return f&&f.substr(-1)!==":"&&(f+=":"),a.slashes||(!f||t[f])&&g!==!1?(g="//"+(g||""),h&&h.charAt(0)!=="/"&&(h="/"+h)):g||(g=""),k&&k.charAt(0)!=="#"&&(k="#"+k),j&&j.charAt(0)!=="?"&&(j="?"+j),f+g+h+j+k}function x(a,b){return w(y(a,b))}function y(a,b){if(!a)return b;a=v(w(a),!1,!0),b=v(w(b),!1,!0),a.hash=b.hash;if(b.href==="")return a.href=w(a),a;if(b.slashes&&!b.protocol)return b.protocol=a.protocol,t[b.protocol]&&b.hostname&&!b.pathname&&(b.path=b.pathname="/"),b.href=w(b),b;if(b.protocol&&b.protocol!==a.protocol){if(!t[b.protocol])return b.href=w(b),b;a.protocol=b.protocol;if(!b.host&&!r[b.protocol]){var c=(b.pathname||"").split("/");while(c.length&&!(b.host=c.shift()));b.host||(b.host=""),b.hostname||(b.hostname=""),c[0]!==""&&c.unshift(""),c.length<2&&c.unshift(""),b.pathname=c.join("/")}a.pathname=b.pathname,a.search=b.search,a.query=b.query,a.host=b.host||"",a.auth=b.auth,a.hostname=b.hostname||b.host,a.port=b.port;if(a.pathname!==undefined||a.search!==undefined)a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"");return a.slashes=a.slashes||b.slashes,a.href=w(a),a}var d=a.pathname&&a.pathname.charAt(0)==="/",e=b.host!==undefined||b.pathname&&b.pathname.charAt(0)==="/",f=e||d||a.host&&b.pathname,g=f,h=a.pathname&&a.pathname.split("/")||[],c=b.pathname&&b.pathname.split("/")||[],i=a.protocol&&!t[a.protocol];i&&(delete a.hostname,delete a.port,a.host&&(h[0]===""?h[0]=a.host:h.unshift(a.host)),delete a.host,b.protocol&&(delete b.hostname,delete b.port,b.host&&(c[0]===""?c[0]=b.host:c.unshift(b.host)),delete b.host),f=f&&(c[0]===""||h[0]===""));if(e)a.host=b.host||b.host===""?b.host:a.host,a.hostname=b.hostname||b.hostname===""?b.hostname:a.hostname,a.search=b.search,a.query=b.query,h=c;else if(c.length)h||(h=[]),h.pop(),h=h.concat(c),a.search=b.search,a.query=b.query;else if("search"in b){if(i){a.hostname=a.host=h.shift();var j=a.host&&a.host.indexOf("@")>0?a.host.split("@"):!1;j&&(a.auth=j.shift(),a.host=a.hostname=j.shift())}a.search=b.search,a.query=b.query;if(a.pathname!==undefined||a.search!==undefined)a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"");return a.href=w(a),a}if(!h.length)return delete a.pathname,a.search?delete a.path:a.path="/"+a.search,a.href=w(a),a;var k=h.slice(-1)[0],l=(a.host||b.host)&&(k==="."||k==="..")||k==="",m=0;for(var n=h.length;n>=0;n--)k=h[n],k=="."?h.splice(n,1):k===".."?(h.splice(n,1),m++):m&&(h.splice(n,1),m--);if(!f&&!g)for(;m--;m)h.unshift("..");f&&h[0]!==""&&(!h[0]||h[0].charAt(0)!=="/")&&h.unshift(""),l&&h.join("/").substr(-1)!=="/"&&h.push("");var o=h[0]===""||h[0]&&h[0].charAt(0)==="/";if(i){a.hostname=a.host=o?"":h.length?h.shift():"";var j=a.host&&a.host.indexOf("@")>0?a.host.split("@"):!1;j&&(a.auth=j.shift(),a.host=a.hostname=j.shift())}f=f||a.host&&h.length,f&&!o&&h.unshift(""),a.pathname=h.join("/");if(a.pathname!==undefined||a.search!==undefined)a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"");return a.auth=b.auth||a.auth,a.slashes=a.slashes||b.slashes,a.href=w(a),a}function z(a){var b={},c=h.exec(a);return c&&(c=c[0],b.port=c.substr(1),a=a.substr(0,a.length-c.length)),a&&(b.hostname=a),b}var f={encode:function(a){return a}};c.parse=v,c.resolve=x,c.resolveObject=y,c.format=w;var g=/^([a-z0-9.+-]+:)/i,h=/:[0-9]+$/,i=["<",">",'"',"`"," ","\r","\n","\t"],j=["{","}","|","\\","^","~","[","]","`"].concat(i),k=["'"],l=["%","/","?",";","#"].concat(j).concat(k),m=["/","@","?","#"].concat(i),n=255,o=/^[a-zA-Z0-9][a-z0-9A-Z_-]{0,62}$/,p=/^([a-zA-Z0-9][a-z0-9A-Z_-]{0,62})(.*)$/,q={javascript:!0,"javascript:":!0},r={javascript:!0,"javascript:":!0},s={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},t={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},u=a("querystring")}),require.define("querystring",function(a,b,c,d,e){function j(a,b){if(!b)throw new TypeError("stringify expects an object");return b+"="+encodeURIComponent(a)}function k(a,b){var c=[];if(!b)throw new TypeError("stringify expects an object");for(var d=0;d<a.length;d++)c.push(i(a[d],b+"[]"));return c.join("&")}function l(a,b){var c=[],d=Object.keys(a),e;for(var f=0,g=d.length;f<g;++f)e=d[f],c.push(i(a[e],b?b+"["+encodeURIComponent(e)+"]":encodeURIComponent(e)));return c.join("&")}function m(a,b,c){var d=a[b];undefined===d?a[b]=c:f(d)?d.push(c):a[b]=[d,c]}function n(a){var b=a.length,c,d;for(var e=0;e<b;++e){d=a[e],"]"==d&&(c=!1),"["==d&&(c=!0);if("="==d&&!c)return e}}var f=typeof Array.isArray=="function"?Array.isArray:function(a){return Object.toString.call(a)==="[object Array]"};c.version="0.3.1";var g=Object.prototype.toString,h=/[^0-9]/;c.parse=function(a){function b(a,b){if(a[b].length==0)return a[b]={};var c={};for(var d in a[b])c[d]=a[b][d];return a[b]=c,c}return null==a||""==a?{}:String(a).split("&").reduce(function(a,c){try{c=decodeURIComponent(c.replace(/\+/g," "))}catch(d){}var e=c.indexOf("="),g=n(c),i=c.substr(0,g||e),j=c.substr(g||e,c.length),j=j.substr(j.indexOf("=")+1,j.length),k=a;""==i&&(i=c,j="");if(~i.indexOf("]")){var l=i.split("["),o=l.length,p=o-1;function q(a,c,d){var e=a.shift();e?(obj=c[d]=c[d]||[],"]"==e?f(obj)?""!=j&&obj.push(j):"object"==typeof obj?obj[Object.keys(obj).length]=j:obj=c[d]=[c[d],j]:~e.indexOf("]")?(e=e.substr(0,e.length-1),h.test(e)&&f(obj)&&(obj=b(c,d)),q(a,obj,e)):(h.test(e)&&f(obj)&&(obj=b(c,d)),q(a,obj,e))):f(c[d])?c[d].push(j):"object"==typeof c[d]?c[d]=j:"undefined"==typeof c[d]?c[d]=j:c[d]=[c[d],j]}q(l,k,"base")}else{if(h.test(i)&&f(k.base)){var r={};for(var s in k.base)r[s]=k.base[s];k.base=r}m(k.base,i,j)}return a},{base:{}}).base};var i=c.stringify=function(a,b){return f(a)?k(a,b):"[object Object]"==g.call(a)?l(a,b):"string"==typeof a?j(a,b):b}}),require.define("/tests/test_async.js",function(a,b,c,d,e){c.setup=function(){var b=a("../index"),c=b.Async;b.Logger.setLevel("ALL");var d=!0;return{"While success":function(a){var b=0;c.whilst(function(){return b++<3},function(a){c.sleep(0,function(){a()})},function(b){a.ok(!b),a.done()})},"While success deep":function(a){var b=0;c.whilst(function(){return b++<(d?100:1e4)},function(a){c.sleep(0,function(){a()})},function(b){a.ok(!b),a.done()})},"While error":function(a){var b=0;c.whilst(function(){return b++<(d?100:1e4)},function(a){c.sleep(0,function(){a(b===(d?50:1e4)?1:null)})},function(b){a.ok(b),a.strictEqual(b,1),a.done()})},"Whilst sans condition is never":function(a){var b=!1;c.whilst(undefined,function(a){b=!0,a()},function(c){a.strictEqual(b,!1),a.done()})},"Whilst with empty body does nothing":function(a){var b=!0;c.whilst(function(){return b?(b=!1,!0):b},undefined,function(b){a.done()})},"Parallel success":function(a){c.parallel([function(a){a(null,1)},function(a){a(null,2,3)}],function(b,c,d){a.ok(!b),a.strictEqual(c,1),a.strictEqual(d[0],2),a.strictEqual(d[1],3),a.done()})},"Parallel success - outside of arrays":function(a){c.parallel(function(a){a(null,1)},function(a){a(null,2,3)},function(b,c,d){a.ok(!b),a.strictEqual(c,1),a.strictEqual(d[0],2),a.strictEqual(d[1],3),a.done()})},"Parallel success - no reordering":function(a){c.parallel([function(a){c.sleep(1,function(){a(null,1)})},function(a){a(null,2,3)}],function(b,c,d){a.ok(!b),a.strictEqual(c,1),a.strictEqual(d[0],2),a.strictEqual(d[1],3),a.done()})},"Parallel error":function(a){c.parallel([function(a){a(null,1)},function(a){a(null,2,3)},function(a){c.sleep(0,function(){a("ERROR")})}],function(b,c,d){a.ok(b==="ERROR"),a.ok(!c),a.ok(!d),a.done()})},"Parallel no tasks":function(a){c.parallel([],function(b){a.ok(!b),a.done()})},"Series success":function(a){c.series([function(a){a(null,1)},function(a){a(null,2,3)}],function(b,c,d){a.ok(!b),a.strictEqual(c,1),a.strictEqual(d[0],2),a.strictEqual(d[1],3),a.done()})},"Series success - outside of array":function(a){c.series(function(a){a(null,1)},function(a){a(null,2,3)},function(b,c,d){a.ok(!b),a.strictEqual(c,1),a.strictEqual(d[0],2),a.strictEqual(d[1],3),a.done()})},"Series reordering success":function(a){var b=0;c.series([function(d){c.sleep(10,function(){a.strictEqual(b++,0),d(null,1)})},function(c){a.strictEqual(b++,1),c(null,2,3)}],function(c,d,e){a.ok(!c),a.strictEqual(b,2),a.strictEqual(d,1),a.strictEqual(e[0],2),a.strictEqual(e[1],3),a.done()})},"Series error":function(a){c.series([function(a){a(null,1)},function(a){a("ERROR",2,3)}],function(b,c,d){a.strictEqual(b,"ERROR"),a.ok(!c),a.ok(!d),a.done()})},"Series no tasks":function(a){c.series([],function(b){a.ok(!b),a.done()})},"Parallel map success":function(a){c.parallelMap([1,2,3],function(a,b,c){c(null,a+1)},function(b,c){a.ok(!b),a.strictEqual(c[0],2),a.strictEqual(c[1],3),a.strictEqual(c[2],4),a.done()})},"Parallel map reorder success":function(a){c.parallelMap([1,2,3],function(a,b,d){a===2?c.sleep(100,function(){d(null,a+1)}):d(null,a+1)},function(b,c){a.strictEqual(c[0],2),a.strictEqual(c[1],3),a.strictEqual(c[2],4),a.done()})},"Parallel map error":function(a){c.parallelMap([1,2,3],function(a,b,c){a===2?c(5):c(null,a+1)},function(b,c){a.ok(b),a.ok(!c),a.strictEqual(b,5),a.done()})},"Series map success":function(a){var b=1;c.seriesMap([1,2,3],function(c,d,e){a.strictEqual(b++,c),e(null,c+1)},function(c,d){a.ok(!c),a.strictEqual(d[0],2),a.strictEqual(d[1],3),a.strictEqual(d[2],4),a.strictEqual(d[2],b),a.done()})},"Series map error":function(a){c.seriesMap([1,2,3],function(a,b,c){a===2?c(5):c(null,a+1)},function(b,c){a.ok(b),a.ok(!c),a.strictEqual(b,5),a.done()})},"Chain single success":function(a){c.chain([function(a){a(null,1)},function(a,b){b(null,a+1)},function(a,b){b(null,a+1)}],function(b,c){a.ok(!b),a.strictEqual(c,3),a.done()})},"Chain flat single success":function(a){c.chain(function(a){a(null,1)},function(a,b){b(null,a+1)},function(a,b){b(null,a+1)},function(b,c){a.ok(!b),a.strictEqual(c,3),a.done()})},"Chain flat multiple success":function(a){c.chain(function(a){a(null,1,2)},function(a,b,c){c(null,a+1,b+1)},function(a,b,c){c(null,a+1,b+1)},function(b,c,d){a.ok(!b),a.strictEqual(c,3),a.strictEqual(d,4),a.done()})},"Chain flat arity change success":function(a){c.chain(function(a){a(null,1,2)},function(a,b,c){c(null,a+1)},function(a,b){b(null,a+1,5)},function(b,c,d){a.ok(!b),a.strictEqual(c,3),a.strictEqual(d,5),a.done()})},"Chain error":function(a){c.chain([function(a){a(null,1,2)},function(a,b,c){c(5,a+1)},function(a,b){b(null,a+1,5)}],function(b,c,d){a.ok(b),a.ok(!c),a.ok(!d),a.strictEqual(b,5),a.done()})},"Chain no tasks":function(a){c.chain([],function(b,c,d){a.ok(!b),a.ok(!c),a.ok(!d),a.done()})},"Parallel each reodrder success":function(a){var b=0;c.parallelEach([1,2,3],function(a,d,e){var f=function(){b+=a,e()};d===1?c.sleep(100,f):f()},function(c){a.ok(!c),a.strictEqual(b,6),a.done()})},"Series each success":function(a){var b=[1,3,6],d=0;c.seriesEach([1,2,3],function(c,e,f){d+=c,a.strictEqual(d,b[e]),f()},function(b){a.ok(!b),a.strictEqual(d,6),a.done()})},"Augment callback":function(a){var b=function(b,c){a.ok(b),a.ok(c),a.strictEqual(b,1),a.strictEqual(c,2),a.done()},d=c.augment(b,2);d(1)}}};if(b===a.main){var f=a("../contrib/nodeunit/test_reporter"),g=c.setup();f.run([{Tests:g}])}}),require.define("/tests/test_http.js",function(a,b,c,d,e){c.setup=function(b){var c=a("../index");return c.Logger.setLevel("ALL"),{"HTTP GET Tests":{setUp:function(a){this.http=b,a()},"Callback#abort simple":function(a){var b=this.http.get("https://httpbin.org/get",{},{},0,function(b,c){a.ok(b),a.strictEqual(b.error,"abort"),a.done()});b.abort()},"Callback#abort delay":function(a){var b=this.http.get("https://httpbin.org/delay/20",{},{},0,function(b,c){a.ok(b),a.strictEqual(b.error,"abort"),a.done()});c.Async.sleep(1e3,function(){b.abort()})},"Callback#no args":function(a){this.http.get("http://httpbin.org/get",[],{},0,function(b,c){a.strictEqual(c.data.url,"http://httpbin.org/get"),a.done()})},"Callback#success success+error":function(a){this.http.get("http://httpbin.org/get",[],{},0,function(b,c){a.ok(!b),a.strictEqual(c.data.url,"http://httpbin.org/get"),a.done()})},"Callback#error all":function(a){this.http.get("http://httpbin.org/status/404",[],{},0,function(b,c){a.strictEqual(b.status,404),a.done()})},"Callback#args":function(a){this.http.get("http://httpbin.org/get",[],{a:1,b:2,c:[1,2,3],d:"a/b"},0,function(b,c){var d=c.data.args;a.strictEqual(d.a,"1"),a.strictEqual(d.b,"2"),a.same(d.c,["1","2","3"]),a.strictEqual(d.d,"a/b"),a.strictEqual(c.data.url,"http://httpbin.org/get?a=1&b=2&c=1&c=2&c=3&d=a%2Fb"),a.done()})},"Callback#args with objects":function(a){this.http.get("http://httpbin.org/get",[],{a:1,b:{c:"ab",d:12}},0,function(b,c){var d=c.data.args;a.strictEqual(d.a,"1"),a.same(d.b,["ab","12"]),a.strictEqual(c.data.url,"http://httpbin.org/get?a=1&b=ab&b=12"),a.done()})},"Callback#headers":function(a){var b={"X-Test1":1,"X-Test2":"a/b/c"};this.http.get("http://httpbin.org/get",{"X-Test1":1,"X-Test2":"a/b/c"},{},0,function(c,d){var e=d.data.headers;for(var f in b)b.hasOwnProperty(f)&&a.strictEqual(b[f]+"",e[f]);a.strictEqual(d.data.url,"http://httpbin.org/get"),a.done()})},"Callback#all":function(a){var b={"X-Test1":1,"X-Test2":"a/b/c"};this.http.get("http://httpbin.org/get",{"X-Test1":1,"X-Test2":"a/b/c"},{a:1,b:2,c:[1,2,3],d:"a/b"},0,function(c,d){var e=d.data.headers;for(var f in b)b.hasOwnProperty(f)&&a.strictEqual(b[f]+"",e[f]);var g=d.data.args;a.strictEqual(g.a,"1"),a.strictEqual(g.b,"2"),a.same(g.c,["1","2","3"]),a.strictEqual(g.d,"a/b"),a.strictEqual(d.data.url,"http://httpbin.org/get?a=1&b=2&c=1&c=2&c=3&d=a%2Fb"),a.done()})}},"HTTP POST Tests":{setUp:function(a){this.http=b,a()},"Callback#no args":function(a){this.http.post("http://httpbin.org/post",{},{},0,function(b,c){a.strictEqual(c.data.url,"http://httpbin.org/post"),a.done()})},"Callback#success success+error":function(a){this.http.post("http://httpbin.org/post",{},{},0,function(b,c){a.ok(!b),a.strictEqual(c.data.url,"http://httpbin.org/post"),a.done()})},"Callback#error all":function(a){this.http.post("http://httpbin.org/status/405",{},{},0,function(b,c){a.strictEqual(b.status,405),a.done()})},"Callback#args":function(a){this.http.post("http://httpbin.org/post",{},{a:1,b:2,c:[1,2,3],d:"a/b"},0,function(b,c){var d=c.data.form;a.strictEqual(d.a,"1"),a.strictEqual(d.b,"2"),a.deepEqual(d.c,["1","2","3"]),a.strictEqual(d.d,"a/b"),a.strictEqual(c.data.url,"http://httpbin.org/post"),a.done()})},"Callback#headers":function(a){var b={"X-Test1":1,"X-Test2":"a/b/c"};this.http.post("http://httpbin.org/post",{"X-Test1":1,"X-Test2":"a/b/c"},{},0,function(c,d){var e=d.data.headers;for(var f in b)b.hasOwnProperty(f)&&a.strictEqual(b[f]+"",e[f]);a.strictEqual(d.data.url,"http://httpbin.org/post"),a.done()})},"Callback#all":function(a){var b={"X-Test1":1,"X-Test2":"a/b/c"};this.http.post("http://httpbin.org/post",{"X-Test1":1,"X-Test2":"a/b/c"},{a:1,b:2,c:[1,2,3],d:"a/b"},0,function(c,d){var e=d.data.headers;for(var f in b)b.hasOwnProperty(f)&&a.strictEqual(b[f]+"",e[f]);var g=d.data.form;a.strictEqual(g.a,"1"),a.strictEqual(g.b,"2"),a.deepEqual(g.c,["1","2","3"]),a.strictEqual(g.d,"a/b"),a.strictEqual(d.data.url,"http://httpbin.org/post"),a.done()})}},"HTTP DELETE Tests":{setUp:function(a){this.http=b,a()},"Callback#no args":function(a){this.http.del("http://httpbin.org/delete",[],{},0,function(b,c){a.strictEqual(c.data.url,"http://httpbin.org/delete"),a.done()})},"Callback#success success+error":function(a){this.http.del("http://httpbin.org/delete",[],{},0,function(b,c){a.ok(!b),a.strictEqual(c.data.url,"http://httpbin.org/delete"),a.done()})},"Callback#error all":function(a){this.http.del("http://httpbin.org/status/405",[],{},0,function(b,c){a.strictEqual(b.status,405),a.done()})},"Callback#args":function(a){this.http.del("http://httpbin.org/delete",[],{a:1,b:2,c:[1,2,3],d:"a/b"},0,function(b,c){a.strictEqual(c.data.url,"http://httpbin.org/delete?a=1&b=2&c=1&c=2&c=3&d=a%2Fb"),a.done()})},"Callback#headers":function(a){var b={"X-Test1":1,"X-Test2":"a/b/c"};this.http.del("http://httpbin.org/delete",{"X-Test1":1,"X-Test2":"a/b/c"},{},0,function(c,d){var e=d.data.headers;for(var f in b)b.hasOwnProperty(f)&&a.strictEqual(b[f]+"",e[f]);a.strictEqual(d.data.url,"http://httpbin.org/delete"),a.done()})},"Callback#all":function(a){var b={"X-Test1":1,"X-Test2":"a/b/c"};this.http.del("http://httpbin.org/delete",{"X-Test1":1,"X-Test2":"a/b/c"},{a:1,b:2,c:[1,2,3],d:"a/b"},0,function(c,d){var e=d.data.headers;for(var f in b)b.hasOwnProperty(f)&&a.strictEqual(b[f]+"",e[f]);a.strictEqual(d.data.url,"http://httpbin.org/delete?a=1&b=2&c=1&c=2&c=3&d=a%2Fb"),a.done()})},"Default arguments to Http work":function(a){var b=c.NodeHttp,d=new b;a.ok(d),a.done()},"Methods of Http base class that must be overrided":function(a){var b=new c.Http;a.throws(function(){b.makeRequest("asdf",null,null)}),a.throws(function(){b.parseJson("{}")}),a.done()}}}};if(b===a.main){var f=a("../index"),g=f.NodeHttp,h=a("../contrib/nodeunit/test_reporter"),i=new g,j=c.setup(i);h.run([{Tests:j}])}}),require.define("/tests/test_context.js",function(a,b,c,d,e){c.setup=function(b){var c=a("../index"),d=a("./utils"),e=c.Async,f=c.Utils;c.Logger.setLevel("ALL");var g=typeof window!="undefined",h={"General Context Test":{setUp:function(a){this.service=b,a()},"Service exists":function(a){a.ok(this.service),a.done()},"Create test search":function(a){var b="DELETEME_JSSDK_UNITTEST";this.service.post("search/jobs",{search:"search index=_internal | head 1",exec_mode:"blocking",id:b},function(b,c){a.ok(c.data.sid),a.done()})},"Callback#login":function(a){var d=new c.Service(b.http,{scheme:b.scheme,host:b.host,port:b.port,username:b.username,password:b.password,version:b.version});d.login(function(b,c){a.ok(c),a.done()})},"Callback#login fail":function(a){var d=new c.Service(b.http,{scheme:b.scheme,host:b.host,port:b.port,username:b.username,password:b.password+"wrong_password",version:b.version});g?a.done():d.login(function(b,c){a.ok(b),a.ok(!c),a.done()})},"Callback#get":function(a){this.service.get("search/jobs",{count:1},function(b,c){a.strictEqual(c.data.paging.offset,0),a.ok(c.data.entry.length<=c.data.paging.total),a.strictEqual(c.data.entry.length,1),a.ok(c.data.entry[0].content.sid),a.done()})},"Callback#get error":function(a){this.service.get("search/jobs/1234_nosuchjob",{},function(b){a.ok(!!b),a.strictEqual(b.status,404),a.done()})},"Callback#get autologin - success":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,version:b.version});d.get("search/jobs",{count:1},function(b,c){a.strictEqual(c.data.paging.offset,0),a.ok(c.data.entry.length<=c.data.paging.total),a.strictEqual(c.data.entry.length,1),a.ok(c.data.entry[0].content.sid),a.done()})},"Callback#get autologin - error":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password+"ABC",version:b.version});d.get("search/jobs",{count:1},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#get autologin - disabled":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,autologin:!1,version:b.version});d.get("search/jobs",{count:1},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#get relogin - success":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,sessionKey:"ABCDEF-not-real",version:b.version});d.get("search/jobs",{count:1},function(b,c){a.ok(!b),a.strictEqual(c.data.paging.offset,0),a.ok(c.data.entry.length<=c.data.paging.total),a.strictEqual(c.data.entry.length,1),a.ok(c.data.entry[0].content.sid),a.done()})},"Callback#get relogin - error":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password+"ABC",sessionKey:"ABCDEF-not-real",version:b.version});d.get("search/jobs",{count:1},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#post":function(a){var b=this.service;this.service.post("search/jobs",{search:"search index=_internal | head 1"},function(c,d){var e=d.data.sid;a.ok(e);var f="search/jobs/"+e+"/control";b.post(f,{action:"cancel"},function(b,c){a.done()})})},"Callback#post error":function(a){this.service.post("search/jobs",{search:"index_internal | head 1"},function(b){a.ok(!!b),a.strictEqual(b.status,400),a.done()})},"Callback#post autologin - success":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,version:b.version});d.post("search/jobs",{search:"search index=_internal | head 1"},function(b,c){var e=c.data.sid;a.ok(e);var f="search/jobs/"+e+"/control";d.post(f,{action:"cancel"},function(b,c){a.done()})})},"Callback#post autologin - error":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password+"ABC",version:b.version});d.post("search/jobs",{search:"search index=_internal | head 1"},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#post autologin - disabled":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,autologin:!1,version:b.version});d.post("search/jobs",{search:"search index=_internal | head 1"},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#post relogin - success":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,sessionKey:"ABCDEF-not-real",version:b.version});d.post("search/jobs",{search:"search index=_internal | head 1"},function(b,c){var e=c.data.sid;a.ok(e);var f="search/jobs/"+e+"/control";d.post(f,{action:"cancel"},function(b,c){a.done()})})},"Callback#post relogin - error":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password+"ABC",sessionKey:"ABCDEF-not-real",version:b.version});d.post("search/jobs",{search:"search index=_internal | head 1"},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#delete":function(a){var b=this.service;this.service.post("search/jobs",{search:"search index=_internal | head 1"},function(c,d){var e=d.data.sid;a.ok(e);var f="search/jobs/"+e;b.del(f,{},function(b,c){a.done()})})},"Callback#delete error":function(a){this.service.del("search/jobs/1234_nosuchjob",{},function(b){a.ok(!!b),a.strictEqual(b.status,404),a.done()})},"Callback#delete autologin - success":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,version:b.version});d.post("search/jobs",{search:"search index=_internal | head 1"},function(b,c){var e=c.data.sid;a.ok(e),d.sessionKey=null;var f="search/jobs/"+e;d.del(f,{},function(b,c){a.done()})})},"Callback#delete autologin - error":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password+"ABC",version:b.version});d.del("search/jobs/NO_SUCH_SID",{},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#delete autologin - disabled":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,autologin:!1,version:b.version});d.del("search/jobs/NO_SUCH_SID",{},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#delete relogin - success":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,sessionKey:"ABCDEF-not-real",version:b.version});d.post("search/jobs",{search:"search index=_internal | head 1"},function(b,c){var e=c.data.sid;a.ok(e),d.sessionKey="ABCDEF-not-real";var f="search/jobs/"+e;d.del(f,{},function(b,c){a.done()})})},"Callback#delete relogin - error":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password+"ABC",sessionKey:"ABCDEF-not-real",version:b.version});d.del("search/jobs/NO_SUCH_SID",{},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#request get":function(a){var b={count:1},c=null,d=null;this.service.request("search/jobs","GET",b,c,d,{"X-TestHeader":1},function(b,c){a.strictEqual(c.data.paging.offset,0),a.ok(c.data.entry.length<=c.data.paging.total),a.strictEqual(c.data.entry.length,1),a.ok(c.data.entry[0].content.sid),c.response.request&&a.strictEqual(c.response.request.headers["X-TestHeader"],1),a.done()})},"Callback#request post":function(a){var b="search="+encodeURIComponent("search index=_internal | head 1"),c={"Content-Type":"application/x-www-form-urlencoded"},d=this.service;this.service.request("search/jobs","POST",null,null,b,c,function(b,c){var e=c.data.sid;a.ok(e);var f="search/jobs/"+e+"/control";d.post(f,{action:"cancel"},function(b,c){a.done()})})},"Callback#request error":function(a){this.service.request("search/jobs/1234_nosuchjob","GET",null,null,null,{"X-TestHeader":1},function(b){a.ok(!!b),b.response.request&&a.strictEqual(b.response.request.headers["X-TestHeader"],1),a.strictEqual(b.status,404),a.done()})},"Callback#request autologin - success":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,version:b.version}),e={count:1},f=null,g=null;d.request("search/jobs","GET",e,f,g,{"X-TestHeader":1},function(b,c){a.strictEqual(c.data.paging.offset,0),a.ok(c.data.entry.length<=c.data.paging.total),a.strictEqual(c.data.entry.length,1),a.ok(c.data.entry[0].content.sid),c.response.request&&a.strictEqual(c.response.request.headers["X-TestHeader"],1),a.done()})},"Callback#request autologin - error":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password+"ABC",version:b.version}),e={count:1},f=null,g=null;d.request("search/jobs","GET",e,f,g,{"X-TestHeader":1},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#request autologin - disabled":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,autologin:!1,version:b.version}),e={count:1},f=null,g=null;d.request("search/jobs","GET",e,f,g,{"X-TestHeader":1},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#request relogin - success":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,sessionKey:"ABCDEF-not-real",version:b.version}),e={count:1},f=null,g=null;d.request("search/jobs","GET",e,f,g,{"X-TestHeader":1},function(b,c){a.strictEqual(c.data.paging.offset,0),a.ok(c.data.entry.length<=c.data.paging.total),a.strictEqual(c.data.entry.length,1),a.ok(c.data.entry[0].content.sid),c.response.request&&a.strictEqual(c.response.request.headers["X-TestHeader"],1),a.done()})},"Callback#request relogin - error":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password+"ABC",sessionKey:"ABCDEF-not-real",version:b.version}),e={count:1},f=null,g=null;d.request("search/jobs","GET",e,f,g,{"X-TestHeader":1},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"Callback#abort":function(a){var b=this.service.get("search/jobs",{count:1},function(b,c){a.ok(!c),a.ok(b),a.strictEqual(b.error,"abort"),a.strictEqual(b.status,"abort"),a.done()});b.abort()},"Callback#timeout default test":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,version:b.version});a.strictEqual(0,d.timeout),d.request("search/jobs","GET",{count:1},null,null,{"X-TestHeader":1},function(b,c){a.ok(c),a.done()})},"Callback#timeout timed test":function(a){var d=new c.Service({scheme:this.service.scheme,host:this.service.host,port:this.service.port,username:this.service.username,password:this.service.password,version:b.version,timeout:1e4});a.strictEqual(d.timeout,1e4),d.request("search/jobs","GET",{count:1},null,null,{"X-TestHeader":1},function(b,c){a.ok(c),a.done()})},"Cancel test search":function(a){var b="search/jobs/DELETEME_JSSDK_UNITTEST/control";this.service.post(b,{action:"cancel"},function(b,c){a.done()})},"fullpath gets its owner/app from the right places":function(a){var b=d.DummyHttp,e=new c.Context(b,{});a.strictEqual(e.fullpath("/a/b/c"),"/a/b/c"),a.strictEqual(e.fullpath("meep"),"/services/meep");var f=new c.Context(b,{owner:"alpha",app:"beta"});a.strictEqual(f.fullpath("meep"),"/servicesNS/alpha/beta/meep"),a.strictEqual(f.fullpath("meep",{owner:"boris"}),"/servicesNS/boris/beta/meep"),a.strictEqual(f.fullpath("meep",{app:"factory"}),"/servicesNS/alpha/factory/meep"),a.strictEqual(f.fullpath("meep",{owner:"boris",app:"factory"}),"/servicesNS/boris/factory/meep"),a.strictEqual(f.fullpath("meep",{sharing:"app"}),"/servicesNS/nobody/beta/meep"),a.strictEqual(f.fullpath("meep",{sharing:"global"}),"/servicesNS/nobody/beta/meep"),a.strictEqual(f.fullpath("meep",{sharing:"system"}),"/servicesNS/nobody/system/meep");var g=new c.Context(b,{owner:"alpha@beta.com",app:"beta"});a.strictEqual(g.fullpath("meep"),"/servicesNS/alpha%40beta.com/beta/meep"),a.done()},"version check":function(a){var b=d.DummyHttp,e;e=new c.Context(b,{version:"4.0"}),a.ok(e.version==="4.0"),e=new c.Context(b,{version:"4.0"}),a.ok(e.versionCompare("5.0")===-1),e=new c.Context(b,{version:"4"}),a.ok(e.versionCompare("5.0")===-1),e=new c.Context(b,{version:"4.0"}),a.ok(e.versionCompare("5")===-1),e=new c.Context(b,{version:"4.1"}),a.ok(e.versionCompare("4.9")===-1),e=new c.Context(b,{version:"4.0"}),a.ok(e.versionCompare("4.0")===0),e=new c.Context(b,{version:"4"}),a.ok(e.versionCompare("4.0")===0),e=new c.Context(b,{version:"4.0"}),a.ok(e.versionCompare("4")===0),e=new c.Context(b,{version:"5.0"}),a.ok(e.versionCompare("4.0")===1),e=new c.Context(b,{version:"5.0"}),a.ok(e.versionCompare("4")===1),e=new c.Context(b,{version:"5"}),a.ok(e.versionCompare("4.0")===1),e=new c.Context(b,{version:"4.9"}),a.ok(e.versionCompare("4.1")===1),e=new c.Context(b,{}),a.ok(e.versionCompare("5.0")===0),a.done()}},"Cookie Tests":{setUp:function(a){this.service=b,this.skip=!1;var d=this;b.serverInfo(function(b,e){var f=parseInt(e.properties().version.split(".")[0],10),g=parseInt(e.properties().version.split(".")[1],10);if(f<6||f===6&&g<2)d.skip=!0,c.Logger.log("Skipping cookie tests...");a()})},tearDown:function(a){this.service.logout(a)},"_getCookieString works as expected":function(a){var d=new c.Service({scheme:b.scheme,host:b.host,port:b.port});d.http._cookieStore={cookie:"format",another:"one"};var e="cookie=format; another=one; ",f=d.http._getCookieString();a.strictEqual(f,e),a.done()},"login and store cookie":function(a){if(this.skip){a.done();return}var d=new c.Service({scheme:b.scheme,host:b.host,port:b.port,username:b.username,password:b.password,version:b.version});a.ok(f.isEmpty(d.http._cookieStore)),d.login(function(b,c){a.ok(!f.isEmpty(d.http._cookieStore)),a.notStrictEqual(d.http._getCookieString(),""),a.done()})},"request with cookie":function(a){if(this.skip){a.done();return}var d=new c.Service({scheme:b.scheme,host:b.host,port:b.port,username:b.username,password:b.password,version:b.version}),g=new c.Service({scheme:b.scheme,host:b.host,port:b.port,version:b.version});e.chain([function(a){d.login(a)},function(b,c){var e=d.http._cookieStore;a.ok(!f.isEmpty(e)),g.http._cookieStore=e,g.get("search/jobs",{count:1},c)},function(b,c){a.ok(b),c()}],function(b){a.ok(!b),a.done()})},"request fails with bad cookie":function(a){if(this.skip){a.done();return}var d=new c.Service({scheme:b.scheme,host:b.host,port:b.port,version:b.version});d.http._cookieStore={bad:"cookie"},d.get("search/jobs",{count:1},function(b,c){a.ok(b),a.strictEqual(b.status,401),a.done()})},"autologin with cookie":function(a){if(this.skip){a.done();return}var d=new c.Service({scheme:b.scheme,host:b.host,port:b.port,username:b.username,password:b.password,version:b.version});a.ok(f.isEmpty(d.http._cookieStore)),d.get("search/jobs",{count:1},function(b,c){a.ok(d.http._cookieStore),a.done()})},"login fails with no cookie and no sessionKey":function(a){if(this.skip){a.done();return}var d=new c.Service({scheme:b.scheme,host:b.host,port:b.port,version:b.version});a.ok(f.isEmpty(d.http._cookieStore)),a.strictEqual(d.sessionKey,""),a.ok(!d.username),a.ok(!d.password),d.get("search/jobs",{count:1},function(b,c){a.ok(b),a.done()})},"login with multiple cookies":function(a){if(this.skip){a.done();return}var d=new c.Service({scheme:b.scheme,host:b.host,port:b.port,username:b.username,password:b.password,version:b.version}),g=new c.Service({scheme:b.scheme,host:b.host,port:b.port,version:b.version});e.chain([function(a){d.login(a)},function(b,c){var e=d.http._cookieStore;a.ok(!f.isEmpty(e)),e.bad="cookie",g.http._cookieStore=e,g.get("search/jobs",{count:1},c)},function(b,c){a.ok(b),c()}],function(b){a.ok(!b),a.done()})},"autologin with cookie and bad sessionKey":function(a){if(this.skip){a.done();return}var d=new c.Service({scheme:b.scheme,host:b.host,port:b.port,username:b.username,password:b.password,sessionKey:"ABC-BADKEY",version:b.version});a.ok(f.isEmpty(d.http._cookieStore)),d.get("search/jobs",{count:1},function(b,c){a.ok(d.http._cookieStore),a.done()})}}};return h};if(b===a.main){var f=a("../index"),g=a("../examples/node/cmdline"),h=a("../contrib/nodeunit/test_reporter"),i=g.create(),j=i.parse(process.argv);if(!j)throw new Error("Error in parsing command line parameters");var k=new f.Service({scheme:j.opts.scheme,host:j.opts.host,port:j.opts.port,username:j.opts.username,password:j.opts.password,version:j.opts.version}),l=c.setup(k);k.login(function(a,b){if(a||!b)throw new Error("Login failed - not running tests",a||"");h.run([{Tests:l}])})}}),require.define("/tests/utils.js",function(a,b,c,d,e){(function(){"use strict";var b=a("../lib/async"),d=c||this;d.pollUntil=function(a,c,d,e){e=e||function(){};var f=0;b.whilst(function(){return!c(a)&&f++<d},function(c){b.sleep(500,function(){a.fetch(c)})},function(b){e(b,a)})},d.DummyHttp={_setSplunkVersion:function(a){}}})()}),require.define("/examples/node/cmdline.js",function(a,b,c,d,e){(function(){var c=a("path"),e=a("fs"),f=a("../../contrib/commander"),g=a("../../lib/utils"),h=[process.env.HOME||process.env.HOMEPATH,c.resolve(d,"..")],i=function(a,b){var c=e.readFileSync(a,"utf8")||"",d=c.split("\n")||[];for(var f=0;f<d.length;f++){var h=d[f].trim();if(h!==""&&!g.startsWith(h,"#")){var i=h.split("="),j=i[0].trim(),k=i[1].trim();b[j]=k}}},j=function(){var a={};for(var b=0;b<h.length;b++){var d=c.join(h[b],".splunkrc");e.existsSync(d)&&i(d,a)}return a};b.exports.create=function(){var a=new f.Command,b=a.parse;return a.password=undefined,a.option("-u, --username <username>","Username to login with",undefined,!0).option("--password <password>","Username to login with",undefined,!1).option("--scheme <scheme>","Scheme to use","https",!1).option("--host <host>","Hostname to use","localhost",!1).option("--port <port>","Port to use",8089,!1).option("--version <version>","Which version to use","4",!1),a.parse=function(c){c=(c||[]).slice(2);var d=j();for(var e in d)if(d.hasOwnProperty(e)&&c.indexOf("--"+e)<0){var f=d[e];c.unshift(f),c.unshift("--"+e.trim())}c.unshift(""),c.unshift("");var g=b.call(a,c);return g},a.add=function(b,c,d,e,f,h){var i={};e=e||[];var j=a.command(b+(d?" "+d:"")).description(c||"");for(var k=0;k<e.length;k++){var l=f.indexOf(e[k])>=0,m="<"+e[k]+">";j.option("--"+e[k]+" "+m,"",undefined,l)}j.action(function(){var a=g.toArray(arguments);a.unshift(b),h.apply(null,a)})},a}})()}),require.define("/tests/test_service.js",function(a,b,c,d,e){c.setup=function(b,c){var d=a("../index"),f=d.Utils,g=d.Async,h=a("./utils");d.Logger.setLevel("ALL");var i=0,j=function(){return"id"+i++ +"_"+(new Date).valueOf()},k={"Namespace Tests":{setUp:function(a){this.service=b;var c=this,d="jssdk_testapp_"+j(),e="jssdk_testapp_"+j(),f="jssdk_testuser_"+j(),h="jssdk_testuser_"+j(),i=this.service.apps(),k=this.service.users();this.namespace11={owner:f,app:d},this.namespace12={owner:f,app:e},this.namespace21={owner:h,app:d},this.namespace22={owner:h,app:e},g.chain([function(a){i.create({name:d},a)},function(a,b){c.app1=a,c.appName1=d,i.create({name:e},b)},function(a,b){c.app2=a,c.appName2=e,k.create({name:f,password:"abc",roles:["user"]},b)},function(a,b){c.user1=a,c.userName1=f,k.create({name:h,password:"abc",roles:["user"]},b)},function(a,b){c.user2=a,c.userName2=h,b()}],function(b){a()})},"Callback#Namespace protection":function(a){var b="jssdk_search_"+j(),c="search *",d=this.service,e=d.savedSearches(this.namespace11),f=d.savedSearches(this.namespace21),h=this;g.chain([function(a){e.create({name:b,search:c},a)},function(a,b){e.fetch(b)},function(a,b){f.fetch(b)},function(d,g){var h=e.item(b),i=f.item(b);a.ok(h),a.strictEqual(h.name,b),a.strictEqual(h.properties().search,c),a.ok(!i),g()}],function(b){a.ok(!b),a.done()})},"Callback#Namespace item":function(a){var b="jssdk_search_"+j(),c="search *",d=this.service,e={owner:"-",app:this.appName1},f={owner:"nobody",app:this.appName1},h=d.savedSearches(this.namespace11),i=d.savedSearches(this.namespace21),k=d.savedSearches(e),l=d.savedSearches(f),m=this;g.chain([function(a){h.create({name:b,search:c},a)},function(a,d){i.create({name:b,search:c},d)},function(a,b){k.fetch(b)},function(a,b){h.fetch(b)},function(a,b){i.fetch(b)},function(d,e){var f=h.item(b,m.namespace11),g=i.item(b,m.namespace21);a.ok(f),a.strictEqual(f.name,b),a.strictEqual(f.properties().search,c),a.strictEqual(f.namespace.owner,m.namespace11.owner),a.strictEqual(f.namespace.app,m.namespace11.app),a.ok(g),a.strictEqual(g.name,b),a.strictEqual(g.properties().search,c),a.strictEqual(g.namespace.owner,m.namespace21.owner),a.strictEqual(g.namespace.app,m.namespace21.app),e()},function(a){l.create({name:b,search:c},a)},function(a,b){h.fetch(b)},function(a,b){i.fetch(b)},function(d,e){try{k.item(b),a.ok(!1)}catch(f){a.ok(f)}try{k.item(b,{owner:"-"}),a.ok(!1)}catch(f){a.ok(f)}try{k.item(b,{app:"-"}),a.ok(!1)}catch(f){a.ok(f)}try{k.item(b,{app:"-",owner:"-"}),a.ok(!1)}catch(f){a.ok(f)}var g=k.item(b,m.namespace11),h=k.item(b,m.namespace21);a.ok(g),a.strictEqual(g.name,b),a.strictEqual(g.properties().search,c),a.strictEqual(g.namespace.owner,m.namespace11.owner),a.strictEqual(g.namespace.app,m.namespace11.app),a.ok(h),a.strictEqual(h.name,b),a.strictEqual(h.properties().search,c),a.strictEqual(h.namespace.owner,m.namespace21.owner),a.strictEqual(h.namespace.app,m.namespace21.app),e()}],function(b){a.ok(!b),a.done()})},"Callback#delete test applications":function(a){var b=this.service.apps();b.fetch(function(b,c){a.ok(!b),a.ok(c);var d=c.list();g.parallelEach(d,function(a,b,c){f.startsWith(a.name,"jssdk_")?a.remove(c):c()},function(b){a.ok(!b),a.done()})})},"Callback#delete test users":function(a){var b=this.service.users();b.fetch(function(b,c){var d=c.list();g.parallelEach(d,function(a,b,c){f.startsWith(a.name,"jssdk_")?a.remove(c):c()},function(b){a.ok(!b),a.done()})})}},"Job Tests":{setUp:function(a){this.service=b,a()},"Callback#Create+abort job":function(a){var b=this.service;g.chain([function(a){var c=process.env.SPLUNK_HOME+"/etc/apps/sdk-app-collection/build/sleep_command.tar";c=c.replace("%20"," "),b.post("apps/appinstall",{update:1,name:c},a)},function(c){var d=j(),e={id:d},f=b.jobs({app:"sdk-app-collection"}),h=f.oneshotSearch("search index=_internal | head 1 | sleep 10",e,function(b,c){a.ok(b),a.ok(!c),a.strictEqual(b.error,"abort"),a.done()});g.sleep(1e3,function(){h.abort()})}],function(b){a.ok(!b),a.done()})},"Callback#Create+cancel job":function(a){var b=j();this.service.jobs().search("search index=_internal | head 1",{id:b},function(c,d){a.ok(d),a.strictEqual(d.sid,b),d.cancel(function(){a.done()})})},"Callback#Create job error":function(a){var b=j();this.service.jobs().search({search:"index=_internal | head 1",id:b},function(b){a.ok(!!b),a.done()})},"Callback#List jobs":function(a){this.service.jobs().fetch(function(b,c){a.ok(!b),a.ok(c);var d=c.list();a.ok(d.length>0);for(var e=0;e<d.length;e++)a.ok(d[e]);a.done()})},"Callback#Contains job":function(a){var b=this,c=j(),d=this.service.jobs();d.search("search index=_internal | head 1",{id:c},function(b,e){a.ok(!b),a.ok(e),a.strictEqual(e.sid,c),d.fetch(function(b,d){a.ok(!b);var e=d.item(c);a.ok(e),e.cancel(function(){a.done()})})})},"Callback#job results":function(a){var b=j(),c=this.service,d=this;g.chain([function(a){d.service.jobs().search("search index=_internal | head 1 | stats count",{id:b},a)},function(c,d){a.strictEqual(c.sid,b),h.pollUntil(c,function(a){return c.properties().isDone},10,d)},function(a,b){a.results({},b)},function(b,c,d){a.strictEqual(b.rows.length,1),a.strictEqual(b.fields.length,1),a.strictEqual(b.fields[0],"count"),a.strictEqual(b.rows[0][0],"1"),c.cancel(d)}],function(b){a.ok(!b),a.done()})},"Callback#job events":function(a){var b=j(),c=this.service,d=this;g.chain([function(a){d.service.jobs().search("search index=_internal | head 1",{id:b},a)},function(c,d){a.strictEqual(c.sid,b),h.pollUntil(c,function(a){return c.properties().isDone},10,d)},function(a,b){a.events({},b)},function(b,c,d){a.strictEqual(b.rows.length,1),a.strictEqual(b.fields.length,b.rows[0].length),c.cancel(d)}],function(b){a.ok(!b),a.done()})},"Callback#job results preview":function(a){var b=j(),c=this.service,d=this;g.chain([function(a){d.service.jobs().search("search index=_internal | head 1 | stats count",{id:b},a)},function(c,d){a.strictEqual(c.sid,b),h.pollUntil(c,function(a){return c.properties().isDone},10,d)},function(a,b){a.preview({},b)},function(b,c,d){a.strictEqual(b.rows.length,1),a.strictEqual(b.fields.length,1),a.strictEqual(b.fields[0],"count"),a.strictEqual(b.rows[0][0],"1"),c.cancel(d)}],function(b){a.ok(!b),a.done()})},"Callback#job results iterator":function(a){var b=this;g.chain([function(a){b.service.jobs().search("search index=_internal | head 10",{},a)},function(a,b){h.pollUntil(a,function(b){return a.properties().isDone},10,b)},function(b,c){var d=b.iterator("results",{pagesize:4}),e=!0,f=0,h=[];g.whilst(function(){return e},function(a){d.next(function(b,c,d){if(b){a(b);return}e=d,e&&h.push(c.rows.length),a()})},function(b){a.deepEqual(h,[4,4,2]),c(b)})}],function(b){a.ok(!b),a.done()})},"Callback#Enable + disable preview":function(a){var b=this,c=j(),d=this.service.specialize("nobody","sdk-app-collection");g.chain([function(a){d.jobs().search("search index=_internal | head 1 | sleep 60",{id:c},a)},function(a,b){a.enablePreview(b)},function(a,b){a.disablePreview(b)},function(a,b){a.cancel(b)}],function(b){a.ok(!b),a.done()})},"Callback#Pause + unpause + finalize preview":function(a){var b=this,c=j(),d=this.service.specialize("nobody","sdk-app-collection");g.chain([function(a){d.jobs().search("search index=_internal | head 1 | sleep 5",{id:c},a)},function(a,b){a.pause(b)},function(a,b){h.pollUntil(a,function(a){return a.properties().isPaused},10,b)},function(b,c){a.ok(b.properties().isPaused),b.unpause(c)},function(a,b){h.pollUntil(a,function(a){return!a.properties().isPaused},10,b)},function(b,c){a.ok(!b.properties().isPaused),b.finalize(c)},function(a,b){a.cancel(b)}],function(b){a.ok(!b),a.done()})},"Callback#Set TTL":function(a){var b=j(),c=0,d=this;g.chain([function(a){d.service.jobs().search("search index=_internal | head 1",{id:b},a)},function(a,b){a.fetch(b)},function(a,b){var d=a.properties().ttl;c=d,a.setTTL(d*2,b)},function(a,b){a.fetch(b)},function(b,d){var e=b.properties().ttl;a.ok(e>c),a.ok(e<=c*2),b.cancel(d)}],function(b){a.ok(!b),a.done()})},"Callback#Set priority":function(a){var b=j(),c=0,d=this,e=this.service.specialize("nobody","sdk-app-collection");g.chain([function(a){e.jobs().search("search index=_internal | head 1 | sleep 5",{id:b},a)},function(a,b){a.track({},{ready:function(a){b(null,a)}})},function(b,c){var d=b.properties().priority;a.ok(d,5),b.setPriority(d+1,c)},function(a,b){a.fetch(b)},function(a,b){a.cancel(b)}],function(b){a.ok(!b),a.done()})},"Callback#Search log":function(a){var b=j(),c=this;g.chain([function(a){c.service.jobs().search("search index=_internal | head 1",{id:b,exec_mode:"blocking"},a)},function(a,b){a.searchlog(b)},function(b,c,d){a.ok(c),a.ok(b),a.ok(b.length>0),a.ok(b.split("\r\n").length>0),c.cancel(d)}],function(b){a.ok(!b),a.done()})},"Callback#Search summary":function(a){var b=j(),c=this;g.chain([function(a){c.service.jobs().search('search index=_internal | head 1 | eval foo="bar" | fields foo',{id:b,status_buckets:300,rf:["foo"]},a)},function(a,b){g.sleep(2e3,function(){a.summary({},b)})},function(b,c,d){a.ok(c),a.ok(b),a.strictEqual(b.event_count,1),a.strictEqual(b.fields.foo.count,1),a.strictEqual(b.fields.foo.distinct_count,1),a.ok(b.fields.foo.is_exact,1),a.strictEqual(b.fields.foo.modes.length,1),a.strictEqual(b.fields.foo.modes[0].count,1),a.strictEqual(b.fields.foo.modes[0].value,"bar"),a.ok(b.fields.foo.modes[0].is_exact),c.cancel(d)}],function(b){a.ok(!b),a.done()})},"Callback#Search timeline":function(a){var b=j(),c=this;g.chain([function(a){c.service.jobs().search('search index=_internal | head 1 | eval foo="bar" | fields foo',{id:b,status_buckets:300,rf:["foo"],exec_mode:"blocking"},a)},function(a,b){a.timeline({},b)},function(b,c,d){a.ok(c),a.ok(b),a.strictEqual(b.buckets.length,1),a.strictEqual(b.event_count,1),a.strictEqual(b.buckets[0].available_count,1),a.strictEqual(b.buckets[0].duration,.001),a.strictEqual(b.buckets[0].earliest_time_offset,b.buckets[0].latest_time_offset),a.strictEqual(b.buckets[0].total_count,1),a.ok(b.buckets[0].is_finalized),c.cancel(d)}],function(b){a.ok(!b),a.done()})},"Callback#Touch":function(a){var b=j(),c=this,d="";g.chain([function(a){c.service.jobs().search("search index=_internal | head 1",{id:b},a)},function(a,b){a.fetch(b)},function(b,c){a.ok(b),d=b.properties().updated,g.sleep(1200,function(){b.touch(c)})},function(a,b){a.fetch(b)},function(b,c){a.ok(d!==b.updated()),b.cancel(c)}],function(b){a.ok(!b),a.done()})},"Callback#Create failure":function(a){var b="jssdk_savedsearch_"+j(),c="search index=_internal | head 1",d=this.service.jobs();a.throws(function(){d.create({search:c,name:b,exec_mode:"oneshot"},function(){})}),a.done()},"Callback#Create fails with no search string":function(a){var b=this.service.jobs();b.create("",{},function(b){a.ok(b),a.done()})},"Callback#Oneshot search":function(a){var b=j(),c=this,d="";g.chain([function(a){c.service.jobs().oneshotSearch("search index=_internal | head 1 | stats count",{id:b},a)},function(b,c){a.ok(b),a.ok(b.fields),a.strictEqual(b.fields.length,1),a.strictEqual(b.fields[0],"count"),a.ok(b.rows),a.strictEqual(b.rows.length,1),a.strictEqual(b.rows[0].length,1),a.strictEqual(b.rows[0][0],"1"),c()}],function(b){a.ok(!b),a.done()})},"Callback#Oneshot search with no results":function(a){var b=j(),c=this,d="";g.chain([function(a){var d="search index=history MUST_NOT_EXISTABCDEF";c.service.jobs().oneshotSearch(d,{id:b},a)},function(b,c){a.ok(b),a.strictEqual(b.fields.length,0),a.strictEqual(b.rows.length,0),a.ok(!b.preview),c()}],function(b){a.ok(!b),a.done()})},"Callback#Service oneshot search":function(a){var b=j(),c=this,d={owner:"admin",app:"search"},e=6.1,f="DEBUG";g.chain([function(b){g.chain([function(a){c.service.serverInfo(a)},function(a,c){e=parseFloat(a.properties().version),e<6.2?b():c()},function(a){c.service.configurations({owner:"admin",app:"search"}).fetch(a)},function(a,b){try{a.item("limits").fetch(b)}catch(c){b(c)}},function(a,b){var c=a.item("search_info");f=c.properties().infocsv_log_level,c.update({infocsv_log_level:"DEBUG"},b)},function(b,c){a.strictEqual("DEBUG",b.properties().infocsv_log_level),c()}],function(c){a.ok(!c),b()})},function(a){c.service.oneshotSearch("search index=_internal | head 1 | stats count",{id:b},d,a)},function(b,c){a.ok(b),a.ok(b.fields),a.strictEqual(b.fields.length,1),a.strictEqual(b.fields[0],"count"),a.ok(b.rows),a.strictEqual(b.rows.length,1),a.strictEqual(b.rows[0].length,1),a.strictEqual(b.rows[0][0],"1"),a.ok(b.messages[1].text.indexOf('owner="admin"')),a.ok(b.messages[1].text.indexOf('app="search"')),c()},function(b){g.chain([function(a){e<6.2?b():a()},function(a){c.service.configurations({owner:"admin",app:"search"}).fetch(a)},function(a,b){try{a.item("limits").fetch(b)}catch(c){b(c)}},function(a,b){var c=a.item("search_info");c.update({infocsv_log_level:f},b)},function(b,c){a.strictEqual(f,b.properties().infocsv_log_level),c()}],function(c){a.ok(!c),b()})}],function(b){a.ok(!b),a.done()})},"Callback#Service search":function(a){var b=j(),c=this.service,d=this,e={owner:"admin",app:"search"};g.chain([function(a){d.service.search("search index=_internal | head 1 | stats count",{id:b},e,a)},function(c,d){a.strictEqual(c.sid,b),a.strictEqual(c.namespace,e),h.pollUntil(c,function(a){return c.properties().isDone},10,d)},function(a,b){a.results({},b)},function(b,c,d){a.strictEqual(b.rows.length,1),a.strictEqual(b.fields.length,1),a.strictEqual(b.fields[0],"count"),a.strictEqual(b.rows[0][0],"1"),c.cancel(d)}],function(b){a.ok(!b),a.done()})},"Callback#Wait until job done":function(a){this.service.search("search index=_internal | head 1000",{},function(b,c){a.ok(!b);var d=0,e=0;c.track({period:200},{ready:function(b){a.ok(b),d++},progress:function(b){a.ok(b),e++},done:function(b){a.ok(b),a.ok(d===1),a.ok(e>=1),a.done()},failed:function(b){a.ok(b),a.ok(!1,"Job failed unexpectedly."),a.done()},error:function(b){a.ok(b),a.ok(!1,"Error while tracking job."),a.done()}})})},"Callback#Wait until job failed":function(a){this.service.search("search index=_internal | head bogusarg",{},function(b,c){if(b){a.ok(!b),a.done();return}var d=0,e=0;c.track({period:200},{ready:function(b){a.ok(b),d++},progress:function(b){a.ok(b),e++},done:function(b){a.ok(b),a.ok(!1,"Job became done unexpectedly."),a.done()},failed:function(b){a.ok(b),a.ok(d===1),a.ok(e>=1),a.done()},error:function(b){a.ok(b),a.ok(!1,"Error while tracking job."),a.done()}})})},"Callback#track() with default params and one function":function(a){this.service.search("search index=_internal | head 1",{},function(b,c){if(b){a.ok(!b),a.done();return}c.track({},function(b){a.ok(b),a.done()})})},"Callback#track() should stop polling if only the ready callback is specified":function(a){this.service.search("search index=_internal | head 1",{},function(b,c){if(b){a.ok(!b),a.done();return}c.track({},{ready:function(b){a.ok(b)},_stoppedAfterReady:function(b){a.done()}})})},"Callback#track() a job that is not immediately ready":function(a){var b=20,c=b,e=!1;for(var f=0;f<b;f++)this.service.search("search index=_internal | head 10000",{},function(b,f){if(b){a.ok(!b),a.done();return}f.track({},{_preready:function(a){e=!0},ready:function(b){c--,c===0&&(e||d.Logger.error("","WARNING: Couldn't test code path in track() where job wasn't ready immediately."),a.done())}})})},"Callback#Service.getJob() works":function(a){var b=this,c=!1;this.service.search("search index=_internal | head 1",{},function(d,e){if(d){a.ok(!d),a.done();return}var f=e.sid;return g.chain([function(a){b.service.getJob(f,a)},function(b,d){a.strictEqual(f,b.sid),c=f===b.sid,d()}],function(b){a.ok(!b),a.ok(c),a.done()})})}},"Data Model tests":{setUp:function(a){this.service=b,this.dataModels=b.dataModels(),this.skip=!1;var c=this;this.service.serverInfo(function(b,e){parseInt(e.properties().version.split(".")[0],10)<6&&(c.skip=!0,d.Logger.log("Skipping data model tests...")),a(b)})},"Callback#DataModels - fetch a built-in data model":function(a){if(this.skip){a.done();return}var b=this;g.chain([function(a){b.dataModels.fetch(a)},function(b,c){var d=b.item("internal_audit_logs");a.ok(d.objectByName("Audit")),a.ok(d.objectByName("searches")),a.ok(d.objectByName("modify")),a.strictEqual(null,d.objectByName(j())),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - create & delete an empty data model":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/empty_data_model.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h,i=this;g.chain([function(a){i.dataModels.fetch(a)},function(a,c){h=a.list().length,a.create(d,b,c)},function(a,b){i.dataModels.fetch(b)},function(b,c){a.strictEqual(h+1,b.list().length),b.item(d).remove(c)},function(a){i.dataModels.fetch(a)},function(b,c){a.strictEqual(h,b.list().length),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - create a data model with spaces in the name, which are swapped for -'s":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/empty_data_model.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me- "+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){a.strictEqual(d.replace(" ","_"),b.name),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - create a data model with 0 objects":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/empty_data_model.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){a.strictEqual(0,b.objects.length),h.dataModels.fetch(c)},function(b,c){a.strictEqual(0,b.item(d).objects.length),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - create a data model with 1 search object":function(a){if(this.skip){a.done();return}var b=this.service.dataModels(),c;try{c=JSON.parse(f.readFile(e,"../data/object_with_one_search.json"))}catch(d){a.ok(!d),a.done()}var h="delete-me-"+j(),i=this;g.chain([function(a){i.dataModels.create(h,c,a)},function(b,c){a.strictEqual(1,b.objects.length),i.dataModels.fetch(c)},function(b,c){a.strictEqual(1,b.item(h).objects.length),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - create a data model with 2 search objects":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/object_with_two_searches.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){a.strictEqual(2,b.objects.length),h.dataModels.fetch(c)},function(b,c){a.strictEqual(2,b.item(d).objects.length),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - data model objects are created correctly":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/object_with_two_searches.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){a.ok(b.hasObject("search1")),a.ok(b.hasObject("search2"));var d=b.objectByName("search1");a.ok(d),a.strictEqual("‡Øµ‡Ø±‡Ø∞‡ØØ - search 1",d.displayName);var e=b.objectByName("search2");a.ok(e),a.strictEqual("‡Øµ‡Ø±‡Ø∞‡ØØ - search 2",e.displayName),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - data model handles unicode characters":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/model_with_unicode_headers.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){a.strictEqual(d,b.name),a.strictEqual("·Ä©·öô‡Øµ",b.displayName),a.strictEqual("‡Øµ‡Ø±‡Ø∞‡ØØ",b.description),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - create data model with empty headers":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/model_with_empty_headers.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){a.strictEqual(d,b.name),a.strictEqual("",b.displayName),a.strictEqual("",b.description),a.strictEqual("0",b.concise),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - test acceleration settings":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/data_model_with_test_objects.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){b.acceleration.enabled=!0,b.acceleration.earliestTime="-2mon",b.acceleration.cronSchedule="5/* * * * *",a.strictEqual(!0,b.isAccelerated()),a.strictEqual(!0,b.acceleration.enabled),a.strictEqual("-2mon",b.acceleration.earliestTime),a.strictEqual("5/* * * * *",b.acceleration.cronSchedule),a.same({enabled:!0,earliestTime:"-2mon",cronSchedule:"5/* * * * *"},b.acceleration),b.acceleration.enabled=!1,b.acceleration.earliestTime="-1mon",b.acceleration.cronSchedule="* * * * *",a.strictEqual(!1,b.isAccelerated()),a.strictEqual(!1,b.acceleration.enabled),a.strictEqual("-1mon",b.acceleration.earliestTime),a.strictEqual("* * * * *",b.acceleration.cronSchedule),a.same({enabled:!1,earliestTime:"-1mon",cronSchedule:"* * * * *"},b.acceleration),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - test data model object metadata":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/data_model_with_test_objects.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){var d=b.objectByName("event1");a.ok(d),a.strictEqual("event1 ·Ä©·öô",d.displayName),a.strictEqual("event1",d.name),a.same(b,d.dataModel),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - test data model object parent":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/data_model_with_test_objects.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){var d=b.objectByName("event1");a.ok(d),a.ok(!d.parent()),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - test data model object lineage":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/inheritance_test_data.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){var d=b.objectByName("level_0");a.ok(d),a.strictEqual(1,d.lineage.length),a.strictEqual("level_0",d.lineage[0]),a.strictEqual("BaseEvent",d.parentName),d=b.objectByName("level_1"),a.ok(d),a.strictEqual(2,d.lineage.length),a.same(["level_0","level_1"],d.lineage),a.strictEqual("level_0",d.parentName),d=b.objectByName("level_2"),a.ok(d),a.strictEqual(3,d.lineage.length),a.same(["level_0","level_1","level_2"],d.lineage),a.strictEqual("level_1",d.parentName),a.ok(!b.objectByName("level_3")),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - test data model object fields":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/inheritance_test_data.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){var d=b.objectByName("level_2");a.ok(d);var e=d.fieldByName("_time");a.ok(e),a.strictEqual("timestamp",e.type),a.ok(e.isTimestamp()),a.ok(!e.isNumber()),a.ok(!e.isString()),a.ok(!e.isObjectcount()),a.ok(!e.isChildcount()),a.ok(!e.isIPv4()),a.same(["BaseEvent"],e.lineage),a.strictEqual("_time",e.name),a.strictEqual(!1,e.required),a.strictEqual(!1,e.multivalued),a.strictEqual(!1,e.hidden),a.strictEqual(!1,e.editable),a.strictEqual(null,e.comment);var f=d.fieldByName("level_2");a.strictEqual("level_2",f.owner),a.same(["level_0","level_1","level_2"],f.lineage),a.strictEqual("objectCount",f.type),a.ok(!f.isTimestamp()),a.ok(!f.isNumber()),a.ok(!f.isString()),a.ok(f.isObjectcount()),a.ok(!f.isChildcount()),a.ok(!f.isIPv4()),a.strictEqual("level_2",f.name),a.strictEqual("level 2",f.displayName),a.strictEqual(!1,f.required),a.strictEqual(!1,f.multivalued),a.strictEqual(!1,f.hidden),a.strictEqual(!1,f.editable),a.strictEqual(null,f.comment),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - test data model object properties":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h=this;g.chain([function(a){h.dataModels.create(d,b,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d),a.strictEqual(5,d.fieldNames().length),a.strictEqual(10,d.allFieldNames().length),a.ok(d.fieldByName("has_boris")),a.ok(d.hasField("has_boris")),a.ok(d.fieldByName("_time")),a.ok(d.hasField("_time")),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - create local acceleration job":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/inheritance_test_data.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),i,k=this;g.chain([function(a){k.dataModels.create(d,b,a)},function(b,c){i=b.objectByName("level_2"),a.ok(i),i.createLocalAccelerationJob(null,c)},function(b,c){a.ok(b),h.pollUntil(b,function(a){return b.properties().isDone},10,c)},function(b,c){a.strictEqual('| datamodel "'+d+'" level_2 search | tscollect',b.properties().request.search),b.cancel(c)}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - create local acceleration job with earliest time":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/inheritance_test_data.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),i,k=Date.now(),l=this;g.chain([function(a){l.dataModels.create(d,b,a)},function(b,c){i=b.objectByName("level_2"),a.ok(i),i.createLocalAccelerationJob("-1d",c)},function(b,c){a.ok(b),h.pollUntil(b,function(a){return b.properties().isDone},10,c)},function(b,c){a.strictEqual('| datamodel "'+d+'" level_2 search | tscollect',b.properties().request.search);var e=new Date(Date.now()-864e5),g=e.getMonth()+1;g<=9&&(g="0"+g);var h=e.getDate();h<=9&&(h="0"+h);var i=e.getFullYear()+"-"+g+"-"+h;a.ok(f.startsWith(b._state.content.earliestTime,i)),b.cancel(c)}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - test data model constraints":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/data_model_with_test_objects.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h,i=this;g.chain([function(a){i.dataModels.create(d,b,a)},function(b,c){h=b.objectByName("event1"),a.ok(h);var d=h.constraints;a.ok(d);var e=!0;for(var f=0;f<d.length;f++){var g=d[f];a.ok(!!e),a.strictEqual("event1",g.owner),a.strictEqual('uri="*.php" OR uri="*.py"\nNOT (referer=null OR referer="-")',g.query)}c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - test data model calculations, and the different types":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/data_model_with_test_objects.json"))}catch(c){a.ok(!c),a.done()}var d="delete-me-"+j(),h,i=this;g.chain([function(a){i.dataModels.create(d,b,a)},function(b,c){h=b.objectByName("event1"),a.ok(h);var d=h.calculations;a.strictEqual(4,Object.keys(d).length),a.strictEqual(4,h.calculationIDs().length);var e=d["93fzsv03wa7"];a.ok(e),a.strictEqual("event1",e.owner),a.same(["event1"],e.lineage),a.strictEqual("Eval",e.type),a.ok(e.isEval()),a.ok(!e.isLookup()),a.ok(!e.isGeoIP()),a.ok(!e.isRex()),a.strictEqual(null,e.comment),a.strictEqual(!0,e.isEditable()),a.strictEqual('if(cidrmatch("192.0.0.0/16", clientip), "local", "other")',e.expression),a.strictEqual(1,Object.keys(e.outputFields).length),a.strictEqual(1,e.outputFieldNames().length);var f=e.outputFields.new_field;a.ok(f),a.strictEqual("My New Field",f.displayName);var g=d.sr3mc8o3mjr;a.ok(g),a.strictEqual("event1",g.owner),a.same(["event1"],g.lineage),a.strictEqual("Lookup",g.type),a.ok(g.isLookup()),a.ok(!g.isEval()),a.ok(!g.isGeoIP()),a.ok(!g.isRex()),a.strictEqual(null,g.comment),a.strictEqual(!0,g.isEditable()),a.same({lookupField:"a_lookup_field",inputField:"host"},g.inputFieldMappings),a.strictEqual(2,Object.keys(g.inputFieldMappings).length),a.strictEqual("a_lookup_field",g.inputFieldMappings.lookupField),a.strictEqual("host",g.inputFieldMappings.inputField),a.strictEqual("dnslookup",g.lookupName);var i=d.a5v1k82ymic;a.ok(i),a.strictEqual("event1",i.owner),a.same(["event1"],i.lineage),a.strictEqual("Rex",i.type),a.ok(i.isRex()),a.ok(!i.isLookup()),a.ok(!i.isEval()),a.ok(!i.isGeoIP()),a.strictEqual(2,i.outputFieldNames().length),a.strictEqual("_raw",i.inputField),a.strictEqual(" From: (?<from>.*) To: (?<to>.*) ",i.expression);var j=d.pbe9bd0rp4;a.ok(j),a.strictEqual("event1",j.owner),a.same(["event1"],j.lineage),a.strictEqual("GeoIP",j.type),a.ok(j.isGeoIP()),a.ok(!j.isLookup()),a.ok(!j.isEval()),a.ok(!j.isRex()),a.strictEqual("·Ä©·öô‡Øµ comment of pbe9bd0rp4",j.comment),a.strictEqual(5,j.outputFieldNames().length),a.strictEqual("output_from_reverse_hostname",j.inputField),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - run queries":function(a){if(this.skip){a.done();return}var b,c=this;g.chain([function(a){c.dataModels.fetch(a)},function(a,c){var d=a.item("internal_audit_logs");b=d.objectByName("searches"),b.startSearch({},"",c)},function(a,b){h.pollUntil(a,function(b){return a.properties().isDone},10,b)},function(b,c){a.strictEqual("| datamodel internal_audit_logs searches search",b.properties().request.search),b.cancel(c)},function(a,c){b.startSearch({status_buckets:5,enable_lookups:!1},"| head 3",c)},function(a,b){h.pollUntil(a,function(b){return a.properties().isDone},10,b)},function(b,c){a.strictEqual("| datamodel internal_audit_logs searches search | head 3",b.properties().request.search),b.cancel(c)}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - baseSearch is parsed correctly":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/model_with_multiple_types.json"))}catch(c){a.ok(!c),a.done()}var h="delete-me-"+j(),i,k=this;g.chain([function(a){k.dataModels.create(h,b,a)},function(b,c){i=b.objectByName("search1"),a.ok(i),a.ok(i instanceof d.Service.DataModelObject),a.strictEqual("BaseSearch",i.parentName),a.ok(i.isBaseSearch()),a.ok(!i.isBaseTransaction()),a.strictEqual("search index=_internal | head 10",i.baseSearch),c()}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - baseTransaction is parsed correctly":function(a){if(this.skip){a.done();return}var b;try{b=JSON.parse(f.readFile(e,"../data/model_with_multiple_types.json"))}catch(c){a.ok(!c),a.done()}var h="delete-me-"+j(),i,k=this;g.chain([function(a){k.dataModels.create(h,b,a)},function(b,c){i=b.objectByName("transaction1"),a.ok(i),a.ok(i instanceof d.Service.DataModelObject),a.strictEqual("BaseTransaction",i.parentName),a.ok(i.isBaseTransaction()),a.ok(!i.isBaseSearch()),a.same(["event1"],i.objectsToGroup),a.same(["host","from"],i.groupByFields),a.strictEqual("25s",i.maxPause),a.strictEqual("100m",i.maxSpan),c()}],function(b){a.ok(!b),a.done()})}},"Pivot tests":{setUp:function(a){this.service=b,this.dataModels=b.dataModels({owner:"nobody",app:"search"}),this.skip=!1;var c=this;this.service.serverInfo(function(b,e){parseInt(e.properties().version.split(".")[0],10)<6&&(c.skip=!0,d.Logger.log("Skipping pivot tests...")),a(b)})},"Callback#Pivot - test constructor args":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){a.ok(b.objectByName("test_data")),c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test acceleration, then pivot":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){b.objectByName("test_data"),a.ok(b),b.acceleration.enabled=!0,b.acceleration.earliestTime="-2mon",b.acceleration.cronSchedule="0 */12 * * *",b.update(c)},function(b,c){var d=b.properties();a.strictEqual(!0,b.isAccelerated()),a.strictEqual(!0,!!b.acceleration.enabled),a.strictEqual("-2mon",b.acceleration.earliest_time),a.strictEqual("0 */12 * * *",b.acceleration.cron_schedule);var e=b.objectByName("test_data"),f=e.createPivotSpecification();a.strictEqual(e.dataModel.name,f.accelerationNamespace);var g="delete-me-"+j();f.setAccelerationJob(g),a.strictEqual("sid="+g,f.accelerationNamespace);var h="delete-me-"+j();f.accelerationNamespace=h,a.strictEqual(h,f.accelerationNamespace),f.addCellValue("test_data","Source Value","count").run(c)},function(b,c,d){a.ok(b),a.ok(c),a.notStrictEqual("FAILED",b.properties().dispatchState),b.track({},function(b){a.ok(c.tstatsSearch),a.strictEqual(0,b.properties().request.search.indexOf("| tstats")),a.strictEqual("| tstats",b.properties().request.search.match("^\\| tstats")[0]),a.strictEqual(1,b.properties().request.search.match("^\\| tstats").length),a.strictEqual(c.tstatsSearch,b.properties().request.search),d(null,b)})},function(b,c){a.ok(b),c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test illegal filtering (all types)":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d);var e=d.createPivotSpecification();try{e.addFilter(j(),"boolean","=",!0),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add filter on a nonexistent field.")}try{e.addFilter("_time","boolean","=",!0),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add boolean filter on _time because it is of type timestamp")}try{e.addFilter("has_boris","string","contains","abc"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add string filter on has_boris because it is of type boolean")}try{e.addFilter(j(),"string","contains","abc"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add filter on a nonexistent field.")}try{e.addFilter("has_boris","ipv4","startsWith","192.168"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add ipv4 filter on has_boris because it is of type boolean")}try{e.addFilter(j(),"ipv4","startsWith","192.168"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add filter on a nonexistent field.")}try{e.addFilter("has_boris","number","atLeast",2.3),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add number filter on has_boris because it is of type boolean")}try{e.addFilter(j(),"number","atLeast",2.3),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add filter on a nonexistent field.")}try{e.addLimitFilter("has_boris","host","DEFAULT",50,"count"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add limit filter on has_boris because it is of type boolean")}try{e.addLimitFilter(j(),"host","DEFAULT",50,"count"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot add limit filter on a nonexistent field.")}try{e.addLimitFilter("source","host","DEFAULT",50,"sum"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Stats function for fields of type string must be COUNT or DISTINCT_COUNT; found sum")}try{e.addLimitFilter("epsilon","host","DEFAULT",50,"duration"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Stats function for fields of type number must be one of COUNT, DISTINCT_COUNT, SUM, or AVERAGE; found duration")}try{e.addLimitFilter("test_data","host","DEFAULT",50,"list"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Stats function for fields of type object count must be COUNT; found list")}c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test boolean filtering":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d);var e=d.createPivotSpecification();try{e.addFilter("has_boris","boolean","=",!0),a.strictEqual(1,e.filters.length);var f=e.filters[0];a.ok(f.hasOwnProperty("fieldName")),a.ok(f.hasOwnProperty("type")),a.ok(f.hasOwnProperty("comparator")),a.ok(f.hasOwnProperty("compareTo")),a.ok(f.hasOwnProperty("owner")),a.strictEqual("has_boris",f.fieldName),a.strictEqual("boolean",f.type),a.strictEqual("=",f.comparator),a.strictEqual(!0,f.compareTo),a.strictEqual("test_data",f.owner)}catch(g){a.ok(!1)}c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test string filtering":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d);var e=d.createPivotSpecification();try{e.addFilter("host","string","contains","abc"),a.strictEqual(1,e.filters.length);var f=e.filters[0];a.ok(f.hasOwnProperty("fieldName")),a.ok(f.hasOwnProperty("type")),a.ok(f.hasOwnProperty("comparator")),a.ok(f.hasOwnProperty("compareTo")),a.ok(f.hasOwnProperty("owner")),a.strictEqual("host",f.fieldName),a.strictEqual("string",f.type),a.strictEqual("contains",f.comparator),a.strictEqual("abc",f.compareTo),a.strictEqual("BaseEvent",f.owner)}catch(g){a.ok(!1)}c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test IPv4 filtering":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d);var e=d.createPivotSpecification();try{e.addFilter("hostip","ipv4","startsWith","192.168"),a.strictEqual(1,e.filters.length);var f=e.filters[0];a.ok(f.hasOwnProperty("fieldName")),a.ok(f.hasOwnProperty("type")),a.ok(f.hasOwnProperty("comparator")),a.ok(f.hasOwnProperty("compareTo")),a.ok(f.hasOwnProperty("owner")),a.strictEqual("hostip",f.fieldName),a.strictEqual("ipv4",f.type),a.strictEqual("startsWith",f.comparator),a.strictEqual("192.168",f.compareTo),a.strictEqual("test_data",f.owner)}catch(g){a.ok(!1)}c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test number filtering":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d);var e=d.createPivotSpecification();try{e.addFilter("epsilon","number",">=",2.3),a.strictEqual(1,e.filters.length);var f=e.filters[0];a.ok(f.hasOwnProperty("fieldName")),a.ok(f.hasOwnProperty("type")),a.ok(f.hasOwnProperty("comparator")),a.ok(f.hasOwnProperty("compareTo")),a.ok(f.hasOwnProperty("owner")),a.strictEqual("epsilon",f.fieldName),a.strictEqual("number",f.type),a.strictEqual(">=",f.comparator),a.strictEqual(2.3,f.compareTo),a.strictEqual("test_data",f.owner)}catch(g){a.ok(!1)}c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test limit filtering":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d);var e=d.createPivotSpecification();try{e.addLimitFilter("epsilon","host","ASCENDING",500,"average"),a.strictEqual(1,e.filters.length);var f=e.filters[0];a.ok(f.hasOwnProperty("fieldName")),a.ok(f.hasOwnProperty("type")),a.ok(f.hasOwnProperty("owner")),a.ok(f.hasOwnProperty("attributeName")),a.ok(f.hasOwnProperty("attributeOwner")),a.ok(f.hasOwnProperty("limitType")),a.ok(f.hasOwnProperty("limitAmount")),a.ok(f.hasOwnProperty("statsFn")),a.strictEqual("epsilon",f.fieldName),a.strictEqual("number",f.type),a.strictEqual("test_data",f.owner),a.strictEqual("host",f.attributeName),a.strictEqual("BaseEvent",f.attributeOwner),a.strictEqual("lowest",f.limitType),a.strictEqual(500,f.limitAmount),a.strictEqual("average",f.statsFn)}catch(g){a.ok(!1)}c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test row split":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d);var e=d.createPivotSpecification();try{e.addRowSplit("has_boris","Wrong type here"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Field was of type "+d.fieldByName("has_boris").type+", expected number or string.")}var g=j();try{e.addRowSplit(g,"Break Me!"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Did not find field "+g)}e.addRowSplit("epsilon","My Label"),a.strictEqual(1,e.rows.length);var h=e.rows[0];a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(h.hasOwnProperty("label")),a.ok(h.hasOwnProperty("display")),a.strictEqual("epsilon",h.fieldName),a.strictEqual("test_data",h.owner),a.strictEqual("number",h.type),a.strictEqual("My Label",h.label),a.strictEqual("all",h.display),a.same({fieldName:"epsilon",owner:"test_data",type:"number",label:"My Label",display:"all"},h),e.addRowSplit("host","My Label"),a.strictEqual(2,e.rows.length),h=e.rows[e.rows.length-1],a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(h.hasOwnProperty("label")),a.ok(!h.hasOwnProperty("display")),a.strictEqual("host",h.fieldName),a.strictEqual("BaseEvent",h.owner),a.strictEqual("string",h.type),a.strictEqual("My Label",h.label),a.same({fieldName:"host",owner:"BaseEvent",type:"string",label:"My Label"},h);try{e.addRangeRowSplit("has_boris","Wrong type here",{start:0,end:100,step:20,limit:5})}catch(f){a.ok(f),a.strictEqual(f.message,"Field was of type "+d.fieldByName("has_boris").type+", expected number.")}try{e.addRangeRowSplit(g,"Break Me!",{start:0,end:100,step:20,limit:5}),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Did not find field "+g)}e.addRangeRowSplit("epsilon","My Label",{start:0,end:100,step:20,limit:5}),a.strictEqual(3,e.rows.length),h=e.rows[e.rows.length-1],a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(h.hasOwnProperty("label")),a.ok(h.hasOwnProperty("display")),a.ok(h.hasOwnProperty("ranges")),a.strictEqual("epsilon",h.fieldName),a.strictEqual("test_data",h.owner),a.strictEqual("number",h.type),a.strictEqual("My Label",h.label),a.strictEqual("ranges",h.display);var i={start:0,end:100,size:20,maxNumberOf:5};a.same(i,h.ranges),a.same({fieldName:"epsilon",owner:"test_data",type:"number",label:"My Label",display:"ranges",ranges:i},h);try{e.addBooleanRowSplit("epsilon","Wrong type here","t","f")}catch(f){a.ok(f),a.strictEqual(f.message,"Field was of type "+d.fieldByName("epsilon").type+", expected boolean.")}try{e.addBooleanRowSplit(g,"Break Me!","t","f"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Did not find field "+g)}e.addBooleanRowSplit("has_boris","My Label","is_true","is_false"),a.strictEqual(4,e.rows.length),h=e.rows[e.rows.length-1],a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(h.hasOwnProperty("label")),a.ok(h.hasOwnProperty("trueLabel")),a.ok(h.hasOwnProperty("falseLabel")),a.strictEqual("has_boris",h.fieldName),a.strictEqual("My Label",h.label),a.strictEqual("test_data",h.owner),a.strictEqual("boolean",h.type),a.strictEqual("is_true",h.trueLabel),a.strictEqual("is_false",h.falseLabel),a.same({fieldName:"has_boris",label:"My Label",owner:"test_data",type:"boolean",trueLabel:"is_true",falseLabel:"is_false"},h);try{e.addTimestampRowSplit("epsilon","Wrong type here","some binning")}catch(f){a.ok(f),a.strictEqual(f.message,"Field was of type "+d.fieldByName("epsilon").type+", expected timestamp.")}try{e.addTimestampRowSplit(g,"Break Me!","some binning"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Did not find field "+g)}try{e.addTimestampRowSplit("_time","some label","Bogus binning value"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Invalid binning Bogus binning value found. Valid values are: "+e._binning.join(", "))}e.addTimestampRowSplit("_time","My Label","day"),a.strictEqual(5,e.rows.length),h=e.rows[e.rows.length-1],a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(h.hasOwnProperty("label")),a.ok(h.hasOwnProperty("period")),a.strictEqual("_time",h.fieldName),a.strictEqual("My Label",h.label),a.strictEqual("BaseEvent",h.owner),a.strictEqual("timestamp",h.type),a.strictEqual("day",h.period),a.same({fieldName:"_time",label:"My Label",owner:"BaseEvent",type:"timestamp",period:"day"},h),c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test column split":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d);var e=d.createPivotSpecification();try{e.addColumnSplit("has_boris","Wrong type here"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Field was of type "+d.fieldByName("has_boris").type+", expected number or string.")}var g=j();try{e.addColumnSplit(g,"Break Me!"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Did not find field "+g)}e.addColumnSplit("epsilon"),a.strictEqual(1,e.columns.length);var h=e.columns[e.columns.length-1];a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(h.hasOwnProperty("display")),a.strictEqual("epsilon",h.fieldName),a.strictEqual("test_data",h.owner),a.strictEqual("number",h.type),a.strictEqual("all",h.display),a.same({fieldName:"epsilon",owner:"test_data",type:"number",display:"all"},h),e.addColumnSplit("host"),a.strictEqual(2,e.columns.length),h=e.columns[e.columns.length-1],a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(!h.hasOwnProperty("display")),a.strictEqual("host",h.fieldName),a.strictEqual("BaseEvent",h.owner),a.strictEqual("string",h.type),a.same({fieldName:"host",owner:"BaseEvent",type:"string"},h),c();try{e.addRangeColumnSplit("has_boris","Wrong type here",{start:0,end:100,step:20,limit:5})}catch(f){a.ok(f),a.strictEqual(f.message,"Field was of type "+d.fieldByName("has_boris").type+", expected number.")}try{e.addRangeColumnSplit(g,{start:0,end:100,step:20,limit:5}),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Did not find field "+g)}e.addRangeColumnSplit("epsilon",{start:0,end:100,step:20,limit:5}),a.strictEqual(3,e.columns.length),h=e.columns[e.columns.length-1],a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(h.hasOwnProperty("display")),a.ok(h.hasOwnProperty("ranges")),a.strictEqual("epsilon",h.fieldName),a.strictEqual("test_data",h.owner),a.strictEqual("number",h.type),a.strictEqual("ranges",h.display);var i={start:"0",end:"100",size:"20",maxNumberOf:"5"};a.same(i,h.ranges),a.same({fieldName:"epsilon",owner:"test_data",type:"number",display:"ranges",ranges:i},h);try{e.addBooleanColumnSplit("epsilon","t","f")}catch(f){a.ok(f),a.strictEqual(f.message,"Field was of type "+d.fieldByName("epsilon").type+", expected boolean.")}try{e.addBooleanColumnSplit(g,"t","f"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Did not find field "+g)}e.addBooleanColumnSplit("has_boris","is_true","is_false"),a.strictEqual(4,e.columns.length),h=e.columns[e.columns.length-1],a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(!h.hasOwnProperty("label")),a.ok(h.hasOwnProperty("trueLabel")),a.ok(h.hasOwnProperty("falseLabel")),a.strictEqual("has_boris",h.fieldName),a.strictEqual("test_data",h.owner),a.strictEqual("boolean",h.type),a.strictEqual("is_true",h.trueLabel),a.strictEqual("is_false",h.falseLabel),a.same({fieldName:"has_boris",owner:"test_data",type:"boolean",trueLabel:"is_true",falseLabel:"is_false"},h);try{e.addTimestampColumnSplit("epsilon","Wrong type here")}catch(f){a.ok(f),a.strictEqual(f.message,"Field was of type "+d.fieldByName("epsilon").type+", expected timestamp.")}try{e.addTimestampColumnSplit(g,"Break Me!"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Did not find field "+g)}try{e.addTimestampColumnSplit("_time","Bogus binning value"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Invalid binning Bogus binning value found. Valid values are: "+e._binning.join(", "))}e.addTimestampColumnSplit("_time","day"),a.strictEqual(5,e.columns.length),h=e.columns[e.columns.length-1],a.ok(h.hasOwnProperty("fieldName")),a.ok(h.hasOwnProperty("owner")),a.ok(h.hasOwnProperty("type")),a.ok(!h.hasOwnProperty("label")),a.ok(h.hasOwnProperty("period")),a.strictEqual("_time",h.fieldName),a.strictEqual("BaseEvent",h.owner),a.strictEqual("timestamp",h.type),a.strictEqual("day",h.period),a.same({fieldName:"_time",owner:"BaseEvent",type:"timestamp",period:"day"},h)}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test cell value":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d);var e=d.createPivotSpecification();try{e.addCellValue("iDontExist","Break Me!","explosion"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Did not find field iDontExist")}try{e.addCellValue("source","Wrong Stats Function","stdev"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Stats function on string and IPv4 fields must be one of: list, distinct_values, first, last, count, or distinct_count; found stdev")}e.addCellValue("source","Source Value","dc"),a.strictEqual(1,e.cells.length);var g=e.cells[e.cells.length-1];a.ok(g.hasOwnProperty("fieldName")),a.ok(g.hasOwnProperty("owner")),a.ok(g.hasOwnProperty("type")),a.ok(g.hasOwnProperty("label")),a.ok(g.hasOwnProperty("value")),a.ok(g.hasOwnProperty("sparkline")),a.strictEqual("source",g.fieldName),a.strictEqual("BaseEvent",g.owner),a.strictEqual("string",g.type),a.strictEqual("Source Value",g.label),a.strictEqual("dc",g.value),a.strictEqual(!1,g.sparkline),a.same({fieldName:"source",owner:"BaseEvent",type:"string",label:"Source Value",value:"dc",sparkline:!1},g);try{e.addCellValue("hostip","Wrong Stats Function","stdev"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Stats function on string and IPv4 fields must be one of: list, distinct_values, first, last, count, or distinct_count; found stdev")}e.addCellValue("hostip","Source Value","dc"),a.strictEqual(2,e.cells.length),g=e.cells[e.cells.length-1],a.ok(g.hasOwnProperty("fieldName")),a.ok(g.hasOwnProperty("owner")),a.ok(g.hasOwnProperty("type")),a.ok(g.hasOwnProperty("label")),a.ok(g.hasOwnProperty("value")),a.ok(g.hasOwnProperty("sparkline")),a.strictEqual("hostip",g.fieldName),a.strictEqual("test_data",g.owner),a.strictEqual("ipv4",g.type),a.strictEqual("Source Value",g.label),a.strictEqual("dc",g.value),a.strictEqual(!1,g.sparkline),a.same({fieldName:"hostip",owner:"test_data",type:"ipv4",label:"Source Value",value:"dc",sparkline:!1},g);try{e.addCellValue("has_boris","Booleans not allowed","sum"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Cannot use boolean valued fields as cell values.")}try{e.addCellValue("epsilon","Wrong Stats Function","latest"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Stats function on number field must be must be one of: sum, count, average, max, min, stdev, list, or distinct_values; found latest")}e.addCellValue("epsilon","Source Value","average"),a.strictEqual(3,e.cells.length),g=e.cells[e.cells.length-1],a.ok(g.hasOwnProperty("fieldName")),a.ok(g.hasOwnProperty("owner")),a.ok(g.hasOwnProperty("type")),a.ok(g.hasOwnProperty("label")),a.ok(g.hasOwnProperty("value")),a.ok(g.hasOwnProperty("sparkline")),a.strictEqual("epsilon",g.fieldName),a.strictEqual("test_data",g.owner),a.strictEqual("number",g.type),a.strictEqual("Source Value",g.label),a.strictEqual("average",g.value),a.strictEqual(!1,g.sparkline),a.same({fieldName:"epsilon",owner:"test_data",type:"number",label:"Source Value",value:"average",sparkline:!1},g);try{e.addCellValue("_time","Wrong Stats Function","max"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Stats function on timestamp field must be one of: duration, earliest, latest, list, or distinct values; found max")}e.addCellValue("_time","Source Value","earliest"),a.strictEqual(4,e.cells.length),g=e.cells[e.cells.length-1],a.ok(g.hasOwnProperty("fieldName")),a.ok(g.hasOwnProperty("owner")),a.ok(g.hasOwnProperty("type")),a.ok(g.hasOwnProperty("label")),a.ok(g.hasOwnProperty("value")),a.ok(g.hasOwnProperty("sparkline")),a.strictEqual("_time",g.fieldName),a.strictEqual("BaseEvent",g.owner),a.strictEqual("timestamp",g.type),a.strictEqual("Source Value",g.label),a.strictEqual("earliest",g.value),a.strictEqual(!1,g.sparkline),a.same({fieldName:"_time",owner:"BaseEvent",type:"timestamp",label:"Source Value",value:"earliest",sparkline:!1},g);try{e.addCellValue("test_data","Wrong Stats Function","min"),a.ok(!1)}catch(f){a.ok(f),a.strictEqual(f.message,"Stats function on childcount and objectcount fields must be count; found min")}e.addCellValue("test_data","Source Value","count"),a.strictEqual(5,e.cells.length),g=e.cells[e.cells.length-1],a.ok(g.hasOwnProperty("fieldName")),a.ok(g.hasOwnProperty("owner")),a.ok(g.hasOwnProperty("type")),a.ok(g.hasOwnProperty("label")),a.ok(g.hasOwnProperty("value")),a.ok(g.hasOwnProperty("sparkline")),a.strictEqual("test_data",g.fieldName),a.strictEqual("test_data",g.owner),a.strictEqual("objectCount",g.type),a.strictEqual("Source Value",g.label),a.strictEqual("count",g.value),a.strictEqual(!1,g.sparkline),a.same({fieldName:"test_data",owner:"test_data",type:"objectCount",label:"Source Value",value:"count",sparkline:!1},g),c()}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test pivot throws HTTP exception":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var h=this;g.chain([function(a){h.dataModels.create(b,c,a)},function(b,c){var d=b.objectByName("test_data");a.ok(d),d.createPivotSpecification().pivot(c)},function(b,c){a.ok(!1)}],function(b){a.ok(b);var c="In handler 'datamodelpivot': Error in 'PivotReport': Must have non-empty cells or non-empty rows.";a.ok(f.endsWith(b.message,c)),a.done()})},"Callback#Pivot - test pivot with simple namespace":function(a){if(this.skip){a.done();return}var b="delete-me-"+j(),c;try{c=JSON.parse(f.readFile(e,"../data/data_model_for_pivot.json"))}catch(d){a.ok(!d),a.done()}var i=this,k,l,m;g.chain([function(a){i.dataModels.create(b,c,a)},function(b,c){k=b.objectByName("test_data"),a.ok(k),k.createLocalAccelerationJob(null,c)},function(b,c){m=b,a.ok(b),l=k.createPivotSpecification(),l.addBooleanRowSplit("has_boris","Has Boris","meep","hilda"),l.addCellValue("hostip","Distinct IPs","count"),l.setAccelerationJob(b),a.strictEqual("string",typeof l.accelerationNamespace),a.strictEqual("sid="+b.sid,l.accelerationNamespace),l.setAccelerationJob(b.sid),a.strictEqual("string",typeof l.accelerationNamespace),a.strictEqual("sid="+b.sid,l.accelerationNamespace),l.pivot(c)},function(b,c){a.ok(b.tstatsSearch),a.ok(b.tstatsSearch.length>0),a.strictEqual(0,b.tstatsSearch.indexOf("| tstats")),a.strictEqual("| tstats",b.tstatsSearch.match("^\\| tstats")[0]),a.strictEqual(1,b.tstatsSearch.match("^\\| tstats").length),b.run(c)},function(a,b){h.pollUntil(a,function(b){return a.properties().isDone},10,b)},function(b,c){a.ok("FAILED"!==b.properties().dispatchState),a.strictEqual(0,b.properties().request.search.indexOf("| tstats")),a.strictEqual("| tstats",b.properties().request.search.match("^\\| tstats")[0]),a.strictEqual(1,b.properties().request.search.match("^\\| tstats").length),m.cancel(c)}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test pivot column range split":function(a){if(this.skip){a.done();return}var b=this,c;g.chain([function(a){b.dataModels.fetch(a)},function(a,b){var c=a.item("internal_audit_logs"),d=c.objectByName("searches"),e=d.createPivotSpecification();e.addRowSplit("user","Executing user"),e.addRangeColumnSplit("exec_time",{start:0,end:12,step:5,limit:4}),e.addCellValue("search","Search Query","values"),e.pivot(b)},function(a,b){c=a.tstatsSearch||a.pivotSearch,a.run(b)},function(a,b){h.pollUntil(a,function(b){return a.properties().isDone},10,b)},function(b,d){a.notStrictEqual("FAILED",b.properties().dispatchState),a.strictEqual(c,b.properties().request.search),b.cancel(d)}],function(b){a.ok(!b),a.done()})},"Callback#Pivot - test pivot with PivotSpecification.run and Job.track":function(a){if(this.skip){a.done();return}var b=this;g.chain([function(a){b.dataModels.fetch(a)},function(a,b){var c=a.item("internal_audit_logs"),d=c.objectByName("searches"),e=d.createPivotSpecification();e.addRowSplit("user","Executing user"),e.addRangeColumnSplit("exec_time",{start:0,end:12,step:5,limit:4}),e.addCellValue("search","Search Query","values"),e.run({},b)},function(b,c,d){b.track({},function(b){a.strictEqual(c.tstatsSearch||c.pivotSearch,b.properties().request.search),d(null,b)})},function(b,c){a.notStrictEqual("FAILED",b.properties().dispatchState),b.cancel(c)}],function(b){a.ok(!b),a.done()})},"Callback#DataModels - delete any remaining data models created by the SDK tests":function(a){if(this.skip){a.done();return}b.dataModels().fetch(function(b,c){b&&a.ok(!b);var d=c.list();g.seriesEach(d,function(a,b,c){f.startsWith(a.name,"delete-me")?a.remove(c):c()},function(b){a.ok(!b),a.done()})})}},"App Tests":{setUp:function(a){this.service=b,a()},"Callback#list applications":function(a){var b=this.service.apps();b.fetch(function(b,c){var d=c.list();a.ok(d.length>0),a.done()})},"Callback#contains applications":function(a){var b=this.service.apps();b.fetch(function(b,c){var d=c.item("search");a.ok(d),a.done()})},"Callback#create + contains app":function(a){var b="jssdk_testapp_"+j(),c=this.service.apps();c.create({name:b},function(b,d){var e=d.name;c.fetch(function(b,c){var f=c.item(e);a.ok(f),d.remove(function(){a.done()})})})},"Callback#create + modify app":function(a){var b="TEST DESCRIPTION",c="1.1",d="jssdk_testapp_"+j(),e=this.service.apps();g.chain([function(a){e.create({name:d},a)},function(e,f){a.ok(e),a.strictEqual(e.name,d),a.strictEqual(e.properties().version,"1.0"),e.update({description:b,version:c},f)},function(d,e){a.ok(d);var f=d.properties();a.strictEqual(f.description,b),a.strictEqual(f.version,c),d.remove(e)}],function(b){a.ok(!b),a.done()})},"Callback#delete test applications":function(a){var b=this.service.apps();b.fetch(function(b,c){var d=c.list();g.parallelEach(d,function(a,b,c){f.startsWith(a.name,"jssdk_")?a.remove(c):c()},function(b){a.ok(!b),a.done()})})},"list applications with cookies as authentication":function(a){this.service.serverInfo(function(c,e){var h=parseInt(e.properties().version.split(".")[0],10),i=parseInt(e.properties().version.split(".")[1],10);if(h<6||h===6&&i<2){d.Logger.log("Skipping cookie test..."),a.done();return}var j=new d.Service({scheme:b.scheme,host:b.host,port:b.port,username:b.username,password:b.password,version:b.version}),k=new d.Service({scheme:b.scheme,host:b.host,port:b.port,version:b.version});g.chain([function(a){j.login(a)},function(b,c){var d=j.http._cookieStore;a.ok(!f.isEmpty(d)),k.http._cookieStore=d;var e=k.apps();e.fetch(c)},function(b,c){var d=b.list();a.ok(d.length>0),a.ok(!f.isEmpty(k.http._cookieStore)),c()}],function(b){a.ok(!b),a.done()})})}},"Saved Search Tests":{setUp:function(a){this.service=b,this.loggedOutService=c,a()},"Callback#list":function(a){var b=this.service.savedSearches();b.fetch(function(b,c){var d=c.list();a.ok(d.length>0);for(var e=0;e<d.length;e++)a.ok(d[e]);a.done()})},"Callback#contains":function(a){var b=this.service.savedSearches();b.fetch(function(b,c){var d=c.item("Indexing workload");a.ok(d),a.done()})},"Callback#suppress":function(a){var b=this.service.savedSearches();b.fetch(function(b,c){var d=c.item("Indexing workload");a.ok(d),d.suppressInfo(function(b,c,d){a.ok(!b),a.done()})})},"Callback#list limit count":function(a){var b=this.service.savedSearches();b.fetch({count:2},function(b,c){var d=c.list();a.strictEqual(d.length,2);for(var e=0;e<d.length;e++)a.ok(d[e]);a.done()})},"Callback#list filter":function(a){var b=this.service.savedSearches();b.fetch({search:"Error"},function(b,c){var d=c.list();a.ok(d.length>0);for(var e=0;e<d.length;e++)a.ok(d[e]);a.done()})},"Callback#list offset":function(a){var b=this.service.savedSearches();b.fetch({offset:2,count:1},function(b,c){var d=c.list();a.strictEqual(c.paging().offset,2),a.strictEqual(c.paging().perPage,1),a.strictEqual(d.length,1);for(var e=0;e<d.length;e++)a.ok(d[e]);a.done()})},"Callback#create + modify + delete saved search":function(a){var b="jssdk_savedsearch",c="search * | head 1",d="search * | head 10",e="description",h=this.service.savedSearches({owner:this.service.username,app:"sdk-app-collection"});g.chain([function(a){h.create({search:c,name:b},a)},function(e,f){a.ok(e),a.strictEqual(e.name,b),a.strictEqual(e.properties().search,c),a.ok(!e.properties().description),e.update({search:d},f)},function(c,f){a.ok(c),a.ok(c),a.strictEqual(c.name,b),a.strictEqual(c.properties().search,d),a.ok(!c.properties().description),c.update({description:e},f)},function(c,f){a.ok(c),a.ok(c),a.strictEqual(c.name,b),a.strictEqual(c.properties().search,d),a.strictEqual(c.properties().description,e),c.fetch(f)},function(b,c){a.ok(b.fields().optional.length>1),a.ok(f.indexOf(b.fields().optional,"disabled")>-1),b.remove(c)}],function(b){a.ok(!b),a.done()})},"Callback#dispatch error":function(a){var b="jssdk_savedsearch_"+j(),c="search index=_internal | head 1",e=new d.Service.SavedSearch(this.loggedOutService,b,{owner:"nobody",app:"search"});e.dispatch(function(b){a.ok(b),a.done()})},"Callback#dispatch omitting optional arguments":function(a){var b="jssdk_savedsearch_"+j(),c="search index=_internal | head 1",d=this.service.savedSearches({owner:this.service.username,app:"sdk-app-collection"});g.chain([function(a){d.create({search:c,name:b},a)},function(d,e){a.ok(d),a.strictEqual(d.name,b),a.strictEqual(d.properties().search,c),a.ok(!d.properties().description),d.dispatch(e)},function(b,c,d){a.ok(b),a.ok(c),a.done()}])},"Callback#history error":function(a){var b="jssdk_savedsearch_"+j(),c="search index=_internal | head 1",e=new d.Service.SavedSearch(this.loggedOutService,b,{owner:"nobody",app:"search",sharing:"system"});e.history(function(b){a.ok(b),a.done()})},"Callback#Update error":function(a){var b="jssdk_savedsearch_"+j(),c="search index=_internal | head 1",e=new d.Service.SavedSearch(this.loggedOutService,b,{owner:"nobody",app:"search",sharing:"system"});e.update({},function(b){a.ok(b),a.done()})},"Callback#oneshot requires search string":function(a){a.throws(function(){this.service.oneshotSearch({name:"jssdk_oneshot_"+j()},function(a){})}),a.done()},"Callback#Create + dispatch + history":function(a){var b="jssdk_savedsearch_"+j(),c="search index=_internal | head 1",d=this.service.savedSearches({owner:this.service.username,app:"sdk-app-collection"});g.chain(function(a){d.create({search:c,name:b},a)},function(d,e){a.ok(d),a.strictEqual(d.name,b),a.strictEqual(d.properties().search,c),a.ok(!d.properties().description),d.dispatch({force_dispatch:!1,"dispatch.buckets":295},e)},function(b,c,d){a.ok(b),a.ok(c),h.pollUntil(b,function(a){return b.properties().isDone},10,g.augment(d,c))},function(b,c,d){a.strictEqual(b.properties().statusBuckets,295),c.history(g.augment(d,b))},function(b,c,d,e){a.ok(b),a.ok(b.length>0),a.ok(c),a.ok(d);var f=function(a){return function(b){a.cancel(b)}},h=!1,i=[];for(var j=0;j<b.length;j++)i.push(f(b[j])),h=h||b[j].sid===d.sid;a.ok(h),c.remove(function(a){a?e(a):g.parallel(i,e)})},function(b){a.ok(!b),a.done()})},"Callback#job events fails":function(a){var b=new d.Service.Job(this.loggedOutService,"abc",{});b.events({},function(b){a.ok(b),a.done()})},"Callback#job preview fails":function(a){var b=new d.Service.Job(this.loggedOutService,"abc",{});b.preview({},function(b){a.ok(b),a.done()})},"Callback#job results fails":function(a){var b=new d.Service.Job(this.loggedOutService,"abc",{});b.results({},function(b){a.ok(b),a.done()})},"Callback#job searchlog fails":function(a){var b=new d.Service.Job(this.loggedOutService,"abc",{});b.searchlog(function(b){a.ok(b),a.done()})},"Callback#job summary fails":function(a){var b=new d.Service.Job(this.loggedOutService,"abc",{});b.summary({},function(b){a.ok(b),a.done()})},"Callback#job timeline fails":function(a){var b=new d.Service.Job(this.loggedOutService,"abc",{});b.timeline({},function(b){a.ok(b),a.done()})},"Callback#delete test saved searches":function(a){var b=this.service.savedSearches({owner:this.service.username,app:"sdk-app-collection"});b.fetch(function(b,c){var d=c.list();g.parallelEach(d,function(a,b,c){f.startsWith(a.name,"jssdk_")?a.remove(c):c()},function(b){a.ok(!b),a.done()})})},"Callback#setupInfo fails":function(a){var b=new d.Service.Application(this.loggedOutService,"search");b.setupInfo(function(b,c,d){a.ok(b),a.done()})},"Callback#setupInfo succeeds":function(a){var b=new d.Service.Application(this.service,"sdk-app-collection");b.setupInfo(function(b,c,e){a.ok(b.data.messages[0].text.match("Setup configuration file does not")),d.Logger.log("ERR ---",b.data.messages[0].text),a.done()})},"Callback#updateInfo":function(a){var b=new d.Service.Application(this.service,"search");b.updateInfo(function(b,c,d){a.ok(!b),a.ok(d),a.strictEqual(d.name,"search"),a.done()})},"Callback#updateInfo failure":function(a){var b=new d.Service.Application(this.loggedOutService,"sdk-app-collection");b.updateInfo(function(b,c,d){a.ok(b),a.done()})}},"Fired Alerts Tests":{setUp:function(a){this.service=b,this.loggedOutService=c;var d=this.service.indexes();a()},"Callback#create + verify emptiness + delete new alert group":function(a){var b=this.service.savedSearches({owner:this.service.username}),c="jssdk_savedsearch_alert_"+j(),d={name:c,search:"index=_internal | head 1",alert_type:"always","alert.severity":"2","alert.suppress":"0","alert.track":"1","dispatch.earliest_time":"-1h","dispatch.latest_time":"now",is_scheduled:"1",cron_schedule:"* * * * *"};g.chain([function(a){b.create(d,a)},function(b,c){a.ok(b),a.strictEqual(b.alertCount(),0),b.history(c)},function(c,d,e){a.strictEqual(c.length,0),a.strictEqual(d.firedAlertGroup().count(),0),b.service.firedAlertGroups().fetch(g.augment(e,d))},function(b,c,d){a.strictEqual(b.list().indexOf(c.name),-1),d(null,c)},function(a,b){a.remove(b)}],function(b){a.ok(!b),a.done()})},"Callback#delete all alerts":function(a){var b="jssdk_savedsearch_alert_",c=this.service.savedSearches().list();g.parallelEach(c,function(a,c,e){f.startsWith(a.name,b)?(d.Logger.log("ALERT ---",a.name),a.remove(e)):e()},function(b){a.ok(!b),a.done()})}},"Properties Tests":{setUp:function(a){this.service=b,a()},"Callback#list":function(a){var b=this,c={owner:"admin",app:"search"};g.chain([function(a){b.service.configurations(c).fetch(a)},function(b,c){var d=b.list();a.ok(d.length>0),c()}],function(b){a.ok(!b),a.done()})},"Callback#item":function(a){var b=this,c={owner:"admin",app:"search"};g.chain([function(a){b.service.configurations(c).fetch(a)},function(b,c){var d=b.item("web");a.ok(d),d.fetch(c)},function(b,c){a.strictEqual(b.name,"web"),c()}],function(b){a.ok(!b),a.done()})},"Callback#contains stanza":function(a){var b=this,c={owner:"admin",app:"search"};g.chain([function(a){b.service.configurations(c).fetch(a)},function(b,c){var d=b.item("web");a.ok(d),d.fetch(c)},function(b,c){a.strictEqual(b.name,"web");var d=b.item("settings");a.ok(d),d.fetch(c)},function(b,c){a.ok(b.properties().hasOwnProperty("httpport")),c()}],function(b){a.ok(!b),a.done()})},"Callback#create file + create stanza + update stanza":function(a){var c=this,e="jssdk_file_"+j(),f="barfoo_"+j(),h={owner:"admin",app:"search"};g.chain([function(a){var b=c.service.configurations(h);b.fetch(a)},function(a,b){a.create(e,b)},function(a,b){a.create("stanza",b)},function(a,b){a.update({jssdk_foobar:f},b)},function(b,c){a.strictEqual(b.properties().jssdk_foobar,f),c()},function(a){var c=new d.Service.ConfigurationFile(b,e);c.fetch(a)},function(b,c){var d=b.item("stanza");a.ok(d),d.remove(c)}],function(b){a.ok(!b),a.done()})}},"Configuration Tests":{setUp:function(a){this.service=b,a()},"Callback#list":function(a){var b=this,c={owner:"admin",app:"search"};g.chain([function(a){b.service.configurations(c).fetch(a)},function(b,c){var d=b.list();a.ok(d.length>0),c()}],function(b){a.ok(!b),a.done()})},"Callback#contains":function(a){var b=this,c={owner:"admin",app:"search"};g.chain([function(a){b.service.configurations(c).fetch(a)},function(b,c){var d=b.item("web");a.ok(d),d.fetch(c)},function(b,c){a.strictEqual(b.name,"web"),c()}],function(b){a.ok(!b),a.done()})},"Callback#contains stanza":function(a){var b=this,c={owner:"admin",app:"search"};g.chain([function(a){b.service.configurations(c).fetch(a)},function(b,c){var d=b.item("web");a.ok(d),d.fetch(c)},function(b,c){a.strictEqual(b.name,"web");var d=b.item("settings");a.ok(d),d.fetch(c)},function(b,c){a.ok(b.properties().hasOwnProperty("httpport")),c()}],function(b){a.ok(!b),a.done()})},"Callback#configurations init":function(a){a.throws(function(){var a=new d.Service.Configurations(this.service,{owner:"-",app:"-",sharing:"system"})}),a.done()},"Callback#create file + create stanza + update stanza":function(a){var c=this,e={owner:"nobody",app:"system"},f="jssdk_file_"+j(),h="barfoo_"+j();g.chain([function(a){var c=b.configurations(e);c.fetch(a)},function(a,b){a.create({__conf:f},b)},function(a,b){a.item("stanza")&&a.item("stanza").remove(),a.create("stanza",b)},function(a,b){a.update({jssdk_foobar:h},b)},function(b,c){a.strictEqual(b.properties().jssdk_foobar,h),c()},function(a){var c=new d.Service.ConfigurationFile(b,f);c.fetch(a)},function(b,c){var d=b.item("stanza");a.ok(d),d.remove(c)}],function(b){a.ok(!b),a.done()})},"Callback#can get default stanza":function(a){var b=this,c={owner:"admin",app:"search"};g.chain([function(a){b.service.configurations(c).fetch(a)},function(b,d){var e=b.item("savedsearches");a.strictEqual(c,e.namespace),a.ok(e),e.fetch(d)},function(b,d){a.strictEqual(c,b.namespace),b.getDefaultStanza().fetch(d)},function(b,d){a.strictEqual(b.name,"default"),a.strictEqual(c,b.namespace),d()}],function(b){a.ok(!b),a.done()})},"Callback#updating default stanza is noop":function(a){var b=this,c={owner:"admin",app:"search"},d=null,e="this won't work";g.chain([function(a){b.service.configurations(c).fetch(a)},function(b,d){var e=b.item("savedsearches");a.strictEqual(c,e.namespace),a.ok(e),e.fetch(d)},function(b,d){a.strictEqual(c,b.namespace),b.getDefaultStanza().fetch(d)},function(b,f){a.ok(b._properties.hasOwnProperty("max_concurrent")),a.strictEqual(c,b.namespace),d=b._properties.max_concurrent,b.update({max_concurrent:e},f)},function(b,c){a.ok(b.properties().hasOwnProperty("max_concurrent")),a.strictEqual(b.properties().max_concurrent,d),a.notStrictEqual(b.properties().max_concurrent,e),b.fetch(c)},function(b,c){a.ok(b.properties().hasOwnProperty("max_concurrent")),a.strictEqual(b.properties().max_concurrent,d),a.notStrictEqual(b.properties().max_concurrent,e),c()}],function(b){a.ok(!b),a.done()})}},"Storage Passwords Tests":{setUp:function(a){this.service=b,a()},"Callback#Create":function(a){var b=-1,c="delete-me-"+j(),d="delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c,realm:d,password:"changeme"},e)},function(b,f){a.strictEqual(c,b.properties().username),a.strictEqual(d+":"+c+":",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual(d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(c,d,e){a.strictEqual(b+1,c.list().length),d.remove(e)},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Create with backslashes":function(a){var b=-1,c="\\delete-me-"+j(),d="\\delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c,realm:d,password:"changeme"},e)},function(b,f){a.strictEqual(c,b.properties().username),a.strictEqual("\\"+d+":\\"+c+":",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual(d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(c,d,e){a.strictEqual(b+1,c.list().length),d.remove(e)},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Create with slashes":function(a){var b=-1,c="/delete-me-"+j(),d="/delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c,realm:d,password:"changeme"},e)},function(b,f){a.strictEqual(c,b.properties().username),a.strictEqual(d+":"+c+":",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual(d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(c,d,e){a.strictEqual(b+1,c.list().length),d.remove(e)},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Create without realm":function(a){var b=-1,c="delete-me-"+j(),d=this;g.chain([function(a){d.service.storagePasswords().fetch(a)},function(a,d){b=a.list().length,a.create({name:c,password:"changeme"},d)},function(b,e){a.strictEqual(c,b.properties().username),a.strictEqual(":"+c+":",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual("",b.properties().realm),d.service.storagePasswords().fetch(g.augment(e,b))},function(c,d,e){a.strictEqual(b+1,c.list().length),d.remove(e)},function(a){d.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Create should fail without user, or realm":function(a){var b=this;g.chain([function(a){b.service.storagePasswords().fetch(a)},function(a,b){a.create({name:null,password:"changeme"},b)}],function(b){a.ok(b),a.done()})},"Callback#Create should fail without password":function(a){var b=this;g.chain([function(a){b.service.storagePasswords().fetch(a)},function(a,b){a.create({name:"something",password:null},b)}],function(b){a.ok(b),a.done()})},"Callback#Create should fail without user, realm, or password":function(a){var b=this;g.chain([function(a){b.service.storagePasswords().fetch(a)},function(a,b){a.create({name:null,password:null},b)}],function(b){a.ok(b),a.done()})},"Callback#Create with colons":function(a){var b=-1,c=":delete-me-"+j(),d=":delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c,realm:d,password:"changeme"},e)},function(b,f){a.strictEqual(c,b.properties().username),a.strictEqual("\\"+d+":\\"+c+":",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual(d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(c,d,e){a.strictEqual(b+1,c.list().length),d.remove(e)},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Create crazy":function(a){var b=-1,c="delete-me-"+j(),d="delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c+":end!@#$%^&*()_+{}:|<>?",realm:":start::!@#$%^&*()_+{}:|<>?"+d,password:"changeme"},e)},function(b,f){a.strictEqual(c+":end!@#$%^&*()_+{}:|<>?",b.properties().username),a.strictEqual("\\:start\\:\\:!@#$%^&*()_+{}\\:|<>?"+d+":"+c+"\\:end!@#$%^&*()_+{}\\:|<>?:",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual(":start::!@#$%^&*()_+{}:|<>?"+d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(c,d,e){a.strictEqual(b+1,c.list().length),d.remove(e)},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Create with unicode chars":function(a){var b=-1,c="delete-me-"+j(),d="delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c+":end!@#$%^&*()_+{}:|<>?쎼 and 쎶 and &lt;&amp;&gt; für",realm:":start::!@#$%^&*()_+{}:|<>?"+encodeURIComponent("쎼 and 쎶 and &lt;&amp;&gt; für")+d,password:decodeURIComponent(encodeURIComponent("쎼 and 쎶 and &lt;&amp;&gt; für"))},e)},function(b,f){a.strictEqual(c+":end!@#$%^&*()_+{}:|<>?쎼 and 쎶 and &lt;&amp;&gt; für",b.properties().username),a.strictEqual("\\:start\\:\\:!@#$%^&*()_+{}\\:|<>?"+encodeURIComponent("쎼 and 쎶 and &lt;&amp;&gt; für")+d+":"+c+"\\:end!@#$%^&*()_+{}\\:|<>?쎼 and 쎶 and &lt;&amp;&gt; für:",b.name),a.strictEqual(decodeURIComponent(encodeURIComponent("쎼 and 쎶 and &lt;&amp;&gt; für")),b.properties().clear_password),a.strictEqual(":start::!@#$%^&*()_+{}:|<>?"+encodeURIComponent("쎼 and 쎶 and &lt;&amp;&gt; für")+d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(c,d,e){a.strictEqual(b+1,c.list().length),d.remove(e)},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Read":function(a){var b=-1,c="delete-me-"+j(),d="delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c,realm:d,password:"changeme"},e)},function(b,f){a.strictEqual(c,b.properties().username),a.strictEqual(d+":"+c+":",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual(d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(e,f,g){try{a.ok(!!e.item(d+":"+c+":"))}catch(h){a.ok(!1)}var i=e.list(),j=!1;a.strictEqual(b+1,i.length);for(var k=0;k<i.length;k++)d+":"+c+":"===i[k].name&&(j=!0);a.ok(j),f.remove(g)},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Read with slashes":function(a){var b=-1,c="/delete-me-"+j(),d="/delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c,realm:d,password:"changeme"},e)},function(b,f){a.strictEqual(c,b.properties().username),a.strictEqual(d+":"+c+":",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual(d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(e,f,g){try{a.ok(!!e.item(d+":"+c+":"))}catch(h){a.ok(!1)}var i=e.list(),j=!1;a.strictEqual(b+1,i.length);for(var k=0;k<i.length;k++)d+":"+c+":"===i[k].name&&(j=!0);a.ok(j),f.remove(g)},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Update":function(a){var b=-1,c="delete-me-"+j(),d="delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c,realm:d,password:"changeme"},e)},function(b,f){a.strictEqual(c,b.properties().username),a.strictEqual(d+":"+c+":",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual(d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(c,d,e){a.strictEqual(b+1,c.list().length),d.update({password:"changed"},e)},function(b,f){a.strictEqual(c,b.properties().username),a.strictEqual(d+":"+c+":",b.name),a.strictEqual("changed",b.properties().clear_password),a.strictEqual(d,b.properties().realm),e.service.storagePasswords().fetch(f)},function(e,f){var g=e.list(),h=!1,i=-1;a.strictEqual(b+1,g.length);for(var j=0;j<g.length;j++)d+":"+c+":"===g[j].name&&(h=!0,i=j,a.strictEqual(c,g[j].properties().username),a.strictEqual(d+":"+c+":",g[j].name),a.strictEqual("changed",g[j].properties().clear_password),a.strictEqual(d,g[j].properties().realm));a.ok(h),h?g[i].remove(f):f(new Error("Didn't find the created password"))},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})},"Callback#Delete":function(a){var b=-1,c="delete-me-"+j(),d="delete-me-"+j(),e=this;g.chain([function(a){e.service.storagePasswords().fetch(a)},function(a,e){b=a.list().length,a.create({name:c,realm:d,password:"changeme"},e)},function(b,f){a.strictEqual(c,b.properties().username),a.strictEqual(d+":"+c+":",b.name),a.strictEqual("changeme",b.properties().clear_password),a.strictEqual(d,b.properties().realm),e.service.storagePasswords().fetch(g.augment(f,b))},function(c,d,e){a.strictEqual(b+1,c.list().length),d.remove(e)},function(a){e.service.storagePasswords().fetch(a)},function(e,f){a.strictEqual(b,e.list().length),e.create({name:c,realm:d,password:"changeme"},f)},function(b,d){a.strictEqual(c,b.properties().username),e.service.storagePasswords().fetch(d)},function(e,f){a.strictEqual(b+1,e.list().length);var g=e.list(),h=!1,i=-1;a.strictEqual(b+1,g.length);for(var j=0;j<g.length;j++)d+":"+c+":"===g[j].name&&(h=!0,i=j,a.strictEqual(c,g[j].properties().username),a.strictEqual(d+":"+c+":",g[j].name),a.strictEqual("changeme",g[j].properties().clear_password),a.strictEqual(d,g[j].properties().realm));a.ok(h),h?g[i].remove(f):f(new Error("Didn't find the created password"))},function(a){e.service.storagePasswords().fetch(a)},function(c,d){a.strictEqual(b,c.list().length),d()}],function(b){a.ok(!b),a.done()})}},"Index Tests":{setUp:function(a){this.service=b,this.loggedOutService=c;var d=this.indexName="sdk-tests",e=this.service.indexes();e.create(d,{},function(b,c){if(b&&b.status!==409)throw new Error("Index creation failed for an unknown reason");a()})},"Callback#remove index fails on Splunk 4.x":function(a){var b=this.service.version;this.service.version="4.0";var c=this.service.indexes().item(this.indexName);a.throws(function(){c.remove(function(a){})}),this.service.version=b,a.done()},"Callback#remove index":function(a){var b=this.service.indexes(),c=Math.floor(Math.random()*65536),e=this.indexName+"-"+c;if(this.service.versionCompare("5.0")<0){d.Logger.info("","Must be running Splunk 5.0+ for this test to work."),a.done();return}g.chain([function(a){b.create(e,{},a)},function(a,b){a.remove(b)},function(a){var c=50,d=100;g.whilst(function(){return b.item(e)&&c-->0},function(a){g.sleep(d,function(){b.fetch(a)})},function(b){b?a(b):a(c<=0?"Timed out":null)})}],function(b){a.ok(!b),a.done()})},"Callback#list indexes":function(a){var b=this.service.indexes();b.fetch(function(b,c){var d=c.list();a.ok(d.length>0),a.done()})},"Callback#contains index":function(a){var b=this.service.indexes(),c=this.indexName;b.fetch(function(b,d){var e=d.item(c);a.ok(e),a.done()})},"Callback#modify index":function(a){var b=this.indexName,c=this.service.indexes(),d=!1;g.chain([function(a){c.fetch(a)},function(c,e){var f=c.item(b);a.ok(f),d=f.properties().syncMeta,f.update({syncMeta:!d},e)},function(b,c){a.ok(b);var e=b.properties();a.strictEqual(!d,e.syncMeta),b.update({syncMeta:!e.syncMeta},c)},function(b,c){a.ok(b);var e=b.properties();a.strictEqual(d,e.syncMeta),c()}],function(b){a.ok(!b),a.done()})},"Callback#Enable+disable index":function(a){var b=this.indexName,c=this.service.indexes();g.chain([function(a){c.fetch(a)},function(c,d){var e=c.item(b);a.ok(e),e.disable(d)},function(b,c){a.ok(b),b.fetch(c)},function(b,c){a.ok(b),a.ok(b.properties().disabled),b.enable(c)},function(b,c){a.ok(b),b.fetch(c)},function(b,c){a.ok(b),a.ok(!b.properties().disabled),c()}],function(b){a.ok(!b),a.done()})},"Callback#Service submit event":function(a){var b="Hello World -- "+j(),c="sdk-tests",d=this.service,e=this.indexName;g.chain(function(a){d.log(b,{sourcetype:c,index:e},a)},function(d,f){a.ok(d),a.strictEqual(d.sourcetype,c),a.strictEqual(d.bytes,b.length),a.strictEqual(d.index,e),f()},function(b){a.ok(!b),a.done()})},"Callback#Service submit event, omitting optional arguments":function(a){var b="Hello World -- "+j(),c="sdk-tests",d=this.service,e=this.indexName;g.chain(function(a){d.log(b,a)},function(c,d){a.ok(c),a.strictEqual(c.bytes,b.length),d()},function(b){a.ok(!b),a.done()})},"Callback#Service submit events with multi-byte chars":function(a){var b=this.service,c=["Ummelner Straße 6","Ümmelner Straße 6","Iԉｔéｒԉáｔíòлåɭìƶåｔｉòл","Iｎｔéｒｎâｔì߀лàɭíƶɑｔïòл","ãϻéｔ ｄòｎｅｒ ｔｕｒƙëｙ ѵ߀ｌù","ｐｔãｔｅ ìԉ ｒëρｒèｈëｎԁéｒｉｔ ","ϻ߀ｌɭｉｔ ｆìɭèｔ ϻìǥｎｏԉ ɭäｂ߀ｒíѕ"," êӽ ｃɦùｃｋ ｃüｐïᏧåｔåｔ Ꮷèѕëｒｕлｔ. ","D߀ɭｏｒ ѵéｌíｔ ìｒｕｒè, ｓèᏧ ѕｈòｒ","ｔ ｒｉƅѕ ｃ߀ɰ ɭãｎԁյàéɢêｒ ｄｒúｍｓｔ","íｃƙ. Mｉｎïｍ ƃàɭｌ ｔｉｐ ѕհòｒｔ ｒìƃѕ,"," ïԁ ａɭïｑúìρ ѕɦàｎƙ ρ߀ｒｃɦéｔｔɑ. Pìǥ"," ｈãｍ ɦòｃｋ ìлｃíｄíԁùԉｔ ｓéԁ ｃüｐïϻ ","ƙèｖｉл ｌáｂｏｒê. Eｔ ｔａｉɭ ѕｔｒｉρ"," ｓｔｅáｋ úｔ üｌｌãϻｃ߀ ｒｕｍｐ ｄ߀ɭｏｒｅ.","٩(͡๏̯͡๏)۶ ٩(-̮̮̃•̃).","Lɑƅòｒé ƃｒëｓãòｌá ｄ߀лèｒ ѕâｌáｍí ","ｃíｌｌûｍ ìｎ ѕɯìлｅ ϻêàｔɭ߀àｆ ｄûìｓ ","ρãｎｃｅｔｔä ƅｒìｓƙéｔ ԁèｓêｒûлｔ áúｔè"," յòɰɭ. Lɑｂòｒìѕ ƙìêɭ","ｂáｓá ԁòｌòｒé ｆａｔƃɑｃｋ ƅêéｆ. Pɑѕｔｒ","äｍì ｐｉɢ ѕհàлƙ ùɭɭａｍｃò ѕａû","ѕäǥë ｓɦàｎƙｌë."," Cúｐíｍ ɭäƃｏｒｕｍ ｄｒｕｍｓｔïｃƙ ｊｅｒｋϒ ｖｅｌｉ"," ｐïｃåԉɦɑ ƙíéɭƅãｓａ. Aｌïｑû","ｉρ íｒüｒë ｃûｐíϻ, äɭìɋｕâ ǥｒòûлｄ ","ｒｏúлᏧ ｔｏԉｇüè ρàｒìãｔùｒ ","ｂｒｉѕｋèｔ ԉｏｓｔｒｕᏧ ｃûɭｐɑ"," ìｄ ｃòлѕèｑûâｔ ｌàƅ߀ｒìｓ."],d=0;g.seriesMap(c,function(a,c,e){d++,b.log(a,e)},function(b,e){a.ok(!b),a.strictEqual(d,c.length);for(var f in c){a.notStrictEqual(c[f].length,e[f].bytes);try{a.strictEqual(Buffer.byteLength(c[f]),e[f].bytes)}catch(b){a.strictEqual(decodeURI(encodeURIComponent(c[f])).length,e[f].bytes)}}a.done()})},"Callback#Service submit event, failure":function(a){var b="Hello World -- "+j(),c="sdk-tests",d=this.loggedOutService,e=this.indexName;g.chain(function(c){a.ok(d),d.log(b,c)},function(b){a.ok(b),a.done()})},"Callback#remove throws an error":function(a){var b=this.service.indexes().item("_internal");a.throws(function(){b.remove()}),a.done()},"Callback#create an index with alternate argument format":function(a){var b=this.service.indexes();b.create({name:"_internal"},function(b,c){a.ok(b.data.messages[0].text.match("name=_internal already exists")),a.done()})},"Callback#Index submit event with omitted optional arguments":function(a){var b="Hello world -- "+j(),c=this.indexName,d=this.service.indexes();g.chain([function(a){d.fetch(a)},function(d,e){var f=d.item(c);a.ok(f),a.strictEqual(f.name,c),f.submitEvent(b,e)},function(d,e,f){a.ok(d),a.strictEqual(d.bytes,b.length),a.strictEqual(d.index,c),f()}],function(b){a.ok(!b),a.done()})},"Callback#Index submit event":function(a){var b="Hello World -- "+j(),c="sdk-tests",d=this.indexName,e=this.service.indexes();g.chain([function(a){e.fetch(a)},function(e,f){var g=e.item(d);a.ok(g),a.strictEqual(g.name,d),g.submitEvent(b,{sourcetype:c},f)},function(e,f,g){a.ok(e),a.strictEqual(e.sourcetype,c),a.strictEqual(e.bytes,b.length),a.strictEqual(e.index,d),g()}],function(b){a.ok(!b),a.done()})}},"User Tests":{setUp:function(a){this.service=b,this.loggedOutService=c,a()},tearDown:function(a){this.service.logout(a)},"Callback#Current user":function(a){var b=this.service;b.currentUser(function(c,d){a.ok(!c),a.ok(d),a.strictEqual(d.name,b.username),a.done()})},"Callback#Current user fails":function(a){var b=this.loggedOutService;b.currentUser(function(b,c){a.ok(b),a.done()})},"Callback#List users":function(a){var b=this.service;b.users().fetch(function(b,c){var d=c.list();a.ok(!b),a.ok(c),a.ok(d),a.ok(d.length>0),a.done()})},"Callback#create user failure":function(a){this.loggedOutService.users().create({name:"jssdk_testuser",password:"abc",roles:"user"},function(b,c){a.ok(b),a.done()})},"Callback#Create + update + delete user":function(a){var b=this.service,c="jssdk_testuser";g.chain([function(a){b.users().create({name:"jssdk_testuser",password:"abc",roles:"user"},a)},function(b,d){a.ok(b),a.strictEqual(b.name,c),a.strictEqual(b.properties().roles.length,1),a.strictEqual(b.properties().roles[0],"user"),b.update({realname:"JS SDK",roles:["admin","user"]},d)},function(b,c){a.ok(b),a.strictEqual(b.properties().realname,"JS SDK"),a.strictEqual(b.properties().roles.length,2),a.strictEqual(b.properties().roles[0],"admin"),a.strictEqual(b.properties().roles[1],"user"),b.remove(c)}],function(b){a.ok(!b),a.done()})},"Callback#Roles":function(a){var b=this.service,c="jssdk_testuser_"+j();g.chain([function(a){b.users().create({name:c,password:"abc",roles:"user"},a)},function(b,d){a.ok(b),a.strictEqual(b.name,c),a.strictEqual(b.properties().roles.length,1),a.strictEqual(b.properties().roles[0],"user"),b.update({roles:["admin","user"]},d)},function(b,c){a.ok(b),a.strictEqual(b.properties().roles.length,2),a.strictEqual(b.properties().roles[0],"admin"),a.strictEqual(b.properties().roles[1],"user"),b.update({roles:"user"},c)},function(b,c){a.ok(b),a.strictEqual(b.properties().roles.length,1),a.strictEqual(b.properties().roles[0],"user"),b.update({roles:"__unknown__"},c)}],function(b){a.ok(b),a.strictEqual(b.status,400),a.done()})},"Callback#Passwords":function(a){var b=this.service,c=null,e="jssdk_testuser_"+j();g.chain([function(a){b.users().create({name:e,password:"abc",roles:"user"},a)},function(f,h){a.ok(f),a.strictEqual(f.name,e),a.strictEqual(f.properties().roles.length,1),a.strictEqual(f.properties().roles[0],"user"),c=new d.Service(b.http,{username:e,password:"abc",host:b.host,port:b.port,scheme:b.scheme,version:b.version}),c.login(g.augment(h,f))},function(b,c,d){a.ok(b),a.ok(c),c.update({password:"abc2"},d)},function(b,d){c.login(function(c,e){a.ok(c),a.ok(!e),b.update({password:"abc"},d)})},function(b,d){a.ok(b),c.login(d)}],function(b){a.ok(!b),a.done()})},"Callback#delete test users":function(a){var b=this.service.users();b.fetch(function(b,c){var d=c.list();g.parallelEach(d,function(a,b,c){f.startsWith(a.name,"jssdk_")?a.remove(c):c()},function(b){a.ok(!b),a.done()})})}},"Server Info Tests":{setUp:function(a){this.service=b,a()},"Callback#Basic":function(a){var b=this.service;b.serverInfo(function(b,c){a.ok(!b),a.ok(c),a.strictEqual(c.name,"server-info"),a.ok(c.properties().hasOwnProperty("version")),a.ok(c.properties().hasOwnProperty("serverName")),a.ok(c.properties().hasOwnProperty("os_version")),a.done()})}},"View Tests":{setUp:function(a){this.service=b,a()},"Callback#List views":function(a){var b=this.service;b.views({owner:"admin",app:"search"}).fetch(function(b,c){a.ok(!b),a.ok(c);var d=c.list();a.ok(d),a.ok(d.length>0);for(var e=0;e<d.length;e++)a.ok(d[e]);a.done()})},"Callback#Create + update + delete view":function(a){var b=this.service,c="jssdk_testview",d="<view/>",e="<view isVisible='false'></view>";g.chain([function(a){b.views({owner:"admin",app:"sdk-app-collection"}).create({name:c,"eai:data":d},a)},function(b,f){a.ok(b),a.strictEqual(b.name,c),a.strictEqual(b.properties()["eai:data"],d),b.update({"eai:data":e},f)},function(b,c){a.ok(b),a.strictEqual(b.properties()["eai:data"],e),b.remove(c)}],function(b){a.ok(!b),a.done()})}},"Parser Tests":{setUp:function(a){this.service=b,a()},"Callback#Basic parse":function(a){var b=this.service;b.parse("search index=_internal | head 1",function(b,c){a.ok(!b),a.ok(c),a.ok(c.commands.length>0),a.done()})},"Callback#Parse error":function(a){var b=this.service;b.parse("ABCXYZ",function(b,c){a.ok(b),a.strictEqual(b.status,400),a.done()})}},"Typeahead Tests":{setUp:function(a){this.service=b,this.loggedOutService=c,a()},"Callback#Typeahead failure":function(a){var b=this.loggedOutService;b.typeahead("index=",1,function(b,c){a.ok(b),a.done()})},"Callback#Basic typeahead":function(a){var b=this.service;b.typeahead("index=",1,function(b,c){a.ok(!b),a.ok(c),a.strictEqual(c.length,1),a.ok(c[0]),a.done()})},"Typeahead with omitted optional arguments":function(a){var b=this.service;b.typeahead("index=",function(b,c){a.ok(!b),a.ok(c),a.done()})}},"Endpoint Tests":{setUp:function(a){this.service=b,a()},"Throws on null arguments to init":function(a){var b=this.service;a.throws(function(){var a=new d.Service.Endpoint(null,"a/b")}),a.throws(function(){var a=new d.Service.Endpoint(b,null)}),a.done()},"Endpoint delete on a relative path":function(a){var b=this.service,c=new d.Service.Endpoint(b,"/search/jobs/12345");c.del("search/jobs/12345",{},function(){a.done()})},"Methods of Resource to be overridden":function(a){var b=this.service,c=new d.Service.Resource(b,"/search/jobs/12345");a.throws(function(){c.path()}),a.throws(function(){c.fetch()}),a.ok(d.Utils.isEmpty(c.state())),a.done()}},"Entity tests":{setUp:function(a){this.service=b,this.loggedOutService=c,a()},"Accessors function properly":function(a){var b=new d.Service.Entity(this.service,"/search/jobs/12345",{owner:"boris",app:"factory",sharing:"app"});b._load({acl:{owner:"boris",app:"factory",sharing:"app"},links:{link1:35},published:"meep",author:"Hilda"}),a.ok(b.acl().owner==="boris"),a.ok(b.acl().app==="factory"),a.ok(b.acl().sharing==="app"),a.ok(b.links().link1===35),a.strictEqual(b.author(),"Hilda"),a.strictEqual(b.published(),"meep"),a.done()},"Refresh throws error correctly":function(a){var b=new d.Service.Entity(this.loggedOutService,"/search/jobs/12345",{owner:"boris",app:"factory",sharing:"app"});b.fetch({},function(b){a.ok(b),a.done()})},"Cannot update name of entity":function(a){var b=new d.Service.Entity(this.service,"/search/jobs/12345",{owner:"boris",app:"factory",sharing:"app"});a.throws(function(){b.update({name:"asdf"})}),a.done()},"Disable throws error correctly":function(a){var b=new d.Service.Entity(this.loggedOutService,"/search/jobs/12345",{owner:"boris",app:"factory",sharing:"app"});b.disable(function(b){a.ok(b),a.done()})},"Enable throws error correctly":function(a){var b=new d.Service.Entity(this.loggedOutService,"/search/jobs/12345",{owner:"boris",app:"factory",sharing:"app"});b.enable(function(b){a.ok(b),a.done()})},"Does reload work?":function(a){var b=new d.Service.Index(this.service,"data/indexes/sdk-test",{owner:"admin",app:"search",sharing:"app"}),c="jssdk_testapp_"+j(),e=this.service.apps(),f=this;g.chain(function(a){e.create({name:c},a)},function(b,c){b.reload(function(d){a.ok(!d),c(null,b)})},function(b,c){var e=new d.Service.Application(f.loggedOutService,b.name);e.reload(function(d){a.ok(d),c(null,b)})},function(a,b){a.remove(b)},function(b){a.ok(!b),a.done()})}},"Collection tests":{setUp:function(a){this.service=b,this.loggedOutService=c,a()},"Methods to be overridden throw":function(a){var b=new d.Service.Collection(this.service,"/data/indexes",{owner:"admin",app:"search",sharing:"app"});a.throws(function(){b.instantiateEntity({})}),a.done()},"Accessors work":function(a){var b=new d.Service.Collection(this.service,"/data/indexes",{owner:"admin",app:"search",sharing:"app"});b._load({links:"Hilda",updated:!0}),a.strictEqual(b.links(),"Hilda"),a.ok(b.updated()),a.done()},"Contains throws without a good id":function(a){var b=new d.Service.Collection(this.service,"/data/indexes",{owner:"admin",app:"search",sharing:"app"});a.throws(function(){b.item(null)}),a.done()}}};return k};if(b===a.main){var f=a("../index"),g=a("../examples/node/cmdline"),h=a("../contrib/nodeunit/test_reporter"),i=g.create(),j=i.parse(process.argv);if(!j)throw new Error("Error in parsing command line parameters");if(!process.env.SPLUNK_HOME)throw new Error("$PATH variable SPLUNK_HOME is not set. Please export SPLUNK_HOME to the splunk instance.");var k=new f.Service({scheme:j.opts.scheme,host:j.opts.host,port:j.opts.port,username:j.opts.username,password:j.opts.password,version:j.opts.version}),l=new f.Service({scheme:j.opts.scheme,host:j.opts.host,port:j.opts.port,username:j.opts.username,password:j.opts.password+"wrong",version:j.opts.version}),m=c.setup(k,l);k.login(function(a,b){if(a||!b)throw new Error("Login failed - not running tests",a||"");h.run([{Tests:m}])})}}),require.define("/tests/test_examples.js",function(a,b,c,d,e){c.setup=function(b,c){var d=a("../index"),e=d.Async;d.Logger.setLevel("ALL");var f=0,g=function(){return"id"+f++ +"_"+(new Date).valueOf()},h=["program","script"];return{"Hello World Tests":{Apps:function(b){var d=a("../examples/node/helloworld/apps").main;d(c,b.done)},"Apps#Async":function(b){var d=a("../examples/node/helloworld/apps_async").main;d(c,b.done)},"Pivot#Async":function(b){var d=a("../examples/node/helloworld/pivot_async").main;d(c,b.done)},"Fired Alerts":function(b){var d=a("../examples/node/helloworld/firedalerts").main;d(c,b.done)},"Fired Alerts#Async":function(b){var d=a("../examples/node/helloworld/firedalerts_async").main;d(c,b.done)},"Fired Alerts#Create":function(b){var d=a("../examples/node/helloworld/firedalerts_create").main;d(c,b.done)},"Fired Alerts#Delete":function(b){var d=a("../examples/node/helloworld/firedalerts_delete").main;d(c,b.done)},"Get Job by sid":function(b){var d=a("../examples/node/helloworld/get_job").main;d(c,b.done)},"Endpoint Instantiation":function(b){var d=a("../examples/node/helloworld/endpoint_instantiation").main;d(c,b.done)},"Saved Searches":function(b){var d=a("../examples/node/helloworld/savedsearches").main;d(c,b.done)},"Saved Searches#Async":function(b){var d=a("../examples/node/helloworld/savedsearches_async").main;d(c,b.done)},"Saved Searches#Delete":function(b){var d=a("../examples/node/helloworld/savedsearches_delete").main;d(c,b.done)},"Saved Searches#Create":function(b){var d=a("../examples/node/helloworld/savedsearches_create").main;d(c,b.done)},"Saved Searches#Delete Again":function(b){var d=a("../examples/node/helloworld/savedsearches_delete").main;d(c,b.done)},"Search#normal":function(b){var d=a("../examples/node/helloworld/search_normal").main;d(c,b.done)},"Search#blocking":function(b){var d=a("../examples/node/helloworld/search_blocking").main;d(c,b.done)},"Search#oneshot":function(b){var d=a("../examples/node/helloworld/search_oneshot").main;d(c,b.done)},"Search#realtime":function(b){var d=a("../examples/node/helloworld/search_realtime").main;d(c,b.done)},Logging:function(b){var d=a("../examples/node/helloworld/log").main;d(c,b.done)}},"Jobs Example Tests":{setUp:function(b){var c=this;this.main=a("../examples/node/jobs").main,this.run=function(a,b,d,e){var f=h.slice();a&&f.push(a);if(b)for(var g=0;g<b.length;g++)f.push(b[g]);if(d)for(var i in d)d.hasOwnProperty(i)&&(f.push("--"+i),f.push(d[i]));return c.main(f,e)},b()},help:function(a){this.run(null,null,null,function(b){a.ok(!!b),a.done()})},"List jobs":function(a){this.run("list",null,null,function(b){a.ok(!b),a.done()})},"Create job":function(a){var b={search:"search index=_internal | head 1",id:g()},c=this;c.run("create",[],b,function(d){a.ok(!d),c.run("cancel",[b.id],null,function(b){a.ok(!b),a.done()})})},"Cancel job":function(a){var b={search:"search index=_internal | head 1",id:g()},c=this;c.run("create",[],b,function(d){a.ok(!d),c.run("cancel",[b.id],null,function(b){a.ok(!b),a.done()})})},"List job properties":function(a){var b={search:"search index=_internal | head 1",id:g()},c=this;c.run("create",[],b,function(d){a.ok(!d),c.run("list",[b.id],null,function(d){a.ok(!d),c.run("cancel",[b.id],null,function(b){a.ok(!b),a.done()})})})},"List job events":function(a){var b={search:"search index=_internal | head 1",id:g()},c=this;c.run("create",[],b,function(d){a.ok(!d),c.run("events",[b.id],null,function(d){a.ok(!d),c.run("cancel",[b.id],null,function(b){a.ok(!b),a.done()})})})},"List job preview":function(a){var b={search:"search index=_internal | head 1",id:g()},c=this;c.run("create",[],b,function(d){a.ok(!d),c.run("preview",[b.id],null,function(d){a.ok(!d),c.run("cancel",[b.id],null,function(b){a.ok(!b),a.done()})})})},"List job results":function(a){var b={search:"search index=_internal | head 1",id:g()},c=this;c.run("create",[],b,function(d){a.ok(!d),c.run("results",[b.id],null,function(d){a.ok(!d),c.run("cancel",[b.id],null,function(b){a.ok(!b),a.done()})})})},"List job results, by column":function(a){var b={search:"search index=_internal | head 1",id:g()},c=this;c.run("create",[],b,function(d){a.ok(!d),c.run("results",[b.id],{output_mode:"json_cols"},function(d){a.ok(!d),c.run("cancel",[b.id],null,function(b){a.ok(!b),a.done()})})})},"Create+list multiple jobs":function(a){var b=[];for(var c=0;c<3;c++)b[c]={search:"search index=_internal | head 1",id:g()};var d=b.map(function(a){return a.id}),f=this;e.parallelMap(b,function(b,c,d){f.run("create",[],b,function(c,e){a.ok(!c),a.ok(e),a.strictEqual(e.sid,b.id),d(null,e)})},function(c,e){for(var g=0;g<e.length;g++)a.strictEqual(b[g].id,e[g].sid);f.run("list",d,null,function(b){a.ok(!b),f.run("cancel",d,null,function(b){a.ok(!b),a.done()})})})}},"Search Example Tests":{setUp:function(b){var c=this;this.main=a("../examples/node/search").main,this.run=function(a,b,d,e){var f=h.slice();a&&f.push(a);if(b)for(var g=0;g<b.length;g++)f.push(b[g]);if(d)for(var i in d)d.hasOwnProperty(i)&&(f.push("--"+i),f.push(d[i]));return c.main(f,e)},b()},"Create regular search":function(a){var b={search:"search index=_internal | head 5"};this.run(null,null,b,function(b){a.ok(!b),a.done()})},"Create regular search with verbose":function(a){var b={search:"search index=_internal | head 5"};this.run(null,["--verbose"],b,function(b){a.ok(!b),a.done()})},"Create oneshot search":function(a){var b={search:"search index=_internal | head 5",exec_mode:"oneshot"};this.run(null,["--verbose"],b,function(b){a.ok(!b),a.done()})},"Create normal search with reduced count":function(a){var b={search:"search index=_internal | head 20",count:10};this.run(null,["--verbose"],b,function(b){a.ok(!b),a.done()})}}}};if(b===a.main){var f=a("../index"),g=a("../contrib/nodeunit/test_reporter"),h=a("../examples/node/cmdline"),i=h.create(),j=i.parse(process.argv);if(!j)throw new Error("Error in parsing command line parameters");var k=new f.Service({scheme:j.opts.scheme,host:j.opts.host,port:j.opts.port,username:j.opts.username,password:j.opts.password,version:j.opts.version}),l=c.setup(k,j.opts);k.login(function(a,b){if(a||!b)throw new Error("Login failed - not running tests",a||"");g.run([{Tests:l}])})}}),require.define("/examples/node/helloworld/apps.js",function(a,b,c,d,e){var f=a("../../../index");c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",g=a.host||"localhost",h=a.port||"8089",i=a.version||"default",j=new f.Service({username:c,password:d,scheme:e,host:g,port:h,version:i});j.login(function(a,c){if(a||!c){console.log("Error in logging in"),b(a||"Login failed");return}j.apps().fetch(function(a,c){if(a){console.log("There was an error retrieving the list of applications:",a),b(a);return}var d=c.list();console.log("Applications:");for(var e=0;e<d.length;e++){var f=d[e];console.log("  App "+e+": "+f.name)}b()})})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/apps_async.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Async;c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j});g.chain([function(a){k.login(a)},function(a,b){a||b("Error logging in"),k.apps().fetch(b)},function(a,b){var c=a.list();console.log("Applications:");for(var d=0;d<c.length;d++){var e=c[d];console.log("  App "+d+": "+e.name)}b()}],function(a){b(a)})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/pivot_async.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Async;c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j}),l;g.chain([function(a){k.login(a)},function(a,b){a||b("Error logging in"),k.dataModels().fetch(b)},function(a,b){var c=a.item("internal_audit_logs");l=c.objectByName("searches"),console.log("Working with object",l.displayName,"in model",c.displayName),console.log("\t Lineage:",l.lineage.join(" -> ")),console.log("\t Internal name: "+l.name),l.startSearch({},"| head 5",b)},function(a,b){a.track({},function(a){a.results({},b)})},function(a,b,c){console.log("Results:");for(var d=0;d<a.rows.length;d++){var e=" result "+d+":  ",f=a.rows[d];for(var g=0;g<a.fields.length;g++)f[g]!==null&&f[g]!==undefined&&(e+=a.fields[g]+"="+f[g]+", ");console.log(e),console.log("------------------------------")}var h=l.createPivotSpecification();h.addRowSplit("user","Executing user").addRangeColumnSplit("exec_time",{limit:4}).addCellValue("search","Search Query","values").run(c)},function(a,b,c){console.log("Query for binning search queries by execution time and executing user:"),console.log("\t",b.prettyQuery),a.track({},function(a){a.results({},c)})},function(a,b,c){console.log("Results:");for(var d=0;d<a.rows.length;d++){var e=" result "+d+":  ",f=a.rows[d];for(var g=0;g<a.fields.length;g++)f[g]!==null&&f[g]!==undefined&&(e+=a.fields[g]+"="+f[g]+", ");console.log(e),console.log("------------------------------")}b.cancel(c)}],function(a){a&&(console.log("ERROR",a),b(a)),b(a)})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/firedalerts.js",function(a,b,c,d,e){var f=a("../../../index");c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",g=a.host||"localhost",h=a.port||"8089",i=a.version||"default",j=new f.Service({username:c,password:d,scheme:e,host:g,port:h,version:i});j.login(function(a,c){if(a||!c){console.log("Error in logging in"),b(a||"Login failed");return}j.firedAlertGroups().fetch(function(a,c){if(a){console.log("ERROR",a),b(a);return}var d=c.list();console.log("Fired alert groups:");var e=function(a,b,c){console.log(c.name,"(Count:",c.count(),")");for(var d=0;d<b.length;d++){var e=b[d];for(var f in e.properties())e.properties().hasOwnProperty(f)&&console.log("\t",f,":",e.properties()[f]);console.log()}console.log("======================================")};for(var f in d)if(d.hasOwnProperty(f)){var g=d[f];g.list(e)}b()})})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/firedalerts_async.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Async;c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j});g.chain([function(a){k.login(a)},function(a,b){a||b("Error logging in"),k.firedAlertGroups().fetch(b)},function(a,b){var c=a.list();console.log("Fired alert groups:"),g.seriesEach(c,function(a,b,c){a.list(function(b,c){console.log(a.name,"(Count:",a.count(),")");for(var d=0;d<c.length;d++){var e=c[d];for(var f in e.properties())e.properties().hasOwnProperty(f)&&console.log("\t",f,":",e.properties()[f]);console.log()}console.log("======================================")}),c()},function(a){a&&b(a),b()})}],function(a){a&&(console.log("ERROR",a),b(a)),b(a)})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/firedalerts_create.js",function(a,b,c,d,e){var f=a("../../../index");c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",g=a.host||"localhost",h=a.port||"8089",i=a.version||"default",j=new f.Service({username:c,password:d,scheme:e,host:g,port:h,version:i});j.login(function(a,c){if(a||!c){console.log("Error in logging in"),b(a||"Login failed");return}var d={name:"My Awesome Alert",search:"index=_internal error sourcetype=splunkd* | head 10",alert_type:"always","alert.severity":"2","alert.suppress":"0","alert.track":"1","dispatch.earliest_time":"-1h","dispatch.latest_time":"now",is_scheduled:"1",cron_schedule:"* * * * *"};j.savedSearches().create(d,function(a,c){if(a&&a.status===409){console.error("ERROR: A saved search with the name '"+d.name+"' already exists"),b();return}if(a){console.error("There was an error creating the saved search:",a),b(a);return}console.log("Created saved search as alert: "+c.name),b()})})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/firedalerts_delete.js",function(a,b,c,d,e){var f=a("../../../index");c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",g=a.host||"localhost",h=a.port||"8089",i=a.version||"default",j=new f.Service({username:c,password:d,scheme:e,host:g,port:h,version:i});j.login(function(a,c){if(a||!c){console.log("Error in logging in"),b(a||"Login failed");return}var d="My Awesome Alert";j.savedSearches().fetch(function(a,c){if(a){console.log("There was an error in fetching the alerts"),b(a);return}var e=c.item(d);e?(e.remove(),console.log("Deleted alert: "+d+""),b()):(console.log("Can't delete '"+d+"' because it doesn't exist!"),b())})})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/get_job.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Async;c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j}),l;g.chain([function(a){k.login(a)},function(a,b){a||b("Error logging in"),k.search("search index=_internal | head 1",{},b)},function(a,b){l=a.sid,console.log("Created a search job with sid: "+a.sid),b()}],function(a){a||!l?(a.hasOwnProperty("data")&&a.data.hasOwnProperty("messages")?console.log(a.data.messages[0].text):console.log(a),l||console.log("Couldn't create search."),b(a)):g.chain([function(a){k.getJob(l,a)},function(a,b){console.log("Got the job with sid: "+a.sid),b()}],function(a){b(a)})})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/endpoint_instantiation.js",function(a,b,c,d,e){var f=a("../../../index");f.Service.Role=f.Service.Entity.extend({path:function(){return f.Paths.roles+"/"+encodeURIComponent(this.name)},init:function(a,b,c){this.name=b,this._super(a,this.path(),c)}}),f.Service.Roles=f.Service.Collection.extend({fetchOnEntityCreation:!0,path:function(){return f.Paths.roles},instantiateEntity:function(a){var b=f.Utils.namespaceFromProperties(a);return new f.Service.Role(this.service,a.name,b)},init:function(a,b){this._super(a,this.path(),b)}}),f.Service.prototype.roles=function(a){return new f.Service.Roles(this,a)},c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",g=a.host||"localhost",h=a.port||"8089",i=a.version||"default",j=new f.Service({username:c,password:d,scheme:e,host:g,port:h,version:i});j.login(function(a,c){if(a||!c){console.log("Error in logging in"),b(a||"Login failed");return}j.roles({user:"admin",app:"search"}).fetch(function(c,d){if(c){console.log("There was an error retrieving the list of roles:",a),b(a);return}console.log("System roles:");var e=d.list();for(var f=0;f<e.length;f++)console.log("  "+f+" "+e[f].name);b()})})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/savedsearches.js",function(a,b,c,d,e){var f=a("../../../index");c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",g=a.host||"localhost",h=a.port||"8089",i=a.version||"default",j=new f.Service({username:c,password:d,scheme:e,host:g,port:h,version:i});j.login(function(a,c){if(a||!c){console.log("Error in logging in"),b(a||"Login failed");return}j.savedSearches().fetch(function(a,c){if(a){console.log("There was an error retrieving the list of saved searches:",a),b(a);return}var d=c.list();console.log("Saved searches:");for(var e=0;e<d.length;e++){var f=d[e];console.log("  Search "+e+": "+f.name),console.log("    "+f.properties().search)}b()})})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/savedsearches_async.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Async;c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j});g.chain([function(a){k.login(a)},function(a,b){a||b("Error logging in"),k.savedSearches().fetch(b)},function(a,b){var c=a.list();console.log("Saved searches:");for(var d=0;d<c.length;d++){var e=c[d];console.log("  Search "+d+": "+e.name),console.log("    "+e.properties().search)}b()}],function(a){b(a)})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/savedsearches_delete.js",function(a,b,c,d,e){var f=a("../../../index");c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",g=a.host||"localhost",h=a.port||"8089",i=a.version||"default",j=new f.Service({username:c,password:d,scheme:e,host:g,port:h,version:i});j.login(function(a,c){if(a||!c){console.log("Error in logging in"),b(a||"Login failed");return}var d="My Awesome Saved Search";j.savedSearches().fetch(function(a,c){if(a){console.log("There was an error in fetching the saved searches"),b(a);return}var e=c.item(d);e?(e.remove(),console.log("Deleted saved search: "+d+""),b()):(console.log("Can't delete '"+d+"' because it doesn't exist!"),b())})})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/savedsearches_create.js",function(a,b,c,d,e){var f=a("../../../index");c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",g=a.host||"localhost",h=a.port||"8089",i=a.version||"default",j=new f.Service({username:c,password:d,scheme:e,host:g,port:h,version:i});j.login(function(a,c){if(a||!c){console.log("Error in logging in"),b(a||"Login failed");return}var d={name:"My Awesome Saved Search",search:"index=_internal error sourcetype=splunkd* | head 10"};j.savedSearches().create(d,function(a,c){if(a&&a.status===409){console.error("ERROR: A saved search with the name '"+d.name+"' already exists"),b();return}if(a){console.error("There was an error creating the saved search:",a),b(a);return}console.log("Created saved search: "+c.name),b()})})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/search_normal.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Async;c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j});g.chain([function(a){k.login(a)},function(a,b){a||b("Error logging in"),k.search("search index=_internal | head 3",{},b)},function(a,b){a.track({},function(a){a.results({},b)})},function(a,b,c){console.log("Job Statistics: "),console.log("  Event Count: "+b.properties().eventCount),console.log("  Disk Usage: "+b.properties().diskUsage+" bytes"),console.log("  Priority: "+b.properties().priority);var d=a.fields.indexOf("_raw"),e=a.fields.indexOf("sourcetype"),f=a.fields.indexOf("user");console.log("Results: ");for(var g=0;g<a.rows.length;g++)console.log("  Result "+g+": "),console.log("    sourcetype: "+a.rows[g][e]),console.log("    user: "+a.rows[g][f]),console.log("    _raw: "+a.rows[g][d]);b.cancel(c)}],function(a){b(a)})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/search_blocking.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Async;c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j});g.chain([function(a){k.login(a)},function(a,b){a||b("Error logging in"),k.search("search index=_internal | head 3",{exec_mode:"blocking"},b)},function(a,b){a.fetch(b)},function(a,b){console.log("Job Statistics: "),console.log("  Event Count: "+a.properties().eventCount),console.log("  Disk Usage: "+a.properties().diskUsage+" bytes"),console.log("  Priority: "+a.properties().priority),a.results({},b)},function(a,b,c){var d=a.fields.indexOf("_raw"),e=a.fields.indexOf("sourcetype"),f=a.fields.indexOf("user");console.log("Results: ");for(var g=0;g<a.rows.length;g++)console.log("  Result "+g+": "),console.log("    sourcetype: "+a.rows[g][e]),console.log("    user: "+a.rows[g][f]),console.log("    _raw: "+a.rows[g][d]);b.cancel(c)}],function(a){b(a)})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/search_oneshot.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Async;c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j});g.chain([function(a){k.login(a)},function(a,b){a||b("Error logging in"),k.oneshotSearch("search index=_internal | head 3",{},b)},function(a,b){var c=a.fields.indexOf("_raw"),d=a.fields.indexOf("sourcetype"),e=a.fields.indexOf("user");console.log("Results: ");for(var f=0;f<a.rows.length;f++)console.log("  Result "+f+": "),console.log("    sourcetype: "+a.rows[f][d]),console.log("    user: "+a.rows[f][e]),console.log("    _raw: "+a.rows[f][c]);b()}],function(a){b(a)})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/search_realtime.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Async;c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j});g.chain([function(a){k.login(a)},function(a,b){a||b("Error logging in"),k.search("search index=_internal | stats count by sourcetype",{earliest_time:"rt",latest_time:"rt"},b)},function(a,b){var c=5,d=0;g.whilst(function(){return c>d},function(b){g.sleep(1e3,function(){a.preview({},function(a,c){if(a){b(a);return}if(c&&c.rows){d++,console.log("========== Iteration "+d+" ==========");var e=c.fields.indexOf("sourcetype"),f=c.fields.indexOf("count");for(var g=0;g<c.rows.length;g++){var h=c.rows[g],i=("  "+h[e]+"                         ").slice(0,30);console.log(i+h[f])}console.log("=================================")}b()})})},function(c){a.cancel(b)})}],function(a){b(a)})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/helloworld/log.js",function(a,b,c,d,e){var f=a("../../../index"),g=f.Class.extend({init:function(a,b){this.service=a,b=b||{},this.params={},b.index&&(this.params.index=b.index),b.host&&(this.params.host=b.host),b.source&&(this.params.source=b.source),b.sourcetype&&(this.params.sourcetype=b.sourcetype||"demo-logger");if(!this.service)throw new Error("Must supply a valid service")},log:function(a){var b={__time:(new Date).toUTCString(),level:"LOG",data:a};this.service.log(b,this.params),console.log(a)},error:function(a){var b={__time:(new Date).toUTCString(),level:"ERROR",data:a};this.service.log(b,this.params),console.error(a)},info:function(a){var b={__time:(new Date).toUTCString(),level:"INFO",data:a};this.service.log(b,this.params),console.info(a)},warn:function(a){var b={__time:(new Date).toUTCString(),level:"WARN",data:a};this.service.log(b,this.params),console.warn(a)}});c.main=function(a,b){a=a||{};var c=a.username||"admin",d=a.password||"changeme",e=a.scheme||"https",h=a.host||"localhost",i=a.port||"8089",j=a.version||"default",k=new f.Service({username:c,password:d,scheme:e,host:h,port:i,version:j});k.login(function(a,c){if(a||!c){console.log("Error in logging in"),b(a||"Login failed");return}var d=new g(k,{sourcetype:"mylogger",source:"test"});d.log({hello:"world"}),d.error("ERROR HAPPENED"),d.info(["useful","info"]),d.warn({"this":{is:["a","warning"]}}),b()})},b===a.main&&c.main({},function(){})}),require.define("/examples/node/jobs.js",function(a,b,c,d,e){(function(){var d=a("../../index"),e=d.Class,f=d.Utils,g=d.Async,h=a("./cmdline"),i=["search","earliest_time","latest_time","now","time_format","exec_mode","search_mode","rt_blocking","rt_queue_size","rt_maxblocksecs","rt_indexfilter","id","status_buckets","max_count","max_time","timeout","auto_finalize_ec","enable_lookups","reload_macros","reduce_freq","spawn_process","required_field_list","rf","auto_cancel","auto_pause"],j=["offset","count","earliest_time","latest_time","search","time_format","output_time_format","field_list","f","max_lines","truncation_mode","output_mode","segmentation"],k=["offset","count","search","field_list","f","output_mode"],l=function(a){var b=a.fields,c=a.rows;for(var d=0;d<c.length;d++){var e=c[d];console.log("Row "+d+": ");for(var f=0;f<e.length;f++){var g=b[f],h=e[f];console.log("  "+g+": "+h)}}},m=function(a){var b=a.fields,c=a.columns;for(var d=0;d<c.length;d++){var e=c[d],f=b[d];console.log("Column "+f+" ("+d+"): ");for(var g=0;g<e.length;g++){var h=e[g];console.log("  "+h)}}},n=function(a,b){if(!b||b.length===0)throw new Error("'"+a+"' requires at least one SID")},o=e.extend({init:function(a){this.service=a,this.run=f.bind(this,this.run),this.cancel=f.bind(this,this.cancel),this.create=f.bind(this,this.create),this.events=f.bind(this,this.events),this.list=f.bind(this,this.list),this.preview=f.bind(this,this.preview),this.results=f.bind(this,this.results)},_foreach:function(a,b,c){a=a||[];var d=[];this.service.jobs().fetch(function(e,h){var i=h.list()||[];for(var j=0;j<i.length;j++)if(f.contains(a,i[j].sid)){var k=i[j];d.push(k)}g.parallelMap(d,b,c)})},run:function(a,b,c,d){var e={cancel:this.cancel,create:this.create,events:this.events,list:this.list,preview:this.preview,results:this.results};if(!a){console.error("You must supply a command to run. Options are:");for(var f in e)e.hasOwnProperty(f)&&console.error("  "+f);d("No command was specified.");return}var g=e[a];if(!g){d("Unrecognized command: "+a);return}g(b,c,d)},cancel:function(a,b,c){n("cancel",a),this._foreach(a,function(a,b,c){a.cancel(function(b){if(b){c(b);return}console.log("  Job "+a.sid+" cancelled"),c()})},c)},events:function(a,b,c){this._foreach(a,function(a,c,d){a.events(b,function(c,e){console.log("===== EVENTS @ "+a.sid+" =====");if(c){d(c);return}var f=b.output_mode||"rows";f==="json_rows"?l(e):f==="json_cols"?(console.log(e),m(e)):console.log(e),d(null,e)})},c)},create:function(a,b,c){var d=b.search,e=b;delete e.search,this.service.jobs().create(d,e,function(a,b){if(a){c(a);return}console.log("Created job "+b.sid),c(null,b)})},list:function(a,b,c){a=a||[];if(a.length===0){var d=this.service.jobs();d.fetch(function(a,b){if(a){c(a);return}var d=b.list()||[];for(var e=0;e<d.length;e++)console.log("  Job "+(e+1)+" sid: "+d[e].sid);c(null,d)})}else this._foreach(a,function(a,b,c){a.fetch(function(a,b){if(a){c(a);return}console.log("Job "+b.sid+": ");var d=b.properties();for(var e in d){if(f.contains(["performance"],e))continue;console.log("  "+e+": ",d[e])}c(null,d)})},c)},preview:function(a,b,c){this._foreach(a,function(a,c,d){a.preview(b,function(c,e){console.log("===== PREVIEW @ "+a.sid+" =====");if(c){d(c);return}var f=b.output_mode||"rows";f==="json_rows"?l(e):f==="json_cols"?(console.log(e),m(e)):console.log(e),d(null,e)})},c)},results:function(a,b,c){this._foreach(a,function(a,c,d){a.track({},{done:function(a){a.results(b,function(c,e){console.log("===== RESULTS @ "+a.sid+" =====");if(c){d(c);return}var f=b.output_mode||"rows";f==="json_rows"?l(e):f==="json_cols"?(console.log(e),m(e)):console.log(e),d(null,e)})},failed:function(a){d("failed")},error:function(a){d(a)}})},c)}});c.main=function(a,b){var c=h.create();b=b||function(a){a?console.log(a):console.log("==============")};var e=function(a){var e=arguments[arguments.length-1],f=new d.Service({scheme:c.opts.scheme,host:c.opts.host,port:c.opts.port,username:c.opts.username,password:c.opts.password,version:c.opts.version});f.login(function(d,g){if(d){console.log("Error: "+d),b(d);return}var h=new o(f);h.run(a,c.args,e.opts,function(a){if(a){b(a);return}b.apply(null,arguments)})})};c.name="jobs",c.description("List, create and manage search jobs"),c.add("create","Create a new search job","",i,["search"],e),c.add("results","Fetch results for the specified search jobs","<sids...>",k,[],e),c.add("preview","Fetch preview results for the specified search jobs","<sids...>",k,[],e),c.add("events","Fetch events for the specified search jobs","<sids...>",j,[],e),c.add("cancel","Cancel the specify search jobs","<sids...>",[],[],e),c.add("list","List all search jobs or properties for those specified","[sids...]",[],[],e),c.parse(a);if(!c.executedCommand){console.log(c.helpInformation()),b("You must specify a command to run.");return}},b===a.main&&c.main(process.argv)})()}),require.define("/examples/node/search.js",function(a,b,c,d,e){(function(){var d=a("../../index"),e=d.Class,f=d.Utils,g=d.Async,h=a("./cmdline"),i=a("util").print,j=["search","earliest_time","latest_time","now","time_format","exec_mode","search_mode","rt_blocking","rt_queue_size","rt_maxblocksecs","rt_indexfilter","id","status_buckets","max_count","max_time","timeout","auto_finalize_ec","enable_lookups","reload_macros","reduce_freq","spawn_process","required_field_list","rf","auto_cancel","auto_pause"],k=function(a){return new d.Service({scheme:a.scheme,host:a.host,port:a.port,username:a.username,password:a.password,version:a.version})},l=function(a,b,c){var d=b.search,e=b.verbose,f=b.count||0,h=b.mode||"row";delete b.search,delete b.verbose,delete b.count,delete b.mode,g.chain([function(c){a.search(d,b,c)},function(a,b){g.whilst(function(){return!a.properties().isDone},function(b){a.fetch(function(a,d){if(a)c(a);else{var f=d.properties();if(e){var h=f.doneProgress*100+"%",j=f.scanCount,k=f.eventCount,l=f.resultCount,m="-- "+h+" done | "+j+" scanned | "+k+" matched | "+l+" results";i("\r"+m+"                                          ")}g.sleep(1e3,b)}})},function(c){e&&i("\r"),b(c,a)})},function(a,b){a.results({count:f,json_mode:h},b)},function(a,b,c){process.stdout.write(JSON.stringify(a)),b.cancel(c)}],function(a){c(a)})},m=function(a,b,c){var d=b.search;delete b.search,a.oneshotSearch(d,b,function(a,b){a?c(a):(console.log(JSON.stringify(b)),c())})};c.main=function(a,b){d.Logger.setLevel("NONE"),b=b||function(a){a&&console.log(a)};var c=h.create();c.name="search",c.description("Create a search and print the results to stdout"),c.option("--verbose","Output job progress as we wait for completion"),c.option("--count <count>","How many results to fetch"),c.option("--mode <mode>","Row or column mode [row|column]");var e=j,f=["search"];for(var g=0;g<e.length;g++){var i=f.indexOf(e[g])>=0,n="<"+e[g]+">";c.option("--"+e[g]+" "+n,"",undefined,i)}c.on("--help",function(){console.log("  Examples:"),console.log("  "),console.log("  Create a regular search:"),console.log("  > node search.js --search 'search index=_internal | head 10'"),console.log("  "),console.log("  Create a oneshot search:"),console.log("  > node search.js --search 'search index=_internal | head 10' --exec_mode oneshot"),console.log("  "),console.log("  Create a regular search and only return 10 results:"),console.log("  > node search.js --search 'search index=_internal | head 20' --count 10"),console.log("  "),console.log("  Create a regular search and output the progress while the search is running"),console.log("  > node search.js --search 'search index=_internal | head 20' --verbose"),console.log("  ")}),c.parse(a);var o=k(c.opts);o.login(function(a,d){if(a||!d){b("Error logging in");return}delete c.username,delete c.password,delete c.scheme,delete c.host,delete c.port,delete c.namespace,delete c.version,c.opts.exec_mode==="oneshot"?m(o,c.opts,b):l(o,c.opts,b)})},b===a.main&&c.main(process.argv)})()}),require.define("/browser.test.entry.js",function(a,b,c,d,e){window.SplunkTest={Utils:a("../../tests/test_utils"),Async:a("../../tests/test_async"),Http:a("../../tests/test_http"),Context:a("../../tests/test_context"),Service:a("../../tests/test_service"),Examples:a("../../tests/test_examples")}}),require("/browser.test.entry.js")

})();